

<!DOCTYPE html>
<html lang="zh-CN">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="noodp" /><title>React çš„ä½¿ç”¨ - å‘ä¹‹ç¤¼çš„ä¸ªäººåšå®¢</title><meta name="Description" content="ä¸èƒ½è®°ä½è¿‡å»çš„äººï¼Œè¢«åˆ¤é‡å¤è¿‡å»ã€‚"><meta property="og:title" content="React çš„ä½¿ç”¨" />
<meta property="og:description" content="ç®€ä»‹React æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„ JavaScript åº“ã€‚(å°±æ˜¯ä¸ªçŠ¶æ€æœºï¼Œå°†æ ¹æ®æ•°æ®æºæ˜ å°„å‡º UIï¼Œéµå®ˆä¸€å®šçš„è§„èŒƒå¯ä»¥å°†ï¼ŒUI å’Œ é€»è¾‘åˆ†ç¦»ï¼Œæ›´å®¹æ˜“è°ƒè¯•å’Œç¼–å†™å•" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/react/" /><meta property="og:image" content="https://og-image.dramacat.top/React çš„ä½¿ç”¨?images=https://jsd.cdn.zzko.cn/gh/orionpax1997/picx-images-hosting@master/Development/react-banner.3b3ttc6ic9q0.webp" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-07-23T21:45:22+08:00" />
<meta property="article:modified_time" content="2024-04-06T15:20:04+08:00" /><meta property="og:site_name" content="å‘ä¹‹ç¤¼çš„ä¸ªäººåšå®¢" />

<meta name="twitter:title" content="React çš„ä½¿ç”¨"/>
<meta name="twitter:card" content="summary_large_image"/><meta property="twitter:image" content="https://og-image.dramacat.top/React çš„ä½¿ç”¨?images=https://jsd.cdn.zzko.cn/gh/orionpax1997/picx-images-hosting@master/Development/react-banner.3b3ttc6ic9q0.webp" /><meta name="twitter:description" content="ç®€ä»‹React æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„ JavaScript åº“ã€‚(å°±æ˜¯ä¸ªçŠ¶æ€æœºï¼Œå°†æ ¹æ®æ•°æ®æºæ˜ å°„å‡º UIï¼Œéµå®ˆä¸€å®šçš„è§„èŒƒå¯ä»¥å°†ï¼ŒUI å’Œ é€»è¾‘åˆ†ç¦»ï¼Œæ›´å®¹æ˜“è°ƒè¯•å’Œç¼–å†™å•"/>
<meta name="application-name" content="Humble.X">
<meta name="apple-mobile-web-app-title" content="Humble.X">

<meta name="theme-color" content="#f8f8f8"><meta name="msapplication-TileColor" content="#da532c"><meta name="referrer" content="never"></meta>
<link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest">

<link rel="canonical" href="http://localhost:1313/react/" /><link rel="prev" href="http://localhost:1313/hibernate/" /><link rel="next" href="http://localhost:1313/jquery/" />
<link rel="stylesheet" href="/css/main.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="/lib/animate/animate.min.css">
        <noscript><link rel="stylesheet" href="/lib/animate/animate.min.css"></noscript><script type="application/ld+json">{"@context": "https://schema.org","@type": "BlogPosting",
        "headline": "React çš„ä½¿ç”¨",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "http://localhost:1313/react/"
        },"image": ["https://jsd.cdn.zzko.cn/gh/orionpax1997/picx-images-hosting@master/Development/react-banner.3b3ttc6ic9q0.webp"],"genre": "posts","keywords":["Frontend Framework"],"wordcount":  32996 ,
        "url": "http://localhost:1313/react/","datePublished": "2019-07-23T21:45:22+08:00","dateModified": "2024-04-06T15:20:04+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "Humble.Xiang","logo": "http://localhost:1313/images/avatar.jpg"},"author": {
                "@type": "Person",
                "name": "Humble.Xiang",
                "url": "https://github.com/Humble-Xiang"
            },"description": ""
    }</script></head>

<body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">
        function setTheme(theme) {
          document.body.setAttribute('theme', theme); 
          document.documentElement.style.setProperty('color-scheme', theme === 'light' ? 'light' : 'dark');
          if (theme === 'light') {
            document.documentElement.classList.remove('tw-dark')
          } else {
            document.documentElement.classList.add('tw-dark')
          }
          window.theme = theme;   
          window.isDark = window.theme !== 'light' 
        }
        function saveTheme(theme) {window.localStorage && localStorage.setItem('theme', theme);}
        function getMeta(metaName) {const metas = document.getElementsByTagName('meta'); for (let i = 0; i < metas.length; i++) if (metas[i].getAttribute('name') === metaName) return metas[i]; return '';}
        if (window.localStorage && localStorage.getItem('theme')) {let theme = localStorage.getItem('theme');theme === 'light' || theme === 'dark' || theme === 'black' ? setTheme(theme) : (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light')); } else { if ('auto' === 'light' || 'auto' === 'dark' || 'auto' === 'black') setTheme('auto'), saveTheme('auto'); else saveTheme('auto'), window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches ? setTheme('dark') : setTheme('light');}
        let metaColors = {'light': '#f8f8f8','dark': '#252627','black': '#000000'}
        getMeta('theme-color').content = metaColors[document.body.getAttribute('theme')];
        window.switchThemeEventSet = new Set()
    </script>
    <div id="back-to-top"></div>
    <div id="mask"></div><div class="wrapper"><header class="desktop print:!tw-hidden" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="å‘ä¹‹ç¤¼çš„ä¸ªäººåšå®¢"><span id="desktop-header-typeit" class="typeit"></span></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item"
                    href="/posts/" > æ‰€æœ‰æ–‡ç«  </a><a class="menu-item"
                    href="/tags/" > æ ‡ç­¾ </a><a class="menu-item"
                    href="/categories/" > åˆ†ç±» </a><a class="menu-item"
                    href="/series/" > ç³»åˆ— </a><a class="menu-item"
                    href="https://github.com/Humble-Xiang"  title="GitHub" 
                    rel="noopener noreferrer" target="_blank" ><svg class='icon' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 496 512'><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d='M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z'/></svg>  </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                    <input type="text"
                        placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹..."
                        id="search-input-desktop">
                    <button class="search-button search-toggle" id="search-toggle-desktop" title="æœç´¢">
                        <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
                    </button>
                    <button class="search-button search-clear" id="search-clear-desktop" title="æ¸…ç©º">
                        <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"/></svg>
                    </button>
                    <span class="search-button search-loading tw-animate-spin" id="search-loading-desktop">
                        <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"/></svg>
                    </span>
                </span><button class="menu-item theme-select" aria-label="åˆ‡æ¢ä¸»é¢˜">
                    <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M8 256c0 136.966 111.033 248 248 248s248-111.034 248-248S392.966 8 256 8 8 119.033 8 256zm248 184V72c101.705 0 184 82.311 184 184 0 101.705-82.311 184-184 184z"/></svg>
                    <select class="color-theme-select" id="theme-select-desktop" aria-label="åˆ‡æ¢ä¸»é¢˜">
                        <option value="light">æµ…è‰²</option>
                        <option value="dark">æ·±è‰²</option>
                        <option value="black">é»‘è‰²</option>
                        <option value="auto">è·Ÿéšç³»ç»Ÿ</option>
                    </select>
                </button></div>
        </div>
    </div>
</header><header class="mobile print:!tw-hidden" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="å‘ä¹‹ç¤¼çš„ä¸ªäººåšå®¢"><span id="mobile-header-typeit" class="typeit"></span></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                <div class="search mobile" id="search-mobile">
                    <input type="text"
                        placeholder="æœç´¢æ–‡ç« æ ‡é¢˜æˆ–å†…å®¹..."
                        id="search-input-mobile">
                    <button class="search-button search-toggle tw-h-10" id="search-toggle-mobile" title="æœç´¢">
                        <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
                    </button>
                    <button class="search-button search-clear" id="search-clear-mobile" title="æ¸…ç©º">
                        <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm121.6 313.1c4.7 4.7 4.7 12.3 0 17L338 377.6c-4.7 4.7-12.3 4.7-17 0L256 312l-65.1 65.6c-4.7 4.7-12.3 4.7-17 0L134.4 338c-4.7-4.7-4.7-12.3 0-17l65.6-65-65.6-65.1c-4.7-4.7-4.7-12.3 0-17l39.6-39.6c4.7-4.7 12.3-4.7 17 0l65 65.7 65.1-65.6c4.7-4.7 12.3-4.7 17 0l39.6 39.6c4.7 4.7 4.7 12.3 0 17L312 256l65.6 65.1z"/></svg>
                    </button>
                    <span class="search-button search-loading tw-animate-spin" id="search-loading-mobile">
                        <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M304 48c0 26.51-21.49 48-48 48s-48-21.49-48-48 21.49-48 48-48 48 21.49 48 48zm-48 368c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zm208-208c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48zM96 256c0-26.51-21.49-48-48-48S0 229.49 0 256s21.49 48 48 48 48-21.49 48-48zm12.922 99.078c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.491-48-48-48zm294.156 0c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48c0-26.509-21.49-48-48-48zM108.922 60.922c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.491-48-48-48z"/></svg>
                    </span>
                </div>
                <button class="search-cancel" id="search-cancel-mobile">
                    å–æ¶ˆ
                </button>
            </div><a class="menu-item" href="/posts/" title="" >æ‰€æœ‰æ–‡ç« </a><a class="menu-item" href="/tags/" title="" >æ ‡ç­¾</a><a class="menu-item" href="/categories/" title="" >åˆ†ç±»</a><a class="menu-item" href="/series/" title="" >ç³»åˆ—</a><a class="menu-item" href="https://github.com/Humble-Xiang" title="GitHub" 
                rel="noopener noreferrer" target="_blank" ><svg class='icon' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 496 512'><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d='M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z'/></svg></a><button class="menu-item theme-select tw-w-full" aria-label="åˆ‡æ¢ä¸»é¢˜">
                <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M8 256c0 136.966 111.033 248 248 248s248-111.034 248-248S392.966 8 256 8 8 119.033 8 256zm248 184V72c101.705 0 184 82.311 184 184 0 101.705-82.311 184-184 184z"/></svg>
                <select class="color-theme-select" id="theme-select-mobile" aria-label="åˆ‡æ¢ä¸»é¢˜">
                    <option value="light">æµ…è‰²</option>
                    <option value="dark">æ·±è‰²</option>
                    <option value="black">é»‘è‰²</option>
                    <option value="auto">è·Ÿéšç³»ç»Ÿ</option>
                </select>
            </button></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div><main class="main">
            <div class="container"><div class="toc print:!tw-hidden" id="toc-auto">
        <h2 class="toc-title">ç›®å½•</h2>
        <div class="toc-content" id="toc-content-auto"><nav id="TableOfContents">
  <ul>
    <li><a href="#ç®€ä»‹">ç®€ä»‹</a></li>
    <li><a href="#åŸºç¡€">åŸºç¡€</a>
      <ul>
        <li><a href="#hello-world">Hello World</a></li>
        <li><a href="#ç†è§£-jsx">ç†è§£ JSX</a></li>
        <li><a href="#å…ƒç´ æ¸²æŸ“">å…ƒç´ æ¸²æŸ“</a></li>
        <li><a href="#ç†è§£-react-ç»„ä»¶">ç†è§£ React ç»„ä»¶</a>
          <ul>
            <li><a href="#æ¦‚å¿µ">æ¦‚å¿µ</a></li>
            <li><a href="#å®ä¾‹">å®ä¾‹</a></li>
            <li><a href="#åˆ›å»ºä¸€ä¸ª-react-ç»„ä»¶">åˆ›å»ºä¸€ä¸ª React ç»„ä»¶</a></li>
            <li><a href="#å—æ§ç»„ä»¶å’Œéå—æ§ç»„ä»¶">å—æ§ç»„ä»¶å’Œéå—æ§ç»„ä»¶</a></li>
          </ul>
        </li>
        <li><a href="#props">Props</a></li>
        <li><a href="#state">State</a></li>
        <li><a href="#react-ç»„ä»¶ç”Ÿå‘½å‘¨æœŸåŠä½¿ç”¨åœºæ™¯">React ç»„ä»¶ç”Ÿå‘½å‘¨æœŸåŠä½¿ç”¨åœºæ™¯</a></li>
        <li><a href="#react-äº‹ä»¶å¤„ç†">React äº‹ä»¶å¤„ç†</a></li>
        <li><a href="#æ¡ä»¶æ¸²æŸ“">æ¡ä»¶æ¸²æŸ“</a></li>
        <li><a href="#keys">Keys</a></li>
        <li><a href="#è¡¨å•">è¡¨å•</a></li>
        <li><a href="#çŠ¶æ€æå‡">çŠ¶æ€æå‡</a></li>
        <li><a href="#ç»„åˆ-vs-ç»§æ‰¿">ç»„åˆ vs ç»§æ‰¿</a>
          <ul>
            <li><a href="#åŒ…å«å…³ç³»">åŒ…å«å…³ç³»</a></li>
            <li><a href="#ç‰¹ä¾‹å…³ç³»">ç‰¹ä¾‹å…³ç³»</a></li>
            <li><a href="#é‚£ä¹ˆç»§æ‰¿å‘¢">é‚£ä¹ˆç»§æ‰¿å‘¢ï¼Ÿ</a></li>
          </ul>
        </li>
        <li><a href="#react-å“²å­¦">React å“²å­¦</a>
          <ul>
            <li><a href="#ä»è®¾è®¡ç¨¿å¼€å§‹">ä»è®¾è®¡ç¨¿å¼€å§‹</a></li>
            <li><a href="#ç¬¬ä¸€æ­¥å°†è®¾è®¡å¥½çš„-ui-åˆ’åˆ†ä¸ºç»„ä»¶å±‚çº§">ç¬¬ä¸€æ­¥ï¼šå°†è®¾è®¡å¥½çš„ UI åˆ’åˆ†ä¸ºç»„ä»¶å±‚çº§</a></li>
            <li><a href="#ç¬¬äºŒæ­¥ç”¨-react-åˆ›å»ºä¸€ä¸ªé™æ€ç‰ˆæœ¬">ç¬¬äºŒæ­¥ï¼šç”¨ React åˆ›å»ºä¸€ä¸ªé™æ€ç‰ˆæœ¬</a>
              <ul>
                <li><a href="#è¡¥å……è¯´æ˜-æœ‰å…³-props-å’Œ-state">è¡¥å……è¯´æ˜: æœ‰å…³ props å’Œ state</a></li>
              </ul>
            </li>
            <li><a href="#ç¬¬ä¸‰æ­¥ç¡®å®š-ui-state-çš„æœ€å°ä¸”å®Œæ•´è¡¨ç¤º">ç¬¬ä¸‰æ­¥ï¼šç¡®å®š UI state çš„æœ€å°ï¼ˆä¸”å®Œæ•´ï¼‰è¡¨ç¤º</a></li>
            <li><a href="#ç¬¬å››æ­¥ç¡®å®š-state-æ”¾ç½®çš„ä½ç½®">ç¬¬å››æ­¥ï¼šç¡®å®š state æ”¾ç½®çš„ä½ç½®</a></li>
            <li><a href="#ç¬¬äº”æ­¥æ·»åŠ åå‘æ•°æ®æµ">ç¬¬äº”æ­¥ï¼šæ·»åŠ åå‘æ•°æ®æµ</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#æ‰©å±•">æ‰©å±•</a>
      <ul>
        <li><a href="#ç†è§£-virtual-dom">ç†è§£ Virtual DOM</a></li>
        <li><a href="#ç»„ä»¶è®¾è®¡æ¨¡å¼">ç»„ä»¶è®¾è®¡æ¨¡å¼</a>
          <ul>
            <li><a href="#é«˜é˜¶ç»„ä»¶">é«˜é˜¶ç»„ä»¶</a></li>
            <li><a href="#æ¡†æ¶å¤–åŒ…è£…ç»„ä»¶">æ¡†æ¶(å¤–åŒ…è£…)ç»„ä»¶</a></li>
          </ul>
        </li>
        <li><a href="#context">Context</a></li>
        <li><a href="#è„šæ‰‹æ¶å·¥å…·">è„šæ‰‹æ¶å·¥å…·</a></li>
        <li><a href="#ç”Ÿæ€åœˆ">ç”Ÿæ€åœˆ</a>
          <ul>
            <li><a href="#redux">Redux</a></li>
            <li><a href="#react-router">React Router</a></li>
            <li><a href="#webpack">webpack</a></li>
            <li><a href="#react-loadable">react-loadable</a></li>
          </ul>
        </li>
        <li><a href="#hook">Hook</a>
          <ul>
            <li><a href="#hook-æ¦‚è§ˆ">Hook æ¦‚è§ˆ</a>
              <ul>
                <li><a href="#-state-hook">ğŸ“Œ State Hook</a></li>
                <li><a href="#-effect-hook">âš¡ï¸ Effect Hook</a></li>
                <li><a href="#-hook-ä½¿ç”¨è§„åˆ™">âœŒï¸ Hook ä½¿ç”¨è§„åˆ™</a></li>
                <li><a href="#-è‡ªå®šä¹‰-hook">ğŸ’¡ è‡ªå®šä¹‰ Hook</a></li>
                <li><a href="#-å…¶ä»–-hook">ğŸ”Œ å…¶ä»– Hook</a></li>
              </ul>
            </li>
            <li><a href="#ä½¿ç”¨-state-hook">ä½¿ç”¨ State Hook</a>
              <ul>
                <li><a href="#ç­‰ä»·çš„-class-ç¤ºä¾‹">ç­‰ä»·çš„ class ç¤ºä¾‹</a></li>
                <li><a href="#hook-å’Œå‡½æ•°ç»„ä»¶">Hook å’Œå‡½æ•°ç»„ä»¶</a></li>
                <li><a href="#hook-æ˜¯ä»€ä¹ˆ">Hook æ˜¯ä»€ä¹ˆï¼Ÿ</a></li>
                <li><a href="#å£°æ˜-state-å˜é‡">å£°æ˜ State å˜é‡</a></li>
                <li><a href="#è¯»å–-state">è¯»å– State</a></li>
                <li><a href="#æ›´æ–°-state">æ›´æ–° State</a></li>
                <li><a href="#æ€»ç»“">æ€»ç»“</a>
                  <ul>
                    <li><a href="#æç¤ºæ–¹æ‹¬å·æœ‰ä»€ä¹ˆç”¨">æç¤ºï¼šæ–¹æ‹¬å·æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</a></li>
                    <li><a href="#æç¤ºä½¿ç”¨å¤šä¸ª-state-å˜é‡">æç¤ºï¼šä½¿ç”¨å¤šä¸ª state å˜é‡</a></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li><a href="#ä½¿ç”¨-effect-hook">ä½¿ç”¨ Effect Hook</a>
              <ul>
                <li><a href="#æ— éœ€æ¸…é™¤çš„-effect">æ— éœ€æ¸…é™¤çš„ effect</a>
                  <ul>
                    <li><a href="#ä½¿ç”¨-class-çš„ç¤ºä¾‹">ä½¿ç”¨ class çš„ç¤ºä¾‹</a></li>
                    <li><a href="#ä½¿ç”¨-hook-çš„ç¤ºä¾‹">ä½¿ç”¨ Hook çš„ç¤ºä¾‹</a></li>
                    <li><a href="#è¯¦ç»†è¯´æ˜">è¯¦ç»†è¯´æ˜</a></li>
                  </ul>
                </li>
                <li><a href="#éœ€è¦æ¸…é™¤çš„-effect">éœ€è¦æ¸…é™¤çš„ effect</a>
                  <ul>
                    <li><a href="#ä½¿ç”¨-class-çš„ç¤ºä¾‹-1">ä½¿ç”¨ Class çš„ç¤ºä¾‹</a></li>
                    <li><a href="#ä½¿ç”¨-hook-çš„ç¤ºä¾‹-1">ä½¿ç”¨ Hook çš„ç¤ºä¾‹</a></li>
                  </ul>
                </li>
                <li><a href="#å°ç»“">å°ç»“</a></li>
                <li><a href="#ä½¿ç”¨-effect-çš„æç¤º">ä½¿ç”¨ Effect çš„æç¤º</a>
                  <ul>
                    <li><a href="#æç¤º-ä½¿ç”¨å¤šä¸ª-effect-å®ç°å…³æ³¨ç‚¹åˆ†ç¦»">æç¤º: ä½¿ç”¨å¤šä¸ª Effect å®ç°å…³æ³¨ç‚¹åˆ†ç¦»</a></li>
                    <li><a href="#è§£é‡Š-ä¸ºä»€ä¹ˆæ¯æ¬¡æ›´æ–°çš„æ—¶å€™éƒ½è¦è¿è¡Œ-effect">è§£é‡Š: ä¸ºä»€ä¹ˆæ¯æ¬¡æ›´æ–°çš„æ—¶å€™éƒ½è¦è¿è¡Œ Effect</a></li>
                    <li><a href="#æç¤º-é€šè¿‡è·³è¿‡-effect-è¿›è¡Œæ€§èƒ½ä¼˜åŒ–">æç¤º: é€šè¿‡è·³è¿‡ Effect è¿›è¡Œæ€§èƒ½ä¼˜åŒ–</a></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li><a href="#hook-è§„åˆ™">Hook è§„åˆ™</a>
              <ul>
                <li>
                  <ul>
                    <li><a href="#åªåœ¨æœ€é¡¶å±‚ä½¿ç”¨-hook">åªåœ¨æœ€é¡¶å±‚ä½¿ç”¨ Hook</a></li>
                    <li><a href="#åªåœ¨-react-å‡½æ•°ä¸­è°ƒç”¨-hook">åªåœ¨ React å‡½æ•°ä¸­è°ƒç”¨ Hook</a></li>
                  </ul>
                </li>
                <li><a href="#eslint-æ’ä»¶">ESLint æ’ä»¶</a></li>
                <li><a href="#è¯´æ˜">è¯´æ˜</a></li>
              </ul>
            </li>
            <li><a href="#è‡ªå®šä¹‰-hook">è‡ªå®šä¹‰ Hook</a>
              <ul>
                <li><a href="#æå–è‡ªå®šä¹‰-hook">æå–è‡ªå®šä¹‰ Hook</a></li>
                <li><a href="#ä½¿ç”¨è‡ªå®šä¹‰-hook">ä½¿ç”¨è‡ªå®šä¹‰ Hook</a>
                  <ul>
                    <li><a href="#æç¤ºåœ¨å¤šä¸ª-hook-ä¹‹é—´ä¼ é€’ä¿¡æ¯">æç¤ºï¼šåœ¨å¤šä¸ª Hook ä¹‹é—´ä¼ é€’ä¿¡æ¯</a></li>
                  </ul>
                </li>
                <li><a href="#useyourimagination"><code>useYourImagination()</code></a></li>
              </ul>
            </li>
            <li><a href="#hooks-faq">Hooks FAQ</a></li>
          </ul>
        </li>
        <li><a href="#hook-api-ç´¢å¼•">Hook API ç´¢å¼•</a>
          <ul>
            <li><a href="#åŸºç¡€-hook">åŸºç¡€ Hook</a>
              <ul>
                <li><a href="#usestate"><code>useState</code></a>
                  <ul>
                    <li><a href="#å‡½æ•°å¼æ›´æ–°">å‡½æ•°å¼æ›´æ–°</a></li>
                    <li><a href="#æƒ°æ€§åˆå§‹-state">æƒ°æ€§åˆå§‹ state</a></li>
                    <li><a href="#è·³è¿‡-state-æ›´æ–°">è·³è¿‡ state æ›´æ–°</a></li>
                    <li><a href="#batching-of-state-updates">Batching of state updates</a></li>
                  </ul>
                </li>
                <li><a href="#useeffect"><code>useEffect</code></a>
                  <ul>
                    <li><a href="#æ¸…é™¤-effect">æ¸…é™¤ effect</a></li>
                    <li><a href="#effect-çš„æ‰§è¡Œæ—¶æœº">effect çš„æ‰§è¡Œæ—¶æœº</a></li>
                    <li><a href="#effect-çš„æ¡ä»¶æ‰§è¡Œ">effect çš„æ¡ä»¶æ‰§è¡Œ</a></li>
                  </ul>
                </li>
                <li><a href="#usecontext"><code>useContext</code></a></li>
              </ul>
            </li>
            <li><a href="#é¢å¤–çš„-hook">é¢å¤–çš„ Hook</a>
              <ul>
                <li><a href="#usereducer"><code>useReducer</code></a>
                  <ul>
                    <li><a href="#æŒ‡å®šåˆå§‹-state">æŒ‡å®šåˆå§‹ state</a></li>
                    <li><a href="#æƒ°æ€§åˆå§‹åŒ–">æƒ°æ€§åˆå§‹åŒ–</a></li>
                    <li><a href="#è·³è¿‡-dispatch">è·³è¿‡ dispatch</a></li>
                  </ul>
                </li>
                <li><a href="#usecallback"><code>useCallback</code></a></li>
                <li><a href="#usememo"><code>useMemo</code></a></li>
                <li><a href="#useref"><code>useRef</code></a></li>
                <li><a href="#useimperativehandle"><code>useImperativeHandle</code></a></li>
                <li><a href="#uselayouteffect"><code>useLayoutEffect</code></a></li>
                <li><a href="#usedebugvalue"><code>useDebugValue</code></a>
                  <ul>
                    <li><a href="#å»¶è¿Ÿæ ¼å¼åŒ–-debug-å€¼">å»¶è¿Ÿæ ¼å¼åŒ– debug å€¼</a></li>
                  </ul>
                </li>
                <li><a href="#usedeferredvalue"><code>useDeferredValue</code></a>
                  <ul>
                    <li><a href="#memoizing-deferred-children">Memoizing deferred children</a></li>
                  </ul>
                </li>
                <li><a href="#usetransition"><code>useTransition</code></a></li>
                <li><a href="#useid"><code>useId</code></a></li>
              </ul>
            </li>
            <li><a href="#library-hooks">Library Hooks</a>
              <ul>
                <li><a href="#usesyncexternalstore"><code>useSyncExternalStore</code></a></li>
                <li><a href="#useinsertioneffect"><code>useInsertionEffect</code></a></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#åº”ç”¨åœºæ™¯">åº”ç”¨åœºæ™¯</a>
      <ul>
        <li><a href="#å¦‚ä½•è§£å†³-jax-ä¸­-html-ä»£ç æ®µè¢«è¯†åˆ«ä¸ºå­—ç¬¦ä¸²çš„é—®é¢˜">å¦‚ä½•è§£å†³ JAX ä¸­ HTML ä»£ç æ®µè¢«è¯†åˆ«ä¸ºå­—ç¬¦ä¸²çš„é—®é¢˜?</a>
          <ul>
            <li><a href="#é—®é¢˜æè¿°">é—®é¢˜æè¿°</a></li>
            <li><a href="#äº§ç”ŸåŸå› ">äº§ç”ŸåŸå› </a></li>
            <li><a href="#è§£å†³æ–¹å¼">è§£å†³æ–¹å¼</a></li>
          </ul>
        </li>
        <li><a href="#å¦‚ä½•å¤„ç†-react-å’Œç›´æ¥ä¿®æ”¹-dom-çš„å‰ç«¯æ¡†æ¶çš„å…¼å®¹æ€§é—®é¢˜">å¦‚ä½•å¤„ç† React å’Œç›´æ¥ä¿®æ”¹ DOM çš„å‰ç«¯æ¡†æ¶çš„å…¼å®¹æ€§é—®é¢˜?</a>
          <ul>
            <li><a href="#é—®é¢˜æè¿°-1">é—®é¢˜æè¿°</a>
              <ul>
                <li><a href="#react-å’Œ-jquery-ui-sortable">React å’Œ JQuery UI Sortable</a></li>
                <li><a href="#react-å’Œ-jquery-tipsy">React å’Œ JQuery tipsy</a></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav></div>
    </div><script>document.getElementsByTagName("main")[0].setAttribute("autoTOC", "true")</script><article class="page single print:!tw-w-full print:!tw-max-w-none print:!tw-m-0 print:!tw-p-0"><h1 class="single-title animate__animated animate__flipInX">React çš„ä½¿ç”¨</h1><div class="post-meta">
            <div class="post-meta-line">
                <span class="post-author"><img src="http://localhost:1313/images/avatar.jpg" alt="Humble.Xiang avatar" class="tw-inline-block tw-max-h-4 tw-rounded-full tw-translate-y-[-2px] tw-mr-1"><a href="https://github.com/Humble-Xiang" title="Author" target="_blank" rel="noopener noreferrer author" class="author">Humble.Xiang</a>
                </span>&nbsp;<span class="post-category">æ”¶å½•äº </span>&nbsp;<span class="post-category">ç±»åˆ« <a href="/categories/development/"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M464 128H272l-54.63-54.63c-6-6-14.14-9.37-22.63-9.37H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V176c0-26.51-21.49-48-48-48zm0 272H48V112h140.12l54.63 54.63c6 6 14.14 9.37 22.63 9.37H464v224z"/></svg>Development</a></span></div>
            <div class="post-meta-line"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M148 288h-40c-6.6 0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm108-12v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 96v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm-96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm192 0v-40c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6 0 12-5.4 12-12zm96-260v352c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6 0 12 5.4 12 12v52h48c26.5 0 48 21.5 48 48zm-48 346V160H48v298c0 3.3 2.7 6 6 6h340c3.3 0 6-2.7 6-6z"/></svg>&nbsp;<time datetime="2019-07-23">2019-07-23</time>&nbsp;<svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M402.3 344.9l32-32c5-5 13.7-1.5 13.7 5.7V464c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h273.5c7.1 0 10.7 8.6 5.7 13.7l-32 32c-1.5 1.5-3.5 2.3-5.7 2.3H48v352h352V350.5c0-2.1.8-4.1 2.3-5.6zm156.6-201.8L296.3 405.7l-90.4 10c-26.2 2.9-48.5-19.2-45.6-45.6l10-90.4L432.9 17.1c22.9-22.9 59.9-22.9 82.7 0l43.2 43.2c22.9 22.9 22.9 60 .1 82.8zM460.1 174L402 115.9 216.2 301.8l-7.3 65.3 65.3-7.3L460.1 174zm64.8-79.7l-43.2-43.2c-4.1-4.1-10.8-4.1-14.8 0L436 82l58.1 58.1 30.9-30.9c4-4.2 4-10.8-.1-14.9z"/></svg>&nbsp;<time datetime="2024-04-06">2024-04-06</time>&nbsp;<svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M497.9 142.1l-46.1 46.1c-4.7 4.7-12.3 4.7-17 0l-111-111c-4.7-4.7-4.7-12.3 0-17l46.1-46.1c18.7-18.7 49.1-18.7 67.9 0l60.1 60.1c18.8 18.7 18.8 49.1 0 67.9zM284.2 99.8L21.6 362.4.4 483.9c-2.9 16.4 11.4 30.6 27.8 27.8l121.5-21.3 262.6-262.6c4.7-4.7 4.7-12.3 0-17l-111-111c-4.8-4.7-12.4-4.7-17.1 0zM124.1 339.9c-5.5-5.5-5.5-14.3 0-19.8l154-154c5.5-5.5 14.3-5.5 19.8 0s5.5 14.3 0 19.8l-154 154c-5.5 5.5-14.3 5.5-19.8 0zM88 424h48v36.3l-64.5 11.3-31.1-31.1L51.7 376H88v48z"/></svg>&nbsp;çº¦ 32996 å­—&nbsp;<svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8zm0 448c-110.5 0-200-89.5-200-200S145.5 56 256 56s200 89.5 200 200-89.5 200-200 200zm61.8-104.4l-84.9-61.7c-3.1-2.3-4.9-5.9-4.9-9.7V116c0-6.6 5.4-12 12-12h32c6.6 0 12 5.4 12 12v141.7l66.8 48.6c5.4 3.9 6.5 11.4 2.6 16.8L334.6 349c-3.9 5.3-11.4 6.5-16.8 2.6z"/></svg>&nbsp;é¢„è®¡é˜…è¯» 66 åˆ†é’Ÿ&nbsp;</div>
        </div><div class="featured-image"><img
        
        loading="eager"
        src="https://jsd.cdn.zzko.cn/gh/orionpax1997/picx-images-hosting@master/Development/react-banner.3b3ttc6ic9q0.webp"
        srcset="https://jsd.cdn.zzko.cn/gh/orionpax1997/picx-images-hosting@master/Development/react-banner.3b3ttc6ic9q0.webp, https://jsd.cdn.zzko.cn/gh/orionpax1997/picx-images-hosting@master/Development/react-banner.3b3ttc6ic9q0.webp 1.5x, https://jsd.cdn.zzko.cn/gh/orionpax1997/picx-images-hosting@master/Development/react-banner.3b3ttc6ic9q0.webp 2x"
        title="https://jsd.cdn.zzko.cn/gh/orionpax1997/picx-images-hosting@master/Development/react-banner.3b3ttc6ic9q0.webp" ></div><div class="details toc print:!tw-block" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>ç›®å½•</span>
                    <span class="details-icon"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"/></svg></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#ç®€ä»‹">ç®€ä»‹</a></li>
    <li><a href="#åŸºç¡€">åŸºç¡€</a>
      <ul>
        <li><a href="#hello-world">Hello World</a></li>
        <li><a href="#ç†è§£-jsx">ç†è§£ JSX</a></li>
        <li><a href="#å…ƒç´ æ¸²æŸ“">å…ƒç´ æ¸²æŸ“</a></li>
        <li><a href="#ç†è§£-react-ç»„ä»¶">ç†è§£ React ç»„ä»¶</a>
          <ul>
            <li><a href="#æ¦‚å¿µ">æ¦‚å¿µ</a></li>
            <li><a href="#å®ä¾‹">å®ä¾‹</a></li>
            <li><a href="#åˆ›å»ºä¸€ä¸ª-react-ç»„ä»¶">åˆ›å»ºä¸€ä¸ª React ç»„ä»¶</a></li>
            <li><a href="#å—æ§ç»„ä»¶å’Œéå—æ§ç»„ä»¶">å—æ§ç»„ä»¶å’Œéå—æ§ç»„ä»¶</a></li>
          </ul>
        </li>
        <li><a href="#props">Props</a></li>
        <li><a href="#state">State</a></li>
        <li><a href="#react-ç»„ä»¶ç”Ÿå‘½å‘¨æœŸåŠä½¿ç”¨åœºæ™¯">React ç»„ä»¶ç”Ÿå‘½å‘¨æœŸåŠä½¿ç”¨åœºæ™¯</a></li>
        <li><a href="#react-äº‹ä»¶å¤„ç†">React äº‹ä»¶å¤„ç†</a></li>
        <li><a href="#æ¡ä»¶æ¸²æŸ“">æ¡ä»¶æ¸²æŸ“</a></li>
        <li><a href="#keys">Keys</a></li>
        <li><a href="#è¡¨å•">è¡¨å•</a></li>
        <li><a href="#çŠ¶æ€æå‡">çŠ¶æ€æå‡</a></li>
        <li><a href="#ç»„åˆ-vs-ç»§æ‰¿">ç»„åˆ vs ç»§æ‰¿</a>
          <ul>
            <li><a href="#åŒ…å«å…³ç³»">åŒ…å«å…³ç³»</a></li>
            <li><a href="#ç‰¹ä¾‹å…³ç³»">ç‰¹ä¾‹å…³ç³»</a></li>
            <li><a href="#é‚£ä¹ˆç»§æ‰¿å‘¢">é‚£ä¹ˆç»§æ‰¿å‘¢ï¼Ÿ</a></li>
          </ul>
        </li>
        <li><a href="#react-å“²å­¦">React å“²å­¦</a>
          <ul>
            <li><a href="#ä»è®¾è®¡ç¨¿å¼€å§‹">ä»è®¾è®¡ç¨¿å¼€å§‹</a></li>
            <li><a href="#ç¬¬ä¸€æ­¥å°†è®¾è®¡å¥½çš„-ui-åˆ’åˆ†ä¸ºç»„ä»¶å±‚çº§">ç¬¬ä¸€æ­¥ï¼šå°†è®¾è®¡å¥½çš„ UI åˆ’åˆ†ä¸ºç»„ä»¶å±‚çº§</a></li>
            <li><a href="#ç¬¬äºŒæ­¥ç”¨-react-åˆ›å»ºä¸€ä¸ªé™æ€ç‰ˆæœ¬">ç¬¬äºŒæ­¥ï¼šç”¨ React åˆ›å»ºä¸€ä¸ªé™æ€ç‰ˆæœ¬</a>
              <ul>
                <li><a href="#è¡¥å……è¯´æ˜-æœ‰å…³-props-å’Œ-state">è¡¥å……è¯´æ˜: æœ‰å…³ props å’Œ state</a></li>
              </ul>
            </li>
            <li><a href="#ç¬¬ä¸‰æ­¥ç¡®å®š-ui-state-çš„æœ€å°ä¸”å®Œæ•´è¡¨ç¤º">ç¬¬ä¸‰æ­¥ï¼šç¡®å®š UI state çš„æœ€å°ï¼ˆä¸”å®Œæ•´ï¼‰è¡¨ç¤º</a></li>
            <li><a href="#ç¬¬å››æ­¥ç¡®å®š-state-æ”¾ç½®çš„ä½ç½®">ç¬¬å››æ­¥ï¼šç¡®å®š state æ”¾ç½®çš„ä½ç½®</a></li>
            <li><a href="#ç¬¬äº”æ­¥æ·»åŠ åå‘æ•°æ®æµ">ç¬¬äº”æ­¥ï¼šæ·»åŠ åå‘æ•°æ®æµ</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#æ‰©å±•">æ‰©å±•</a>
      <ul>
        <li><a href="#ç†è§£-virtual-dom">ç†è§£ Virtual DOM</a></li>
        <li><a href="#ç»„ä»¶è®¾è®¡æ¨¡å¼">ç»„ä»¶è®¾è®¡æ¨¡å¼</a>
          <ul>
            <li><a href="#é«˜é˜¶ç»„ä»¶">é«˜é˜¶ç»„ä»¶</a></li>
            <li><a href="#æ¡†æ¶å¤–åŒ…è£…ç»„ä»¶">æ¡†æ¶(å¤–åŒ…è£…)ç»„ä»¶</a></li>
          </ul>
        </li>
        <li><a href="#context">Context</a></li>
        <li><a href="#è„šæ‰‹æ¶å·¥å…·">è„šæ‰‹æ¶å·¥å…·</a></li>
        <li><a href="#ç”Ÿæ€åœˆ">ç”Ÿæ€åœˆ</a>
          <ul>
            <li><a href="#redux">Redux</a></li>
            <li><a href="#react-router">React Router</a></li>
            <li><a href="#webpack">webpack</a></li>
            <li><a href="#react-loadable">react-loadable</a></li>
          </ul>
        </li>
        <li><a href="#hook">Hook</a>
          <ul>
            <li><a href="#hook-æ¦‚è§ˆ">Hook æ¦‚è§ˆ</a>
              <ul>
                <li><a href="#-state-hook">ğŸ“Œ State Hook</a></li>
                <li><a href="#-effect-hook">âš¡ï¸ Effect Hook</a></li>
                <li><a href="#-hook-ä½¿ç”¨è§„åˆ™">âœŒï¸ Hook ä½¿ç”¨è§„åˆ™</a></li>
                <li><a href="#-è‡ªå®šä¹‰-hook">ğŸ’¡ è‡ªå®šä¹‰ Hook</a></li>
                <li><a href="#-å…¶ä»–-hook">ğŸ”Œ å…¶ä»– Hook</a></li>
              </ul>
            </li>
            <li><a href="#ä½¿ç”¨-state-hook">ä½¿ç”¨ State Hook</a>
              <ul>
                <li><a href="#ç­‰ä»·çš„-class-ç¤ºä¾‹">ç­‰ä»·çš„ class ç¤ºä¾‹</a></li>
                <li><a href="#hook-å’Œå‡½æ•°ç»„ä»¶">Hook å’Œå‡½æ•°ç»„ä»¶</a></li>
                <li><a href="#hook-æ˜¯ä»€ä¹ˆ">Hook æ˜¯ä»€ä¹ˆï¼Ÿ</a></li>
                <li><a href="#å£°æ˜-state-å˜é‡">å£°æ˜ State å˜é‡</a></li>
                <li><a href="#è¯»å–-state">è¯»å– State</a></li>
                <li><a href="#æ›´æ–°-state">æ›´æ–° State</a></li>
                <li><a href="#æ€»ç»“">æ€»ç»“</a>
                  <ul>
                    <li><a href="#æç¤ºæ–¹æ‹¬å·æœ‰ä»€ä¹ˆç”¨">æç¤ºï¼šæ–¹æ‹¬å·æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</a></li>
                    <li><a href="#æç¤ºä½¿ç”¨å¤šä¸ª-state-å˜é‡">æç¤ºï¼šä½¿ç”¨å¤šä¸ª state å˜é‡</a></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li><a href="#ä½¿ç”¨-effect-hook">ä½¿ç”¨ Effect Hook</a>
              <ul>
                <li><a href="#æ— éœ€æ¸…é™¤çš„-effect">æ— éœ€æ¸…é™¤çš„ effect</a>
                  <ul>
                    <li><a href="#ä½¿ç”¨-class-çš„ç¤ºä¾‹">ä½¿ç”¨ class çš„ç¤ºä¾‹</a></li>
                    <li><a href="#ä½¿ç”¨-hook-çš„ç¤ºä¾‹">ä½¿ç”¨ Hook çš„ç¤ºä¾‹</a></li>
                    <li><a href="#è¯¦ç»†è¯´æ˜">è¯¦ç»†è¯´æ˜</a></li>
                  </ul>
                </li>
                <li><a href="#éœ€è¦æ¸…é™¤çš„-effect">éœ€è¦æ¸…é™¤çš„ effect</a>
                  <ul>
                    <li><a href="#ä½¿ç”¨-class-çš„ç¤ºä¾‹-1">ä½¿ç”¨ Class çš„ç¤ºä¾‹</a></li>
                    <li><a href="#ä½¿ç”¨-hook-çš„ç¤ºä¾‹-1">ä½¿ç”¨ Hook çš„ç¤ºä¾‹</a></li>
                  </ul>
                </li>
                <li><a href="#å°ç»“">å°ç»“</a></li>
                <li><a href="#ä½¿ç”¨-effect-çš„æç¤º">ä½¿ç”¨ Effect çš„æç¤º</a>
                  <ul>
                    <li><a href="#æç¤º-ä½¿ç”¨å¤šä¸ª-effect-å®ç°å…³æ³¨ç‚¹åˆ†ç¦»">æç¤º: ä½¿ç”¨å¤šä¸ª Effect å®ç°å…³æ³¨ç‚¹åˆ†ç¦»</a></li>
                    <li><a href="#è§£é‡Š-ä¸ºä»€ä¹ˆæ¯æ¬¡æ›´æ–°çš„æ—¶å€™éƒ½è¦è¿è¡Œ-effect">è§£é‡Š: ä¸ºä»€ä¹ˆæ¯æ¬¡æ›´æ–°çš„æ—¶å€™éƒ½è¦è¿è¡Œ Effect</a></li>
                    <li><a href="#æç¤º-é€šè¿‡è·³è¿‡-effect-è¿›è¡Œæ€§èƒ½ä¼˜åŒ–">æç¤º: é€šè¿‡è·³è¿‡ Effect è¿›è¡Œæ€§èƒ½ä¼˜åŒ–</a></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li><a href="#hook-è§„åˆ™">Hook è§„åˆ™</a>
              <ul>
                <li>
                  <ul>
                    <li><a href="#åªåœ¨æœ€é¡¶å±‚ä½¿ç”¨-hook">åªåœ¨æœ€é¡¶å±‚ä½¿ç”¨ Hook</a></li>
                    <li><a href="#åªåœ¨-react-å‡½æ•°ä¸­è°ƒç”¨-hook">åªåœ¨ React å‡½æ•°ä¸­è°ƒç”¨ Hook</a></li>
                  </ul>
                </li>
                <li><a href="#eslint-æ’ä»¶">ESLint æ’ä»¶</a></li>
                <li><a href="#è¯´æ˜">è¯´æ˜</a></li>
              </ul>
            </li>
            <li><a href="#è‡ªå®šä¹‰-hook">è‡ªå®šä¹‰ Hook</a>
              <ul>
                <li><a href="#æå–è‡ªå®šä¹‰-hook">æå–è‡ªå®šä¹‰ Hook</a></li>
                <li><a href="#ä½¿ç”¨è‡ªå®šä¹‰-hook">ä½¿ç”¨è‡ªå®šä¹‰ Hook</a>
                  <ul>
                    <li><a href="#æç¤ºåœ¨å¤šä¸ª-hook-ä¹‹é—´ä¼ é€’ä¿¡æ¯">æç¤ºï¼šåœ¨å¤šä¸ª Hook ä¹‹é—´ä¼ é€’ä¿¡æ¯</a></li>
                  </ul>
                </li>
                <li><a href="#useyourimagination"><code>useYourImagination()</code></a></li>
              </ul>
            </li>
            <li><a href="#hooks-faq">Hooks FAQ</a></li>
          </ul>
        </li>
        <li><a href="#hook-api-ç´¢å¼•">Hook API ç´¢å¼•</a>
          <ul>
            <li><a href="#åŸºç¡€-hook">åŸºç¡€ Hook</a>
              <ul>
                <li><a href="#usestate"><code>useState</code></a>
                  <ul>
                    <li><a href="#å‡½æ•°å¼æ›´æ–°">å‡½æ•°å¼æ›´æ–°</a></li>
                    <li><a href="#æƒ°æ€§åˆå§‹-state">æƒ°æ€§åˆå§‹ state</a></li>
                    <li><a href="#è·³è¿‡-state-æ›´æ–°">è·³è¿‡ state æ›´æ–°</a></li>
                    <li><a href="#batching-of-state-updates">Batching of state updates</a></li>
                  </ul>
                </li>
                <li><a href="#useeffect"><code>useEffect</code></a>
                  <ul>
                    <li><a href="#æ¸…é™¤-effect">æ¸…é™¤ effect</a></li>
                    <li><a href="#effect-çš„æ‰§è¡Œæ—¶æœº">effect çš„æ‰§è¡Œæ—¶æœº</a></li>
                    <li><a href="#effect-çš„æ¡ä»¶æ‰§è¡Œ">effect çš„æ¡ä»¶æ‰§è¡Œ</a></li>
                  </ul>
                </li>
                <li><a href="#usecontext"><code>useContext</code></a></li>
              </ul>
            </li>
            <li><a href="#é¢å¤–çš„-hook">é¢å¤–çš„ Hook</a>
              <ul>
                <li><a href="#usereducer"><code>useReducer</code></a>
                  <ul>
                    <li><a href="#æŒ‡å®šåˆå§‹-state">æŒ‡å®šåˆå§‹ state</a></li>
                    <li><a href="#æƒ°æ€§åˆå§‹åŒ–">æƒ°æ€§åˆå§‹åŒ–</a></li>
                    <li><a href="#è·³è¿‡-dispatch">è·³è¿‡ dispatch</a></li>
                  </ul>
                </li>
                <li><a href="#usecallback"><code>useCallback</code></a></li>
                <li><a href="#usememo"><code>useMemo</code></a></li>
                <li><a href="#useref"><code>useRef</code></a></li>
                <li><a href="#useimperativehandle"><code>useImperativeHandle</code></a></li>
                <li><a href="#uselayouteffect"><code>useLayoutEffect</code></a></li>
                <li><a href="#usedebugvalue"><code>useDebugValue</code></a>
                  <ul>
                    <li><a href="#å»¶è¿Ÿæ ¼å¼åŒ–-debug-å€¼">å»¶è¿Ÿæ ¼å¼åŒ– debug å€¼</a></li>
                  </ul>
                </li>
                <li><a href="#usedeferredvalue"><code>useDeferredValue</code></a>
                  <ul>
                    <li><a href="#memoizing-deferred-children">Memoizing deferred children</a></li>
                  </ul>
                </li>
                <li><a href="#usetransition"><code>useTransition</code></a></li>
                <li><a href="#useid"><code>useId</code></a></li>
              </ul>
            </li>
            <li><a href="#library-hooks">Library Hooks</a>
              <ul>
                <li><a href="#usesyncexternalstore"><code>useSyncExternalStore</code></a></li>
                <li><a href="#useinsertioneffect"><code>useInsertionEffect</code></a></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#åº”ç”¨åœºæ™¯">åº”ç”¨åœºæ™¯</a>
      <ul>
        <li><a href="#å¦‚ä½•è§£å†³-jax-ä¸­-html-ä»£ç æ®µè¢«è¯†åˆ«ä¸ºå­—ç¬¦ä¸²çš„é—®é¢˜">å¦‚ä½•è§£å†³ JAX ä¸­ HTML ä»£ç æ®µè¢«è¯†åˆ«ä¸ºå­—ç¬¦ä¸²çš„é—®é¢˜?</a>
          <ul>
            <li><a href="#é—®é¢˜æè¿°">é—®é¢˜æè¿°</a></li>
            <li><a href="#äº§ç”ŸåŸå› ">äº§ç”ŸåŸå› </a></li>
            <li><a href="#è§£å†³æ–¹å¼">è§£å†³æ–¹å¼</a></li>
          </ul>
        </li>
        <li><a href="#å¦‚ä½•å¤„ç†-react-å’Œç›´æ¥ä¿®æ”¹-dom-çš„å‰ç«¯æ¡†æ¶çš„å…¼å®¹æ€§é—®é¢˜">å¦‚ä½•å¤„ç† React å’Œç›´æ¥ä¿®æ”¹ DOM çš„å‰ç«¯æ¡†æ¶çš„å…¼å®¹æ€§é—®é¢˜?</a>
          <ul>
            <li><a href="#é—®é¢˜æè¿°-1">é—®é¢˜æè¿°</a>
              <ul>
                <li><a href="#react-å’Œ-jquery-ui-sortable">React å’Œ JQuery UI Sortable</a></li>
                <li><a href="#react-å’Œ-jquery-tipsy">React å’Œ JQuery tipsy</a></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="ç®€ä»‹" class="headerLink">
    <a href="#%e7%ae%80%e4%bb%8b" class="header-mark"></a>ç®€ä»‹</h2><p>React æ˜¯ä¸€ä¸ªç”¨äºæ„å»ºç”¨æˆ·ç•Œé¢çš„ JavaScript åº“ã€‚(å°±æ˜¯ä¸ªçŠ¶æ€æœºï¼Œå°†æ ¹æ®æ•°æ®æºæ˜ å°„å‡º UIï¼Œéµå®ˆä¸€å®šçš„è§„èŒƒå¯ä»¥å°†ï¼ŒUI å’Œ é€»è¾‘åˆ†ç¦»ï¼Œæ›´å®¹æ˜“è°ƒè¯•å’Œç¼–å†™å•å…ƒæµ‹è¯•)</p>
<blockquote>
<p>å£°æ˜å¼<br>
React å¯ä»¥éå¸¸è½»æ¾åœ°åˆ›å»ºç”¨æˆ·äº¤äº’ç•Œé¢ã€‚ä¸ºä½ åº”ç”¨çš„æ¯ä¸€ä¸ªçŠ¶æ€è®¾è®¡ç®€æ´çš„è§†å›¾ï¼Œåœ¨æ•°æ®æ”¹å˜æ—¶ React ä¹Ÿå¯ä»¥é«˜æ•ˆåœ°æ›´æ–°æ¸²æŸ“ç•Œé¢ã€‚ä»¥å£°æ˜å¼ç¼–å†™ UIï¼Œå¯ä»¥è®©ä½ çš„ä»£ç æ›´åŠ å¯é ï¼Œä¸”æ–¹ä¾¿è°ƒè¯•ã€‚<br>
ç»„ä»¶åŒ–<br>
åˆ›å»ºå¥½æ‹¥æœ‰å„è‡ªçŠ¶æ€çš„ç»„ä»¶ï¼Œå†ç”±ç»„ä»¶æ„æˆæ›´åŠ å¤æ‚çš„ç•Œé¢ã€‚æ— éœ€å†ç”¨æ¨¡ç‰ˆä»£ç ï¼Œé€šè¿‡ä½¿ç”¨ JavaScript ç¼–å†™çš„ç»„ä»¶ä½ å¯ä»¥æ›´å¥½åœ°ä¼ é€’æ•°æ®ï¼Œå°†åº”ç”¨çŠ¶æ€å’Œ DOM æ‹†åˆ†å¼€æ¥ã€‚</p>
</blockquote>
<iframe
  class="website-card-embed"
  data-src="https://website-card-embed.dramacat.top/?url=https%3a%2f%2freact.docschina.org%2fdocs%2fhello-world.html"
  style="width: 100%; height: 124px"
  frameborder="no"
></iframe>
<h2 id="åŸºç¡€" class="headerLink">
    <a href="#%e5%9f%ba%e7%a1%80" class="header-mark"></a>åŸºç¡€</h2><h3 id="hello-world" class="headerLink">
    <a href="#hello-world" class="header-mark"></a>Hello World</h3><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JSX" data-lang="JSX"><span class="line"><span class="cl"><span class="nx">ReactDOM</span><span class="p">.</span><span class="nx">render</span><span class="p">(&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Hello</span><span class="p">,</span> <span class="nx">world</span><span class="o">!</span><span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;,</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&#34;root&#34;</span><span class="p">));</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="ç†è§£-jsx" class="headerLink">
    <a href="#%e7%90%86%e8%a7%a3-jsx" class="header-mark"></a>ç†è§£ JSX</h3><ul>
<li>æœ¬è´¨ : ä¸æ˜¯æ¨¡æ¿å¼•æ“è€Œæ˜¯åŠ¨æ€åˆ›å»ºç»„ä»¶(ä½¿ç”¨ JavaScript åŸç”Ÿçš„ DOM API <code>document.createElement()</code>)çš„è¯­æ³•ç³–ã€‚JSX é˜²æ³¨å…¥æ”»å‡»ã€‚React DOM åœ¨æ¸²æŸ“ä¹‹å‰é»˜è®¤ä¼šè¿‡æ»¤æ‰€æœ‰ä¼ å…¥çš„å€¼ã€‚å®ƒå¯ä»¥ç¡®ä¿ä½ çš„åº”ç”¨ä¸ä¼šè¢«æ³¨å…¥æ”»å‡»ã€‚æ‰€æœ‰çš„å†…å®¹åœ¨æ¸²æŸ“ä¹‹å‰éƒ½è¢«è½¬æ¢æˆäº†å­—ç¬¦ä¸²ã€‚è¿™æ ·å¯ä»¥æœ‰æ•ˆåœ°é˜²æ­¢ XSS(è·¨ç«™è„šæœ¬)æ”»å‡»ã€‚</li>
<li>å¯¹æ¯”å…¶ä»–æ¨¡æ¿è¯­è¨€çš„ä¼˜ç‚¹
<ul>
<li>ä½¿ç”¨å£°æ˜å¼åˆ›å»ºé¡µé¢æ¯”è¾ƒç›´è§‚</li>
<li>ä½¿ç”¨ä»£ç åˆ›å»ºé¡µé¢ååˆ†çµæ´»</li>
<li>ä¸éœ€è¦å­¦ä¹ ä¸€é—¨æ–°çš„æ¨¡æ¿è¯­è¨€</li>
</ul>
</li>
<li>çº¦å®š
<ul>
<li>React è®¤ä¸ºå°å†™çš„ tag æ˜¯åŸç”Ÿçš„ DOM èŠ‚ç‚¹ï¼Œä¾‹å¦‚:<code>&lt;div&gt;</code>ã€‚</li>
<li>å¤§å†™å­—æ¯å¼€å¤´çš„ä¸ºè‡ªå®šä¹‰ç»„ä»¶ã€‚</li>
<li>JAX æ ‡è®°å¯ä»¥ç›´æ¥ä½¿ç”¨å±æ€§è¯­æ³•ï¼Œä¾‹å¦‚:<code>&lt;menu.Item&gt;</code>ã€‚</li>
</ul>
</li>
</ul>
<h3 id="å…ƒç´ æ¸²æŸ“" class="headerLink">
    <a href="#%e5%85%83%e7%b4%a0%e6%b8%b2%e6%9f%93" class="header-mark"></a>å…ƒç´ æ¸²æŸ“</h3><p>React åªä¼šæ›´æ–°å¿…è¦çš„éƒ¨åˆ†ã€‚React DOM é¦–å…ˆä¼šæ¯”è¾ƒå…ƒç´ å†…å®¹å…ˆåçš„ä¸åŒï¼Œè€Œåœ¨æ¸²æŸ“è¿‡ç¨‹ä¸­åªä¼šæ›´æ–°æ”¹å˜äº†çš„éƒ¨åˆ†ã€‚æ ¹æ®æˆ‘ä»¬ä»¥å¾€çš„ç»éªŒï¼Œå°†ç•Œé¢è§†ä¸ºä¸€ä¸ªä¸ªç‰¹å®šæ—¶åˆ»çš„å›ºå®šå†…å®¹ï¼ˆå°±åƒä¸€å¸§ä¸€å¸§çš„åŠ¨ç”»ï¼‰ï¼Œè€Œä¸æ˜¯éšæ—¶å¤„äºå˜åŒ–ä¹‹ä¸­ï¼ˆè€Œä¸æ˜¯å¤„äºå˜åŒ–ä¸­çš„ä¸€æ•´æ®µåŠ¨ç”»ï¼‰ï¼Œå°†ä¼šæœ‰åˆ©äºæˆ‘ä»¬ç†æ¸…å¼€å‘æ€è·¯ï¼Œå‡å°‘å„ç§ bugã€‚</p>
<h3 id="ç†è§£-react-ç»„ä»¶" class="headerLink">
    <a href="#%e7%90%86%e8%a7%a3-react-%e7%bb%84%e4%bb%b6" class="header-mark"></a>ç†è§£ React ç»„ä»¶</h3><h4 id="æ¦‚å¿µ" class="headerLink">
    <a href="#%e6%a6%82%e5%bf%b5" class="header-mark"></a>æ¦‚å¿µ</h4><ul>
<li>React ç»„ä»¶ä¸€èˆ¬ä¸æä¾›æ–¹æ³•ï¼Œè€Œæ˜¯æŸç§çŠ¶æ€æœºã€‚</li>
<li>React ç»„ä»¶å¯ä»¥ç†è§£ä¸ºä¸€ä¸ªçº¯å‡½æ•°(è¾“å…¥æ˜¯ä»€ä¹ˆç»“æœä¸€å®šæ˜¯ä»€ä¹ˆ)ã€‚</li>
<li>å•å‘æ•°æ®ç»‘å®š(å¤–éƒ¨é€šè¿‡ props ä¼ é€’å‚æ•°ç»™å†…éƒ¨ï¼Œå†…éƒ¨å‘ç”Ÿå˜åŒ–æ—¶æš´éœ²äº‹ä»¶ç»™å¤–éƒ¨)ã€‚</li>
</ul>
<h4 id="å®ä¾‹" class="headerLink">
    <a href="#%e5%ae%9e%e4%be%8b" class="header-mark"></a>å®ä¾‹</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JSX" data-lang="JSX"><span class="line"><span class="cl"><span class="c1">//JavaScriptå‡½æ•°æ–¹å¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">Welcome</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Hello</span><span class="p">,</span> <span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="p">}&lt;/</span><span class="nt">h1</span><span class="p">&gt;;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//ES6 class å®šä¹‰ä¸€ä¸ªç»„ä»¶(ä½¿ç”¨ç±»å°±å…è®¸æˆ‘ä»¬ä½¿ç”¨å…¶å®ƒç‰¹æ€§ï¼Œä¾‹å¦‚å±€éƒ¨çŠ¶æ€ã€ç”Ÿå‘½å‘¨æœŸé’©å­)
</span></span></span><span class="line"><span class="cl"><span class="c1">//ç»„ä»¶åç§°å¿…é¡»ä»¥å¤§å†™å­—æ¯å¼€å¤´ã€‚
</span></span></span><span class="line"><span class="cl"><span class="c1">//ç»„ä»¶çš„è¿”å›å€¼åªèƒ½æœ‰ä¸€ä¸ªæ ¹å…ƒç´ ã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä»¬è¦ç”¨ä¸€ä¸ª&lt;div&gt;æ¥åŒ…è£¹æ‰€æœ‰&lt;Welcome /&gt;å…ƒç´ çš„åŸå› ã€‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">class</span> <span class="nx">Welcome</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;</span><span class="nx">Hello</span><span class="p">,</span> <span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">name</span><span class="p">}&lt;/</span><span class="nt">h1</span><span class="p">&gt;;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="åˆ›å»ºä¸€ä¸ª-react-ç»„ä»¶" class="headerLink">
    <a href="#%e5%88%9b%e5%bb%ba%e4%b8%80%e4%b8%aa-react-%e7%bb%84%e4%bb%b6" class="header-mark"></a>åˆ›å»ºä¸€ä¸ª React ç»„ä»¶</h4><ul>
<li>æ–¹æ³•è®º
<ol>
<li>åˆ›å»ºé™æ€ UI(åŸå‹)ã€‚</li>
<li>è€ƒè™‘ç»„ä»¶çš„çŠ¶æ€ç»„æˆ(å¤–éƒ¨ä¼ é€’è¿˜æ˜¯å†…éƒ¨ç»´æŠ¤)ã€‚</li>
<li>è€ƒè™‘ç»„ä»¶çš„äº¤äº’æ–¹å¼(å†…éƒ¨ç”¨æˆ·è¿›è¡Œçš„æ“ä½œå¦‚ä½•æš´éœ²ç»™å¤–éƒ¨çš„äººä½¿ç”¨)ã€‚</li>
</ol>
</li>
<li>å•ä¸€èŒè´£åŸåˆ™
<ol>
<li>æ¯ä¸ªç»„ä»¶åªåšä¸€ä»¶äº‹ã€‚</li>
<li>å¦‚æœç»„ä»¶å˜å¾—å¤æ‚ï¼Œé‚£ä¹ˆåº”è¯¥æ‹†åˆ†æˆå°çš„ç»„ä»¶(æ‹†åˆ†å°ç»„ä»¶å¯ä»¥åœ¨é™ä½å¤æ‚åº¦çš„åŒæ—¶æé«˜æ€§èƒ½ï¼Œå¯¹ç»„ä»¶çŠ¶æ€è¿›è¡Œæ›´æ–°æ—¶åˆ·æ–°èŒƒå›´å˜å°)ã€‚</li>
</ol>
</li>
<li>DRY åŸåˆ™
<ol>
<li>èƒ½å¤Ÿè®¡ç®—å¾—åˆ°çš„çŠ¶æ€å°±ä¸è¦å•ç‹¬å­˜å‚¨ã€‚</li>
<li>ç»„ä»¶å°½é‡æ— çŠ¶æ€ï¼Œæ‰€éœ€æ•°æ®é€šè¿‡ props è·å–ã€‚</li>
</ol>
</li>
</ul>
<h4 id="å—æ§ç»„ä»¶å’Œéå—æ§ç»„ä»¶" class="headerLink">
    <a href="#%e5%8f%97%e6%8e%a7%e7%bb%84%e4%bb%b6%e5%92%8c%e9%9d%9e%e5%8f%97%e6%8e%a7%e7%bb%84%e4%bb%b6" class="header-mark"></a>å—æ§ç»„ä»¶å’Œéå—æ§ç»„ä»¶</h4><ul>
<li>å—æ§ç»„ä»¶ : ç»„ä»¶æˆ–è¡¨å•å…ƒç´ çŠ¶æ€ç”±ä½¿ç”¨è€…ç»´æŠ¤ã€‚React ä¸­è¡¨å•å…ƒç´ é€šå¸¸ä½œä¸ºå—æ§ç»„ä»¶ä½¿ç”¨ã€‚å¯¹å¤–æš´éœ²ä¿®æ”¹äº‹ä»¶çš„é™æ€ç»„ä»¶ä¹Ÿå±äºå—æ§ç»„ä»¶ã€‚</li>
<li>éå—æ§ç»„ä»¶ : ç»„ä»¶çŠ¶æ€ç”±è‡ªèº«ç»´æŠ¤ï¼Œæˆ–è¡¨å•å…ƒç´ çŠ¶æ€ç”± DOM è‡ªèº«ç»´æŠ¤ã€‚</li>
</ul>
<h3 id="props" class="headerLink">
    <a href="#props" class="header-mark"></a>Props</h3><ul>
<li>å½“ React é‡åˆ°çš„å…ƒç´ æ˜¯ç”¨æˆ·è‡ªå®šä¹‰çš„ç»„ä»¶ï¼Œå®ƒä¼šå°† JSX å±æ€§ä½œä¸ºå•ä¸ªå¯¹è±¡ä¼ é€’ç»™è¯¥ç»„ä»¶ï¼Œè¿™ä¸ªå¯¹è±¡ç§°ä¹‹ä¸ºâ€œpropsâ€ã€‚</li>
<li>Props çš„åªè¯»æ€§ã€‚æ— è®ºæ˜¯ä½¿ç”¨å‡½æ•°æˆ–æ˜¯ç±»æ¥å£°æ˜ä¸€ä¸ªç»„ä»¶ï¼Œå®ƒå†³ä¸èƒ½ä¿®æ”¹å®ƒè‡ªå·±çš„ propsã€‚</li>
<li>æˆ‘ä»¬å»ºè®®ä»ç»„ä»¶è‡ªèº«çš„è§’åº¦æ¥å‘½å propsï¼Œè€Œä¸æ˜¯æ ¹æ®ä½¿ç”¨ç»„ä»¶çš„ä¸Šä¸‹æ–‡å‘½åã€‚</li>
<li>React æ˜¯éå¸¸çµæ´»çš„ï¼Œä½†å®ƒä¹Ÿæœ‰ä¸€ä¸ªä¸¥æ ¼çš„è§„åˆ™ï¼šæ‰€æœ‰çš„ React ç»„ä»¶å¿…é¡»åƒçº¯å‡½æ•°é‚£æ ·ä½¿ç”¨å®ƒä»¬çš„ propsã€‚</li>
</ul>
<h3 id="state" class="headerLink">
    <a href="#state" class="header-mark"></a>State</h3><ul>
<li>ä¸è¦ç›´æ¥æ›´æ–°çŠ¶æ€ã€‚åº”å½“ä½¿ç”¨ setState()ã€‚æ„é€ å‡½æ•°æ˜¯å”¯ä¸€èƒ½å¤Ÿåˆå§‹åŒ– this.state çš„åœ°æ–¹ã€‚</li>
<li>çŠ¶æ€æ›´æ–°å¯èƒ½æ˜¯å¼‚æ­¥çš„ã€‚React å¯ä»¥å°†å¤šä¸ª setState() è°ƒç”¨åˆå¹¶æˆä¸€ä¸ªè°ƒç”¨æ¥æé«˜æ€§èƒ½ã€‚å› ä¸º this.props å’Œ this.state å¯èƒ½æ˜¯å¼‚æ­¥æ›´æ–°çš„ï¼Œä½ ä¸åº”è¯¥ä¾é å®ƒä»¬çš„å€¼æ¥è®¡ç®—ä¸‹ä¸€ä¸ªçŠ¶æ€ã€‚</li>
<li>æ•°æ®è‡ªé¡¶å‘ä¸‹æµåŠ¨ã€‚çˆ¶ç»„ä»¶æˆ–å­ç»„ä»¶éƒ½ä¸èƒ½çŸ¥é“æŸä¸ªç»„ä»¶æ˜¯æœ‰çŠ¶æ€è¿˜æ˜¯æ— çŠ¶æ€ï¼Œå¹¶ä¸”å®ƒä»¬ä¸åº”è¯¥å…³å¿ƒæŸç»„ä»¶æ˜¯è¢«å®šä¹‰ä¸ºä¸€ä¸ªå‡½æ•°è¿˜æ˜¯ä¸€ä¸ªç±»ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆçŠ¶æ€é€šå¸¸è¢«ç§°ä¸ºå±€éƒ¨æˆ–å°è£…ã€‚ é™¤äº†æ‹¥æœ‰å¹¶è®¾ç½®å®ƒçš„ç»„ä»¶å¤–ï¼Œå…¶å®ƒç»„ä»¶ä¸å¯è®¿é—®ã€‚è¿™é€šå¸¸è¢«ç§°ä¸ºè‡ªé¡¶å‘ä¸‹æˆ–å•å‘æ•°æ®æµã€‚ ä»»ä½•çŠ¶æ€å§‹ç»ˆç”±æŸäº›ç‰¹å®šç»„ä»¶æ‰€æœ‰ï¼Œå¹¶ä¸”ä»è¯¥çŠ¶æ€å¯¼å‡ºçš„ä»»ä½•æ•°æ®æˆ– UI åªèƒ½å½±å“æ ‘ä¸­ä¸‹æ–¹çš„ç»„ä»¶ã€‚</li>
<li>ç»è¿‡è®¡ç®—åçš„å€¼ä¸åº”è¯¥èµ‹ç»™ stateï¼Œæ­£ç¡®çš„æ¨¡å¼åº”è¯¥æ˜¯åœ¨æ¸²æŸ“æ—¶è®¡ç®—è¿™äº›å€¼ã€‚è¿™æ ·ä¿è¯äº†è®¡ç®—åçš„å€¼æ°¸è¿œä¸ä¼šä¸æ´¾ç”Ÿå‡ºå®ƒçš„ props å€¼ä¸åŒæ­¥ã€‚</li>
<li>åœ¨ React åº”ç”¨ç¨‹åºä¸­ï¼Œç»„ä»¶æ˜¯æœ‰çŠ¶æ€è¿˜æ˜¯æ— çŠ¶æ€è¢«è®¤ä¸ºæ˜¯å¯èƒ½éšæ—¶é—´è€Œå˜åŒ–çš„ç»„ä»¶çš„å®ç°ç»†èŠ‚ã€‚ å¯ä»¥åœ¨æœ‰çŠ¶æ€ç»„ä»¶ä¸­ä½¿ç”¨æ— çŠ¶æ€ç»„ä»¶ï¼Œåä¹‹äº¦ç„¶ã€‚</li>
</ul>
<h3 id="react-ç»„ä»¶ç”Ÿå‘½å‘¨æœŸåŠä½¿ç”¨åœºæ™¯" class="headerLink">
    <a href="#react-%e7%bb%84%e4%bb%b6%e7%94%9f%e5%91%bd%e5%91%a8%e6%9c%9f%e5%8f%8a%e4%bd%bf%e7%94%a8%e5%9c%ba%e6%99%af" class="header-mark"></a>React ç»„ä»¶ç”Ÿå‘½å‘¨æœŸåŠä½¿ç”¨åœºæ™¯</h3><p><figure><a class="lightgallery" href="https://jsd.cdn.zzko.cn/gh/orionpax1997/picx-images-hosting@master/Development/React-%e7%bb%84%e4%bb%b6%e7%94%9f%e5%91%bd%e5%91%a8%e6%9c%9f.6y049l0vfm80.webp" title="React-ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ" data-thumbnail="https://jsd.cdn.zzko.cn/gh/orionpax1997/picx-images-hosting@master/Development/React-ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ.6y049l0vfm80.webp" data-sub-html="<h2>React ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ</h2><p>React-ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ</p>">
        <img
            
            loading="lazy"
            src="https://jsd.cdn.zzko.cn/gh/orionpax1997/picx-images-hosting@master/Development/React-%e7%bb%84%e4%bb%b6%e7%94%9f%e5%91%bd%e5%91%a8%e6%9c%9f.6y049l0vfm80.webp"
            srcset="https://jsd.cdn.zzko.cn/gh/orionpax1997/picx-images-hosting@master/Development/React-%e7%bb%84%e4%bb%b6%e7%94%9f%e5%91%bd%e5%91%a8%e6%9c%9f.6y049l0vfm80.webp, https://jsd.cdn.zzko.cn/gh/orionpax1997/picx-images-hosting@master/Development/React-%e7%bb%84%e4%bb%b6%e7%94%9f%e5%91%bd%e5%91%a8%e6%9c%9f.6y049l0vfm80.webp 1.5x, https://jsd.cdn.zzko.cn/gh/orionpax1997/picx-images-hosting@master/Development/React-%e7%bb%84%e4%bb%b6%e7%94%9f%e5%91%bd%e5%91%a8%e6%9c%9f.6y049l0vfm80.webp 2x"
            alt="React-ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ">
    </a><figcaption class="image-caption">React ç»„ä»¶ç”Ÿå‘½å‘¨æœŸ</figcaption>
    </figure></p>
<ul>
<li>render()
<ul>
<li>å”¯ä¸€å¿…é¡»å®ç°çš„æ–¹æ³•</li>
<li>render() å‡½æ•°åº”è¯¥ä¸ºçº¯å‡½æ•°ï¼Œè¿™æ„å‘³ç€åœ¨ä¸ä¿®æ”¹ç»„ä»¶ state çš„æƒ…å†µä¸‹ï¼Œæ¯æ¬¡è°ƒç”¨æ—¶éƒ½è¿”å›ç›¸åŒçš„ç»“æœï¼Œå¹¶ä¸”å®ƒä¸ä¼šç›´æ¥ä¸æµè§ˆå™¨äº¤äº’ã€‚</li>
</ul>
</li>
<li>constructor(props)
<ul>
<li>ç”¨äºåˆå§‹åŒ–å†…éƒ¨çŠ¶æ€(å¾ˆå°‘ä½¿ç”¨)</li>
<li>å”¯ä¸€å¯ä»¥ç›´æ¥ä¿®æ”¹ state çš„åœ°æ–¹</li>
</ul>
</li>
<li>static getDerivedStateFromProps(props, state)
<ul>
<li>å½“ state éœ€è¦ä» props åˆå§‹åŒ–æ—¶ä½¿ç”¨</li>
<li>å°½é‡ä¸è¦ä½¿ç”¨(ç»´æŠ¤ä¸¤è€…çŠ¶æ€ä¸€è‡´æ€§ä¼šå¢åŠ å¤æ‚åº¦)</li>
<li>æ¯æ¬¡ render éƒ½ä¼šè°ƒç”¨</li>
<li>å…¸å‹åœºæ™¯ï¼šè¡¨å•æ§ä»¶è·å–é»˜è®¤å€¼</li>
</ul>
</li>
<li>componentDidMount()
<ul>
<li>UI æ¸²æŸ“å®Œæˆåè°ƒç”¨</li>
<li>åªæ‰§è¡Œä¸€æ¬¡</li>
<li>å…¸å‹åœºæ™¯ï¼šè·å–å¤–éƒ¨èµ„æºåˆå§‹åŒ– state</li>
</ul>
</li>
<li>componentWillUnmount()
<ul>
<li>ç»„ä»¶ç§»é™¤æ—¶è°ƒç”¨</li>
<li>å…¸å‹åœºæ™¯ï¼šé‡Šæ”¾èµ„æº</li>
</ul>
</li>
<li>getSnapshotBeforeUpdate(prevProps, prevState)
<ul>
<li>åœ¨æœ€è¿‘ä¸€æ¬¡æ¸²æŸ“è¾“å‡ºï¼ˆæäº¤åˆ° DOM èŠ‚ç‚¹ï¼‰ä¹‹å‰è°ƒç”¨ã€‚</li>
<li>å…¸å‹åœºæ™¯ï¼šè·å– render ä¹‹å‰çš„ DOM çŠ¶æ€(ä¾‹å¦‚ï¼šæ»šåŠ¨ä½ç½®)</li>
</ul>
</li>
<li>componentDidUpdate(prevProps, prevState, snapshot)
<ul>
<li>æ¯æ¬¡ UI æ›´æ–°æ—¶è°ƒç”¨</li>
<li>å…¸å‹åœºæ™¯ï¼šé¡µé¢éœ€è¦æ ¹æ® props å˜åŒ–é‡æ–°è·å–æ•°æ®</li>
</ul>
</li>
<li>shouldComponentUpdate(nextProps, nextState)
<ul>
<li>å†³å®š Virtual DOM æ˜¯å¦è¦é‡ç»˜</li>
<li>ä¸€èˆ¬å¯ä»¥ç”± PureComponent è‡ªåŠ¨å®ç°</li>
<li>å…¸å‹åœºæ™¯ï¼šæ€§èƒ½ä¼˜åŒ–</li>
</ul>
</li>
</ul>
<h3 id="react-äº‹ä»¶å¤„ç†" class="headerLink">
    <a href="#react-%e4%ba%8b%e4%bb%b6%e5%a4%84%e7%90%86" class="header-mark"></a>React äº‹ä»¶å¤„ç†</h3><ul>
<li>React äº‹ä»¶ç»‘å®šå±æ€§çš„å‘½åé‡‡ç”¨é©¼å³°å¼å†™æ³•ï¼Œè€Œä¸æ˜¯å°å†™ã€‚</li>
<li>å¦‚æœé‡‡ç”¨ JSX çš„è¯­æ³•ä½ éœ€è¦ä¼ å…¥ä¸€ä¸ªå‡½æ•°ä½œä¸ºäº‹ä»¶å¤„ç†å‡½æ•°ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²(DOM å…ƒç´ çš„å†™æ³•)</li>
<li>åœ¨ React ä¸­å¦ä¸€ä¸ªä¸åŒæ˜¯ä½ ä¸èƒ½ä½¿ç”¨è¿”å› false çš„æ–¹å¼é˜»æ­¢é»˜è®¤è¡Œä¸ºã€‚ä½ å¿…é¡»æ˜ç¡®çš„ä½¿ç”¨ preventDefaultã€‚</li>
<li>ä½ å¿…é¡»è°¨æ…å¯¹å¾… JSX å›è°ƒå‡½æ•°ä¸­çš„ thisï¼Œç±»çš„æ–¹æ³•é»˜è®¤æ˜¯ä¸ä¼šç»‘å®š this çš„ã€‚å¦‚æœä½ å¿˜è®°ç»‘å®š this, å½“ä½ è°ƒç”¨è¿™ä¸ªå‡½æ•°çš„æ—¶å€™ this çš„å€¼ä¼šæ˜¯ undefinedã€‚</li>
<li>å‘äº‹ä»¶å¤„ç†ç¨‹åºä¼ é€’å‚æ•°
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JSX" data-lang="JSX"><span class="line"><span class="cl"><span class="c1">//ä¸¤ç§æ–¹å¼æ˜¯ç­‰ä»·çš„ï¼Œåˆ†åˆ«é€šè¿‡ arrow functions å’Œ Function.prototype.bind æ¥ä¸ºäº‹ä»¶å¤„ç†å‡½æ•°ä¼ é€’å‚æ•°ã€‚
</span></span></span><span class="line"><span class="cl"><span class="c1">//é€šè¿‡ç®­å¤´å‡½æ•°çš„æ–¹å¼ï¼Œäº‹ä»¶å¯¹è±¡å¿…é¡»æ˜¾å¼çš„è¿›è¡Œä¼ é€’
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">&lt;</span><span class="nt">button</span> <span class="na">onClick</span><span class="o">=</span><span class="p">{(</span><span class="nx">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="k">this</span><span class="p">.</span><span class="nx">deleteRow</span><span class="p">(</span><span class="nx">id</span><span class="p">,</span> <span class="nx">e</span><span class="p">)}&gt;</span><span class="nx">Delete</span> <span class="nx">Row</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1">//ä½†æ˜¯é€šè¿‡ bind çš„æ–¹å¼ï¼Œäº‹ä»¶å¯¹è±¡ä»¥åŠæ›´å¤šçš„å‚æ•°å°†ä¼šè¢«éšå¼çš„è¿›è¡Œä¼ é€’ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œé€šè¿‡ bind æ–¹å¼å‘ç›‘å¬å‡½æ•°ä¼ å‚ï¼Œåœ¨ç±»ç»„ä»¶ä¸­å®šä¹‰çš„ç›‘å¬å‡½æ•°ï¼Œäº‹ä»¶å¯¹è±¡ e è¦æ’åœ¨æ‰€ä¼ é€’å‚æ•°çš„åé¢ã€‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">&lt;</span><span class="nt">button</span> <span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">deleteRow</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">id</span><span class="p">)}&gt;</span><span class="nx">Delete</span> <span class="nx">Row</span><span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="æ¡ä»¶æ¸²æŸ“" class="headerLink">
    <a href="#%e6%9d%a1%e4%bb%b6%e6%b8%b2%e6%9f%93" class="header-mark"></a>æ¡ä»¶æ¸²æŸ“</h3><ul>
<li>ä¸è¿ç®—ç¬¦ &amp;&amp;</li>
<li>ä¸‰ç›®è¿ç®—ç¬¦</li>
<li>é˜»æ­¢ç»„ä»¶æ¸²æŸ“ã€‚åœ¨æå°‘æ•°æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½å¸Œæœ›éšè—ç»„ä»¶ï¼Œå³ä½¿å®ƒè¢«å…¶ä»–ç»„ä»¶æ¸²æŸ“ã€‚è®© render æ–¹æ³•è¿”å› null è€Œä¸æ˜¯å®ƒçš„æ¸²æŸ“ç»“æœå³å¯å®ç°ã€‚</li>
</ul>
<h3 id="keys" class="headerLink">
    <a href="#keys" class="header-mark"></a>Keys</h3><ul>
<li>Keys å¯ä»¥åœ¨ DOM ä¸­çš„æŸäº›å…ƒç´ è¢«å¢åŠ æˆ–åˆ é™¤çš„æ—¶å€™å¸®åŠ© React è¯†åˆ«å“ªäº›å…ƒç´ å‘ç”Ÿäº†å˜åŒ–ã€‚å› æ­¤ä½ åº”å½“ç»™æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ èµ‹äºˆä¸€ä¸ªç¡®å®šçš„æ ‡è¯†ã€‚</li>
<li>ä¸€ä¸ªå…ƒç´ çš„ key æœ€å¥½æ˜¯è¿™ä¸ªå…ƒç´ åœ¨åˆ—è¡¨ä¸­æ‹¥æœ‰çš„ä¸€ä¸ªç‹¬ä¸€æ— äºŒçš„å­—ç¬¦ä¸²ã€‚é€šå¸¸ï¼Œæˆ‘ä»¬ä½¿ç”¨æ¥è‡ªæ•°æ®çš„ id ä½œä¸ºå…ƒç´ çš„ keyã€‚å½“å…ƒç´ æ²¡æœ‰ç¡®å®šçš„ id æ—¶ï¼Œä½ å¯ä»¥ä½¿ç”¨ä»–çš„åºåˆ—å·ç´¢å¼• index ä½œä¸º keyã€‚==å¦‚æœåˆ—è¡¨é¡¹ç›®çš„é¡ºåºå¯èƒ½ä¼šå˜åŒ–ï¼Œæˆ‘ä»¬ä¸å»ºè®®ä½¿ç”¨ç´¢å¼•æ¥ç”¨ä½œé”®å€¼ï¼Œå› ä¸ºè¿™æ ·åšä¼šå¯¼è‡´æ€§èƒ½çš„è´Ÿé¢å½±å“==ï¼Œè¿˜å¯èƒ½å¼•èµ·ç»„ä»¶çŠ¶æ€é—®é¢˜ã€‚å¦‚æœä½ é€‰æ‹©ä¸æŒ‡å®šæ˜¾å¼çš„é”®å€¼ï¼Œé‚£ä¹ˆ React å°†é»˜è®¤ä½¿ç”¨ç´¢å¼•ç”¨ä½œä¸ºåˆ—è¡¨é¡¹ç›®çš„é”®å€¼ã€‚</li>
<li>å…ƒç´ çš„ key åªæœ‰æ”¾åœ¨å…¶ç¯ç»•æ•°ç»„çš„ä¸Šä¸‹æ–‡ä¸­æ‰æœ‰æ„ä¹‰ã€‚æ¯”æ–¹è¯´ï¼Œå¦‚æœä½ æå–å‡ºä¸€ä¸ª ListItem ç»„ä»¶ï¼Œä½ åº”è¯¥æŠŠ key ä¿å­˜åœ¨æ•°ç»„ä¸­çš„è¿™ä¸ª&lt;ListItem /&gt;å…ƒç´ ä¸Šï¼Œè€Œä¸æ˜¯æ”¾åœ¨ ListItem ç»„ä»¶ä¸­çš„&lt;li&gt;å…ƒç´ ä¸Šã€‚</li>
</ul>
<h3 id="è¡¨å•" class="headerLink">
    <a href="#%e8%a1%a8%e5%8d%95" class="header-mark"></a>è¡¨å•</h3><ul>
<li>
<p>åœ¨ HTML å½“ä¸­ï¼Œåƒ<code>&lt;input&gt;</code>,<code>&lt;textarea&gt;</code>, å’Œ <code>&lt;select&gt;</code>è¿™ç±»è¡¨å•å…ƒç´ ä¼šç»´æŒè‡ªèº«çŠ¶æ€ï¼Œå¹¶æ ¹æ®ç”¨æˆ·è¾“å…¥è¿›è¡Œæ›´æ–°ã€‚ä½†åœ¨ React ä¸­ï¼Œå¯å˜çš„çŠ¶æ€é€šå¸¸ä¿å­˜åœ¨ç»„ä»¶çš„çŠ¶æ€å±æ€§ä¸­ï¼Œå¹¶ä¸”åªèƒ½ç”¨ <code>setState()</code> æ–¹æ³•è¿›è¡Œæ›´æ–°ã€‚æˆ‘ä»¬é€šè¿‡ä½¿ react å˜æˆä¸€ç§å•ä¸€æ•°æ®æºçš„çŠ¶æ€æ¥ç»“åˆäºŒè€…ã€‚<mark>React è´Ÿè´£æ¸²æŸ“è¡¨å•çš„ç»„ä»¶ä»ç„¶æ§åˆ¶ç”¨æˆ·åç»­è¾“å…¥æ—¶æ‰€å‘ç”Ÿçš„å˜åŒ–ã€‚ç›¸åº”çš„ï¼Œå…¶å€¼ç”± React æ§åˆ¶çš„è¾“å…¥è¡¨å•å…ƒç´ ç§°ä¸ºâ€œå—æ§ç»„ä»¶â€ã€‚</mark></p>
</li>
<li>
<p>å¤šä¸ªè¾“å…¥çš„è§£å†³æ–¹æ³•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JSX" data-lang="JSX"><span class="line"><span class="cl"><span class="c1">//å½“ä½ æœ‰å¤„ç†å¤šä¸ªå—æ§çš„inputå…ƒç´ æ—¶ï¼Œä½ å¯ä»¥é€šè¿‡ç»™æ¯ä¸ªå…ƒç´ æ·»åŠ ä¸€ä¸ªnameå±æ€§ï¼Œæ¥è®©å¤„ç†å‡½æ•°æ ¹æ® event.target.nameçš„å€¼æ¥é€‰æ‹©åšä»€ä¹ˆã€‚
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="nx">handleInputChange</span><span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">target</span> <span class="o">=</span> <span class="nx">event</span><span class="p">.</span><span class="nx">target</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">value</span> <span class="o">=</span> <span class="nx">target</span><span class="p">.</span><span class="nx">type</span> <span class="o">===</span> <span class="s1">&#39;checkbox&#39;</span> <span class="o">?</span> <span class="nx">target</span><span class="p">.</span><span class="nx">checked</span> <span class="o">:</span> <span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="kr">const</span> <span class="nx">name</span> <span class="o">=</span> <span class="nx">target</span><span class="p">.</span><span class="nx">name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">      <span class="p">[</span><span class="nx">name</span><span class="p">]</span><span class="o">:</span> <span class="nx">value</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="çŠ¶æ€æå‡" class="headerLink">
    <a href="#%e7%8a%b6%e6%80%81%e6%8f%90%e5%8d%87" class="header-mark"></a>çŠ¶æ€æå‡</h3><ul>
<li>åœ¨ React åº”ç”¨ä¸­ï¼Œå¯¹åº”ä»»ä½•å¯å˜æ•°æ®ç†åº”åªæœ‰ä¸€ä¸ªå•ä¸€â€œæ•°æ®æºâ€ã€‚é€šå¸¸ï¼ŒçŠ¶æ€éƒ½æ˜¯é¦–å…ˆæ·»åŠ åœ¨éœ€è¦æ¸²æŸ“æ•°æ®çš„ç»„ä»¶ä¸­ã€‚ç„¶åï¼Œå¦‚æœå¦ä¸€ä¸ªç»„ä»¶ä¹Ÿéœ€è¦è¿™äº›æ•°æ®ï¼Œä½ å¯ä»¥å°†æ•°æ®æå‡è‡³ç¦»å®ƒä»¬æœ€è¿‘çš„å…±åŒç¥–å…ˆä¸­ã€‚</li>
<li>å‘ä¸‹ä¼ é€’çˆ¶ç»„ä»¶çš„ State åŠå…¶æ›´æ–°æ–¹æ³•ã€‚</li>
<li>çŠ¶æ€æå‡è¦å†™æ›´å¤šçš„â€œç‚‰å¢™ä»£ç â€ï¼Œæ¯”èµ·åŒå‘ç»‘å®šæ–¹å¼ï¼Œä½†å¸¦æ¥çš„å¥½å¤„æ˜¯ï¼Œä½ ä¹Ÿå¯ä»¥èŠ±æ›´å°‘çš„å·¥ä½œé‡æ‰¾åˆ°å’Œéš”ç¦» bugã€‚å› ä¸ºä»»ä½•ç”Ÿæ´»åœ¨æŸäº›ç»„ä»¶ä¸­çš„çŠ¶æ€æ•°æ®ï¼Œä¹Ÿåªæœ‰è¯¥ç»„ä»¶å®ƒè‡ªå·±èƒ½å¤Ÿæ“ä½œè¿™äº›æ•°æ®ï¼Œå‘ç”Ÿ bug çš„è¡¨é¢ç§¯å°±è¢«å¤§å¤§åœ°å‡å°äº†ã€‚</li>
<li>å¦‚æœæŸäº›æ•°æ®å¯ä»¥ç”± props æˆ–è€… state æ¨å¯¼å‡ºæ¥ï¼Œé‚£ä¹ˆå®ƒå¾ˆæœ‰å¯èƒ½ä¸åº”è¯¥åœ¨ state ä¸­å‡ºç°ã€‚</li>
</ul>
<h3 id="ç»„åˆ-vs-ç»§æ‰¿" class="headerLink">
    <a href="#%e7%bb%84%e5%90%88-vs-%e7%bb%a7%e6%89%bf" class="header-mark"></a>ç»„åˆ vs ç»§æ‰¿</h3><p>React æœ‰ååˆ†å¼ºå¤§çš„ç»„åˆæ¨¡å¼ã€‚æˆ‘ä»¬æ¨èä½¿ç”¨ç»„åˆè€Œéç»§æ‰¿æ¥å®ç°ç»„ä»¶é—´çš„ä»£ç é‡ç”¨ã€‚</p>
<p>åœ¨è¿™ç¯‡æ–‡æ¡£ä¸­ï¼Œæˆ‘ä»¬å°†è€ƒè™‘åˆå­¦ React çš„å¼€å‘äººå‘˜ä½¿ç”¨ç»§æ‰¿æ—¶ç»å¸¸ä¼šé‡åˆ°çš„ä¸€äº›é—®é¢˜ï¼Œå¹¶å±•ç¤ºå¦‚ä½•é€šè¿‡ç»„åˆæ€æƒ³æ¥è§£å†³è¿™äº›é—®é¢˜ã€‚</p>
<h4 id="åŒ…å«å…³ç³»" class="headerLink">
    <a href="#%e5%8c%85%e5%90%ab%e5%85%b3%e7%b3%bb" class="header-mark"></a>åŒ…å«å…³ç³»</h4><p>æœ‰äº›ç»„ä»¶æ— æ³•æå‰çŸ¥æ™“å®ƒä»¬å­ç»„ä»¶çš„å…·ä½“å†…å®¹ã€‚åœ¨ <code>Sidebar</code>ï¼ˆä¾§è¾¹æ ï¼‰å’Œ <code>Dialog</code>ï¼ˆå¯¹è¯æ¡†ï¼‰ç­‰å±•ç°é€šç”¨å®¹å™¨ï¼ˆboxï¼‰çš„ç»„ä»¶ä¸­ç‰¹åˆ«å®¹æ˜“é‡åˆ°è¿™ç§æƒ…å†µã€‚</p>
<p>æˆ‘ä»¬å»ºè®®è¿™äº›ç»„ä»¶ä½¿ç”¨ä¸€ä¸ªç‰¹æ®Šçš„ <code>children</code> prop æ¥å°†ä»–ä»¬çš„å­ç»„ä»¶ä¼ é€’åˆ°æ¸²æŸ“ç»“æœä¸­ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JSX" data-lang="JSX"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">FancyBorder</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;FancyBorder FancyBorder-&#39;</span> <span class="o">+</span> <span class="nx">props</span><span class="p">.</span><span class="nx">color</span><span class="p">}&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span><span class="p">}</span>    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™ä½¿å¾—åˆ«çš„ç»„ä»¶å¯ä»¥é€šè¿‡ JSX åµŒå¥—ï¼Œå°†ä»»æ„ç»„ä»¶ä½œä¸ºå­ç»„ä»¶ä¼ é€’ç»™å®ƒä»¬ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JSX" data-lang="JSX"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">WelcomeDialog</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">FancyBorder</span> <span class="na">color</span><span class="o">=</span><span class="s">&#34;blue&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">h1</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;Dialog-title&#34;</span><span class="p">&gt;</span>        <span class="nx">Welcome</span>      <span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>      <span class="p">&lt;</span><span class="nt">p</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;Dialog-message&#34;</span><span class="p">&gt;</span>        <span class="nx">Thank</span> <span class="nx">you</span> <span class="k">for</span> <span class="nx">visiting</span> <span class="nx">our</span> <span class="nx">spacecraft</span><span class="o">!</span>      <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>    <span class="p">&lt;/</span><span class="nt">FancyBorder</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong><a href="https://codepen.io/gaearon/pen/ozqNOV?editors=0010" target="_blank" rel="noopener noreferrer">åœ¨ CodePen ä¸Šå°è¯•</a></strong></p>
<p><code>&lt;FancyBorder&gt;</code> JSX æ ‡ç­¾ä¸­çš„æ‰€æœ‰å†…å®¹éƒ½ä¼šä½œä¸ºä¸€ä¸ª <code>children</code> prop ä¼ é€’ç»™ <code>FancyBorder</code> ç»„ä»¶ã€‚å› ä¸º <code>FancyBorder</code> å°† <code>{props.children}</code> æ¸²æŸ“åœ¨ä¸€ä¸ª <code>&lt;div&gt;</code> ä¸­ï¼Œè¢«ä¼ é€’çš„è¿™äº›å­ç»„ä»¶æœ€ç»ˆéƒ½ä¼šå‡ºç°åœ¨è¾“å‡ºç»“æœä¸­ã€‚</p>
<p>å°‘æ•°æƒ…å†µä¸‹ï¼Œä½ å¯èƒ½éœ€è¦åœ¨ä¸€ä¸ªç»„ä»¶ä¸­é¢„ç•™å‡ºå‡ ä¸ªâ€œæ´â€ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ä½¿ç”¨ <code>children</code>ï¼Œè€Œæ˜¯è‡ªè¡Œçº¦å®šï¼šå°†æ‰€éœ€å†…å®¹ä¼ å…¥ propsï¼Œå¹¶ä½¿ç”¨ç›¸åº”çš„ propã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JSX" data-lang="JSX"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">SplitPane</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;SplitPane&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;SplitPane-left&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">left</span><span class="p">}</span>      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;SplitPane-right&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">right</span><span class="p">}</span>      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">App</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">SplitPane</span>
</span></span><span class="line"><span class="cl">      <span class="na">left</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">Contacts</span> <span class="p">/&gt;</span>      <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="na">right</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">Chat</span> <span class="p">/&gt;</span>      <span class="p">}</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><a href="https://codepen.io/gaearon/pen/gwZOJp?editors=0010" target="_blank" rel="noopener noreferrer"><strong>åœ¨ CodePen ä¸Šå°è¯•</strong></a></p>
<p><code>&lt;Contacts /&gt;</code> å’Œ <code>&lt;Chat /&gt;</code> ä¹‹ç±»çš„ React å…ƒç´ æœ¬è´¨å°±æ˜¯å¯¹è±¡ï¼ˆobjectï¼‰ï¼Œæ‰€ä»¥ä½ å¯ä»¥æŠŠå®ƒä»¬å½“ä½œ propsï¼Œåƒå…¶ä»–æ•°æ®ä¸€æ ·ä¼ é€’ã€‚è¿™ç§æ–¹æ³•å¯èƒ½ä½¿ä½ æƒ³èµ·åˆ«çš„åº“ä¸­â€œæ§½â€ï¼ˆslotï¼‰çš„æ¦‚å¿µï¼Œä½†åœ¨ React ä¸­æ²¡æœ‰â€œæ§½â€è¿™ä¸€æ¦‚å¿µçš„é™åˆ¶ï¼Œä½ å¯ä»¥å°†ä»»ä½•ä¸œè¥¿ä½œä¸º props è¿›è¡Œä¼ é€’ã€‚</p>
<h4 id="ç‰¹ä¾‹å…³ç³»" class="headerLink">
    <a href="#%e7%89%b9%e4%be%8b%e5%85%b3%e7%b3%bb" class="header-mark"></a>ç‰¹ä¾‹å…³ç³»</h4><p>æœ‰äº›æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šæŠŠä¸€äº›ç»„ä»¶çœ‹ä½œæ˜¯å…¶ä»–ç»„ä»¶çš„ç‰¹æ®Šå®ä¾‹ï¼Œæ¯”å¦‚ <code>WelcomeDialog</code> å¯ä»¥è¯´æ˜¯ <code>Dialog</code> çš„ç‰¹æ®Šå®ä¾‹ã€‚</p>
<p>åœ¨ React ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ç»„åˆæ¥å®ç°è¿™ä¸€ç‚¹ã€‚â€œç‰¹æ®Šâ€ç»„ä»¶å¯ä»¥é€šè¿‡ props å®šåˆ¶å¹¶æ¸²æŸ“â€œä¸€èˆ¬â€ç»„ä»¶ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JSX" data-lang="JSX"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">Dialog</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">FancyBorder</span> <span class="na">color</span><span class="o">=</span><span class="s">&#34;blue&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">h1</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;Dialog-title&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span>      <span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">p</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;Dialog-message&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">message</span><span class="p">}</span>      <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">FancyBorder</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">WelcomeDialog</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">Dialog</span>      <span class="na">title</span><span class="o">=</span><span class="s">&#34;Welcome&#34;</span>      <span class="na">message</span><span class="o">=</span><span class="s">&#34;Thank you for visiting our spacecraft!&#34;</span> <span class="p">/&gt;</span>  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><a href="https://codepen.io/gaearon/pen/kkEaOZ?editors=0010" target="_blank" rel="noopener noreferrer"><strong>åœ¨ CodePen ä¸Šå°è¯•</strong></a></p>
<p>ç»„åˆä¹ŸåŒæ ·é€‚ç”¨äºä»¥ class å½¢å¼å®šä¹‰çš„ç»„ä»¶ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JSX" data-lang="JSX"><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">Dialog</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">FancyBorder</span> <span class="na">color</span><span class="o">=</span><span class="s">&#34;blue&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">h1</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;Dialog-title&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">title</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">p</span> <span class="na">className</span><span class="o">=</span><span class="s">&#34;Dialog-message&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">message</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span><span class="nx">props</span><span class="p">.</span><span class="nx">children</span><span class="p">}</span>    <span class="p">&lt;/</span><span class="nt">FancyBorder</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">SignUpDialog</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">constructor</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="kr">super</span><span class="p">(</span><span class="nx">props</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">handleSignUp</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">handleSignUp</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">state</span> <span class="o">=</span> <span class="p">{</span><span class="nx">login</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">Dialog</span> <span class="na">title</span><span class="o">=</span><span class="s">&#34;Mars Exploration Program&#34;</span>
</span></span><span class="line"><span class="cl">              <span class="na">message</span><span class="o">=</span><span class="s">&#34;How should we refer to you?&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">input</span> <span class="na">value</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">login</span><span class="p">}</span>               <span class="na">onChange</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="p">}</span> <span class="p">/&gt;</span>        <span class="p">&lt;</span><span class="nt">button</span> <span class="na">onClick</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleSignUp</span><span class="p">}&gt;</span>          <span class="nx">Sign</span> <span class="nx">Me</span> <span class="nx">Up</span><span class="o">!</span>        <span class="p">&lt;/</span><span class="nt">button</span><span class="p">&gt;</span>      <span class="p">&lt;/</span><span class="nt">Dialog</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">handleChange</span><span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span><span class="nx">login</span><span class="o">:</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="nx">handleSignUp</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">alert</span><span class="p">(</span><span class="sb">`Welcome aboard, </span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">login</span><span class="si">}</span><span class="sb">!`</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><a href="https://codepen.io/gaearon/pen/gwZbYa?editors=0010" target="_blank" rel="noopener noreferrer"><strong>åœ¨ CodePen ä¸Šå°è¯•</strong></a></p>
<h4 id="é‚£ä¹ˆç»§æ‰¿å‘¢" class="headerLink">
    <a href="#%e9%82%a3%e4%b9%88%e7%bb%a7%e6%89%bf%e5%91%a2" class="header-mark"></a>é‚£ä¹ˆç»§æ‰¿å‘¢ï¼Ÿ</h4><p>åœ¨ Facebookï¼Œæˆ‘ä»¬åœ¨æˆç™¾ä¸Šåƒä¸ªç»„ä»¶ä¸­ä½¿ç”¨ Reactã€‚æˆ‘ä»¬å¹¶æ²¡æœ‰å‘ç°éœ€è¦ä½¿ç”¨ç»§æ‰¿æ¥æ„å»ºç»„ä»¶å±‚æ¬¡çš„æƒ…å†µã€‚</p>
<p>Props å’Œç»„åˆä¸ºä½ æä¾›äº†æ¸…æ™°è€Œå®‰å…¨åœ°å®šåˆ¶ç»„ä»¶å¤–è§‚å’Œè¡Œä¸ºçš„çµæ´»æ–¹å¼ã€‚æ³¨æ„ï¼šç»„ä»¶å¯ä»¥æ¥å—ä»»æ„ propsï¼ŒåŒ…æ‹¬åŸºæœ¬æ•°æ®ç±»å‹ï¼ŒReact å…ƒç´ ä»¥åŠå‡½æ•°ã€‚</p>
<p>å¦‚æœä½ æƒ³è¦åœ¨ç»„ä»¶é—´å¤ç”¨é UI çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬å»ºè®®å°†å…¶æå–ä¸ºä¸€ä¸ªå•ç‹¬çš„ JavaScript æ¨¡å—ï¼Œå¦‚å‡½æ•°ã€å¯¹è±¡æˆ–è€…ç±»ã€‚ç»„ä»¶å¯ä»¥ç›´æ¥å¼•å…¥ï¼ˆimportï¼‰è€Œæ— éœ€é€šè¿‡ extend ç»§æ‰¿å®ƒä»¬ã€‚</p>
<h3 id="react-å“²å­¦" class="headerLink">
    <a href="#react-%e5%93%b2%e5%ad%a6" class="header-mark"></a>React å“²å­¦</h3><p>æˆ‘ä»¬è®¤ä¸ºï¼ŒReact æ˜¯ç”¨ JavaScript æ„å»ºå¿«é€Ÿå“åº”çš„å¤§å‹ Web åº”ç”¨ç¨‹åºçš„é¦–é€‰æ–¹å¼ã€‚å®ƒåœ¨ Facebook å’Œ Instagram ä¸Šè¡¨ç°ä¼˜ç§€ã€‚</p>
<p>React æœ€æ£’çš„éƒ¨åˆ†ä¹‹ä¸€æ˜¯å¼•å¯¼æˆ‘ä»¬æ€è€ƒå¦‚ä½•æ„å»ºä¸€ä¸ªåº”ç”¨ã€‚åœ¨è¿™ç¯‡æ–‡æ¡£ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šé€šè¿‡ React æ„å»ºä¸€ä¸ªå¯æœç´¢çš„äº§å“æ•°æ®è¡¨æ ¼æ¥æ›´æ·±åˆ»åœ°é¢†ä¼š React å“²å­¦ã€‚</p>
<h4 id="ä»è®¾è®¡ç¨¿å¼€å§‹" class="headerLink">
    <a href="#%e4%bb%8e%e8%ae%be%e8%ae%a1%e7%a8%bf%e5%bc%80%e5%a7%8b" class="header-mark"></a>ä»è®¾è®¡ç¨¿å¼€å§‹</h4><p>å‡è®¾æˆ‘ä»¬å·²ç»æœ‰äº†ä¸€ä¸ªè¿”å› JSON çš„ APIï¼Œä»¥åŠè®¾è®¡å¸ˆæä¾›çš„ç»„ä»¶è®¾è®¡ç¨¿ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<p><figure><a class="lightgallery" href="https://zh-hans.reactjs.org/static/1071fbcc9eed01fddc115b41e193ec11/d4770/thinking-in-react-mock.png" title="Mockup" data-thumbnail="https://zh-hans.reactjs.org/static/1071fbcc9eed01fddc115b41e193ec11/d4770/thinking-in-react-mock.png">
        <img
            
            loading="lazy"
            src="https://zh-hans.reactjs.org/static/1071fbcc9eed01fddc115b41e193ec11/d4770/thinking-in-react-mock.png"
            srcset="https://zh-hans.reactjs.org/static/1071fbcc9eed01fddc115b41e193ec11/d4770/thinking-in-react-mock.png, https://zh-hans.reactjs.org/static/1071fbcc9eed01fddc115b41e193ec11/d4770/thinking-in-react-mock.png 1.5x, https://zh-hans.reactjs.org/static/1071fbcc9eed01fddc115b41e193ec11/d4770/thinking-in-react-mock.png 2x"
            alt="Mockup">
    </a></figure></p>
<p>è¯¥ JSON API ä¼šè¿”å›ä»¥ä¸‹æ•°æ®ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[
</span></span><span class="line"><span class="cl">  {category: &#34;Sporting Goods&#34;, price: &#34;$49.99&#34;, stocked: true, name: &#34;Football&#34;},
</span></span><span class="line"><span class="cl">  {category: &#34;Sporting Goods&#34;, price: &#34;$9.99&#34;, stocked: true, name: &#34;Baseball&#34;},
</span></span><span class="line"><span class="cl">  {category: &#34;Sporting Goods&#34;, price: &#34;$29.99&#34;, stocked: false, name: &#34;Basketball&#34;},
</span></span><span class="line"><span class="cl">  {category: &#34;Electronics&#34;, price: &#34;$99.99&#34;, stocked: true, name: &#34;iPod Touch&#34;},
</span></span><span class="line"><span class="cl">  {category: &#34;Electronics&#34;, price: &#34;$399.99&#34;, stocked: false, name: &#34;iPhone 5&#34;},
</span></span><span class="line"><span class="cl">  {category: &#34;Electronics&#34;, price: &#34;$199.99&#34;, stocked: true, name: &#34;Nexus 7&#34;}
</span></span><span class="line"><span class="cl">];
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="ç¬¬ä¸€æ­¥å°†è®¾è®¡å¥½çš„-ui-åˆ’åˆ†ä¸ºç»„ä»¶å±‚çº§" class="headerLink">
    <a href="#%e7%ac%ac%e4%b8%80%e6%ad%a5%e5%b0%86%e8%ae%be%e8%ae%a1%e5%a5%bd%e7%9a%84-ui-%e5%88%92%e5%88%86%e4%b8%ba%e7%bb%84%e4%bb%b6%e5%b1%82%e7%ba%a7" class="header-mark"></a>ç¬¬ä¸€æ­¥ï¼šå°†è®¾è®¡å¥½çš„ UI åˆ’åˆ†ä¸ºç»„ä»¶å±‚çº§</h4><p>é¦–å…ˆï¼Œä½ éœ€è¦åœ¨è®¾è®¡ç¨¿ä¸Šç”¨æ–¹æ¡†åœˆå‡ºæ¯ä¸€ä¸ªç»„ä»¶ï¼ˆåŒ…æ‹¬å®ƒä»¬çš„å­ç»„ä»¶ï¼‰ï¼Œå¹¶ä¸”ä»¥åˆé€‚çš„åç§°å‘½åã€‚å¦‚æœä½ æ˜¯å’Œè®¾è®¡å¸ˆä¸€èµ·å®Œæˆæ­¤ä»»åŠ¡ï¼Œé‚£ä¹ˆä»–ä»¬å¯èƒ½å·²ç»åšè¿‡ç±»ä¼¼çš„å·¥ä½œï¼Œæ‰€ä»¥è¯·å’Œä»–ä»¬è¿›è¡Œäº¤æµï¼ä»–ä»¬çš„ Photoshop çš„å›¾å±‚åç§°å¯èƒ½æœ€ç»ˆå°±æ˜¯ä½ ç¼–å†™çš„ React ç»„ä»¶çš„åç§°ï¼</p>
<p>ä½†ä½ å¦‚ä½•ç¡®å®šåº”è¯¥å°†å“ªäº›éƒ¨åˆ†åˆ’åˆ†åˆ°ä¸€ä¸ªç»„ä»¶ä¸­å‘¢ï¼Ÿä½ å¯ä»¥å°†ç»„ä»¶å½“ä½œä¸€ç§å‡½æ•°æˆ–è€…æ˜¯å¯¹è±¡æ¥è€ƒè™‘ï¼Œæ ¹æ®<a href="https://en.wikipedia.org/wiki/Single_responsibility_principle" target="_blank" rel="noopener noreferrer">å•ä¸€åŠŸèƒ½åŸåˆ™</a>æ¥åˆ¤å®šç»„ä»¶çš„èŒƒå›´ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€ä¸ªç»„ä»¶åŸåˆ™ä¸Šåªèƒ½è´Ÿè´£ä¸€ä¸ªåŠŸèƒ½ã€‚å¦‚æœå®ƒéœ€è¦è´Ÿè´£æ›´å¤šçš„åŠŸèƒ½ï¼Œè¿™æ—¶å€™å°±åº”è¯¥è€ƒè™‘å°†å®ƒæ‹†åˆ†æˆæ›´å°çš„ç»„ä»¶ã€‚</p>
<p>åœ¨å®è·µä¸­ï¼Œå› ä¸ºä½ ç»å¸¸æ˜¯åœ¨å‘ç”¨æˆ·å±•ç¤º JSON æ•°æ®æ¨¡å‹ï¼Œæ‰€ä»¥å¦‚æœä½ çš„æ¨¡å‹è®¾è®¡å¾—æ°å½“ï¼ŒUIï¼ˆæˆ–è€…è¯´ç»„ä»¶ç»“æ„ï¼‰ä¾¿ä¼šä¸æ•°æ®æ¨¡å‹ä¸€ä¸€å¯¹åº”ï¼Œè¿™æ˜¯å› ä¸º UI å’Œæ•°æ®æ¨¡å‹éƒ½ä¼šå€¾å‘äºéµå®ˆç›¸åŒçš„<em>ä¿¡æ¯ç»“æ„</em>ã€‚å°† UI åˆ†ç¦»ä¸ºç»„ä»¶ï¼Œå…¶ä¸­æ¯ä¸ªç»„ä»¶éœ€ä¸æ•°æ®æ¨¡å‹çš„æŸéƒ¨åˆ†åŒ¹é…ã€‚</p>
<p><figure><a class="lightgallery" href="https://zh-hans.reactjs.org/static/9381f09e609723a8bb6e4ba1a7713b46/90cbd/thinking-in-react-components.png" title="ç»„ä»¶åµŒå¥—å›¾ç¤º" data-thumbnail="https://zh-hans.reactjs.org/static/9381f09e609723a8bb6e4ba1a7713b46/90cbd/thinking-in-react-components.png">
        <img
            
            loading="lazy"
            src="https://zh-hans.reactjs.org/static/9381f09e609723a8bb6e4ba1a7713b46/90cbd/thinking-in-react-components.png"
            srcset="https://zh-hans.reactjs.org/static/9381f09e609723a8bb6e4ba1a7713b46/90cbd/thinking-in-react-components.png, https://zh-hans.reactjs.org/static/9381f09e609723a8bb6e4ba1a7713b46/90cbd/thinking-in-react-components.png 1.5x, https://zh-hans.reactjs.org/static/9381f09e609723a8bb6e4ba1a7713b46/90cbd/thinking-in-react-components.png 2x"
            alt="ç»„ä»¶åµŒå¥—å›¾ç¤º">
    </a></figure></p>
<p>ä½ ä¼šçœ‹åˆ°æˆ‘ä»¬çš„åº”ç”¨ä¸­åŒ…å«äº”ä¸ªç»„ä»¶ã€‚æˆ‘ä»¬å·²ç»å°†æ¯ä¸ªç»„ä»¶å±•ç¤ºçš„æ•°æ®æ ‡æ³¨ä¸ºäº†æ–œä½“ã€‚å›¾ç‰‡ä¸­çš„åºå·ä¸ä¸‹æ–¹åˆ—è¡¨ä¸­çš„åºå·å¯¹åº”ã€‚</p>
<ol>
<li><strong><code>FilterableProductTable</code> (æ©™è‰²):</strong> æ˜¯æ•´ä¸ªç¤ºä¾‹åº”ç”¨çš„æ•´ä½“</li>
<li><strong><code>SearchBar</code> (è“è‰²):</strong> æ¥å—æ‰€æœ‰çš„<em>ç”¨æˆ·è¾“å…¥</em></li>
<li><strong><code>ProductTable</code> (ç»¿è‰²):</strong> å±•ç¤º<em>æ•°æ®å†…å®¹</em>å¹¶æ ¹æ®<em>ç”¨æˆ·è¾“å…¥</em>ç­›é€‰ç»“æœ</li>
<li><strong><code>ProductCategoryRow</code> (å¤©è“è‰²):</strong> ä¸ºæ¯ä¸€ä¸ª<em>äº§å“ç±»åˆ«</em>å±•ç¤ºæ ‡é¢˜</li>
<li><strong><code>ProductRow</code> (çº¢è‰²):</strong> æ¯ä¸€è¡Œå±•ç¤ºä¸€ä¸ª<em>äº§å“</em></li>
</ol>
<p>ä½ å¯èƒ½æ³¨æ„åˆ°ï¼Œ<code>ProductTable</code> çš„è¡¨å¤´ï¼ˆåŒ…å« â€œNameâ€ å’Œ â€œPriceâ€ çš„é‚£ä¸€éƒ¨åˆ†ï¼‰å¹¶æœªå•ç‹¬æˆä¸ºä¸€ä¸ªç»„ä»¶ã€‚è¿™ä»…ä»…æ˜¯ä¸€ç§åå¥½é€‰æ‹©ï¼Œå¦‚ä½•å¤„ç†è¿™ä¸€é—®é¢˜ä¹Ÿä¸€ç›´å­˜åœ¨äº‰è®ºã€‚å°±è¿™ä¸ªç¤ºä¾‹è€Œè¨€ï¼Œå› ä¸ºè¡¨å¤´åªèµ·åˆ°äº†æ¸²æŸ“<em>æ•°æ®é›†åˆ</em>çš„ä½œç”¨â€”â€”è¿™ä¸ <code>ProductTable</code> æ˜¯ä¸€è‡´çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»ç„¶å°†å…¶ä¿ç•™ä¸º <code>ProductTable</code> çš„ä¸€éƒ¨åˆ†ã€‚ä½†æ˜¯ï¼Œå¦‚æœè¡¨å¤´è¿‡äºå¤æ‚ï¼ˆä¾‹å¦‚ï¼Œæˆ‘ä»¬éœ€ä¸ºå…¶æ·»åŠ æ’åºåŠŸèƒ½ï¼‰ï¼Œé‚£ä¹ˆå°†å®ƒä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„ <code>ProductTableHeader</code> ç»„ä»¶å°±æ˜¾å¾—å¾ˆæœ‰å¿…è¦äº†ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»ç¡®å®šäº†è®¾è®¡ç¨¿ä¸­åº”è¯¥åŒ…å«çš„ç»„ä»¶ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†æŠŠå®ƒä»¬æè¿°ä¸ºæ›´åŠ æ¸…æ™°çš„å±‚çº§ã€‚è®¾è®¡ç¨¿ä¸­è¢«å…¶ä»–ç»„ä»¶åŒ…å«çš„å­ç»„ä»¶ï¼Œåœ¨å±‚çº§ä¸Šåº”è¯¥ä½œä¸ºå…¶å­èŠ‚ç‚¹ã€‚</p>
<ul>
<li><code>FilterableProductTable</code>
<ul>
<li><code>SearchBar</code></li>
<li><code>ProductTable</code>
<ul>
<li><code>ProductCategoryRow</code></li>
<li><code>ProductRow</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h4 id="ç¬¬äºŒæ­¥ç”¨-react-åˆ›å»ºä¸€ä¸ªé™æ€ç‰ˆæœ¬" class="headerLink">
    <a href="#%e7%ac%ac%e4%ba%8c%e6%ad%a5%e7%94%a8-react-%e5%88%9b%e5%bb%ba%e4%b8%80%e4%b8%aa%e9%9d%99%e6%80%81%e7%89%88%e6%9c%ac" class="header-mark"></a>ç¬¬äºŒæ­¥ï¼šç”¨ React åˆ›å»ºä¸€ä¸ªé™æ€ç‰ˆæœ¬</h4><p>å‚é˜… <a href="https://codepen.io/" target="_blank" rel="noopener noreferrer">CodePen</a> ä¸Šçš„ <a href="https://codepen.io/gaearon/pen/BwWzwm" target="_blank" rel="noopener noreferrer">React å“²å­¦ï¼šç¬¬äºŒæ­¥</a>ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»ç¡®å®šäº†ç»„ä»¶å±‚çº§ï¼Œå¯ä»¥ç¼–å†™å¯¹åº”çš„åº”ç”¨äº†ã€‚æœ€å®¹æ˜“çš„æ–¹å¼ï¼Œæ˜¯å…ˆç”¨å·²æœ‰çš„æ•°æ®æ¨¡å‹æ¸²æŸ“ä¸€ä¸ªä¸åŒ…å«äº¤äº’åŠŸèƒ½çš„ UIã€‚æœ€å¥½å°†æ¸²æŸ“ UI å’Œæ·»åŠ äº¤äº’è¿™ä¸¤ä¸ªè¿‡ç¨‹åˆ†å¼€ã€‚è¿™æ˜¯å› ä¸ºï¼Œç¼–å†™ä¸€ä¸ªåº”ç”¨çš„é™æ€ç‰ˆæœ¬æ—¶ï¼Œå¾€å¾€è¦ç¼–å†™å¤§é‡ä»£ç ï¼Œè€Œä¸éœ€è¦è€ƒè™‘å¤ªå¤šäº¤äº’ç»†èŠ‚ï¼›æ·»åŠ äº¤äº’åŠŸèƒ½æ—¶åˆ™è¦è€ƒè™‘å¤§é‡ç»†èŠ‚ï¼Œè€Œä¸éœ€è¦ç¼–å†™å¤ªå¤šä»£ç ã€‚æ‰€ä»¥ï¼Œå°†è¿™ä¸¤ä¸ªè¿‡ç¨‹åˆ†å¼€è¿›è¡Œæ›´ä¸ºåˆé€‚ã€‚æˆ‘ä»¬ä¼šåœ¨æ¥ä¸‹æ¥çš„ä»£ç ä¸­ä½“ä¼šåˆ°å…¶ä¸­çš„åŒºåˆ«ã€‚</p>
<p>åœ¨æ„å»ºåº”ç”¨çš„é™æ€ç‰ˆæœ¬æ—¶ï¼Œæˆ‘ä»¬éœ€è¦åˆ›å»ºä¸€äº›ä¼šé‡ç”¨å…¶ä»–ç»„ä»¶çš„ç»„ä»¶ï¼Œç„¶åé€šè¿‡ <em>props</em> ä¼ å…¥æ‰€éœ€çš„æ•°æ®ã€‚<em>props</em> æ˜¯çˆ¶ç»„ä»¶å‘å­ç»„ä»¶ä¼ é€’æ•°æ®çš„æ–¹å¼ã€‚å³ä½¿ä½ å·²ç»ç†Ÿæ‚‰äº† <em>state</em> çš„æ¦‚å¿µï¼Œä¹Ÿ<strong>å®Œå…¨ä¸åº”è¯¥ä½¿ç”¨ state</strong> æ„å»ºé™æ€ç‰ˆæœ¬ã€‚state ä»£è¡¨äº†éšæ—¶é—´ä¼šäº§ç”Ÿå˜åŒ–çš„æ•°æ®ï¼Œåº”å½“ä»…åœ¨å®ç°äº¤äº’æ—¶ä½¿ç”¨ã€‚æ‰€ä»¥æ„å»ºåº”ç”¨çš„é™æ€ç‰ˆæœ¬æ—¶ï¼Œä½ ä¸ä¼šç”¨åˆ°å®ƒã€‚</p>
<p>ä½ å¯ä»¥è‡ªä¸Šè€Œä¸‹æˆ–è€…è‡ªä¸‹è€Œä¸Šæ„å»ºåº”ç”¨ï¼šè‡ªä¸Šè€Œä¸‹æ„å‘³ç€é¦–å…ˆç¼–å†™å±‚çº§è¾ƒé«˜çš„ç»„ä»¶ï¼ˆæ¯”å¦‚ <code>FilterableProductTable</code>ï¼‰ï¼Œè‡ªä¸‹è€Œä¸Šæ„å‘³ç€ä»æœ€åŸºæœ¬çš„ç»„ä»¶å¼€å§‹ç¼–å†™ï¼ˆæ¯”å¦‚ <code>ProductRow</code>ï¼‰ã€‚å½“ä½ çš„åº”ç”¨æ¯”è¾ƒç®€å•æ—¶ï¼Œä½¿ç”¨è‡ªä¸Šè€Œä¸‹çš„æ–¹å¼æ›´æ–¹ä¾¿ï¼›å¯¹äºè¾ƒä¸ºå¤§å‹çš„é¡¹ç›®æ¥è¯´ï¼Œè‡ªä¸‹è€Œä¸Šåœ°æ„å»ºï¼Œå¹¶åŒæ—¶ä¸ºä½å±‚ç»„ä»¶ç¼–å†™æµ‹è¯•æ˜¯æ›´åŠ ç®€å•çš„æ–¹å¼ã€‚</p>
<p>åˆ°æ­¤ä¸ºæ­¢ï¼Œä½ åº”è¯¥å·²ç»æœ‰äº†ä¸€ä¸ªå¯é‡ç”¨çš„ç»„ä»¶åº“æ¥æ¸²æŸ“ä½ çš„æ•°æ®æ¨¡å‹ã€‚ç”±äºæˆ‘ä»¬æ„å»ºçš„æ˜¯é™æ€ç‰ˆæœ¬ï¼Œæ‰€ä»¥è¿™äº›ç»„ä»¶ç›®å‰åªéœ€æä¾› <code>render()</code> æ–¹æ³•ç”¨äºæ¸²æŸ“ã€‚æœ€é¡¶å±‚çš„ç»„ä»¶ <code>FilterableProductTable</code> é€šè¿‡ props æ¥å—ä½ çš„æ•°æ®æ¨¡å‹ã€‚å¦‚æœä½ çš„æ•°æ®æ¨¡å‹å‘ç”Ÿäº†æ”¹å˜ï¼Œå†æ¬¡è°ƒç”¨ <code>root.render()</code>ï¼ŒUI å°±ä¼šç›¸åº”åœ°è¢«æ›´æ–°ã€‚æ•°æ®æ¨¡å‹å˜åŒ–ã€è°ƒç”¨ <code>render()</code> æ–¹æ³•ã€UI ç›¸åº”å˜åŒ–ï¼Œè¿™ä¸ªè¿‡ç¨‹å¹¶ä¸å¤æ‚ï¼Œå› æ­¤å¾ˆå®¹æ˜“çœ‹æ¸…æ¥š UI æ˜¯å¦‚ä½•è¢«æ›´æ–°çš„ï¼Œä»¥åŠæ˜¯åœ¨å“ªé‡Œè¢«æ›´æ–°çš„ã€‚React <strong>å•å‘æ•°æ®æµ</strong>ï¼ˆä¹Ÿå«<em>å•å‘ç»‘å®š</em>ï¼‰çš„æ€æƒ³ä½¿å¾—ç»„ä»¶æ¨¡å—åŒ–ï¼Œæ˜“äºå¿«é€Ÿå¼€å‘ã€‚</p>
<p>å¦‚æœä½ åœ¨å®Œæˆè¿™ä¸€æ­¥éª¤æ—¶é‡åˆ°äº†å›°éš¾ï¼Œå¯ä»¥å‚é˜… <a href="https://zh-hans.reactjs.org/docs/getting-started.html" target="_blank" rel="noopener noreferrer">React æ–‡æ¡£</a>ã€‚</p>
<h5 id="è¡¥å……è¯´æ˜-æœ‰å…³-props-å’Œ-state" class="headerLink">
    <a href="#%e8%a1%a5%e5%85%85%e8%af%b4%e6%98%8e-%e6%9c%89%e5%85%b3-props-%e5%92%8c-state" class="header-mark"></a>è¡¥å……è¯´æ˜: æœ‰å…³ props å’Œ state</h5><p>åœ¨ React ä¸­ï¼Œæœ‰ä¸¤ç±»â€œæ¨¡å‹â€æ•°æ®ï¼šprops å’Œ stateã€‚æ¸…æ¥šåœ°ç†è§£ä¸¤è€…çš„åŒºåˆ«æ˜¯ååˆ†é‡è¦çš„ï¼›å¦‚æœä½ ä¸å¤ªæœ‰æŠŠæ¡ï¼Œå¯ä»¥å‚é˜… <a href="https://zh-hans.reactjs.org/docs/state-and-lifecycle.html" target="_blank" rel="noopener noreferrer">React å®˜æ–¹æ–‡æ¡£</a>ã€‚ä½ ä¹Ÿå¯ä»¥æŸ¥çœ‹ <a href="https://zh-hans.reactjs.org/docs/faq-state.html#what-is-the-difference-between-state-and-props" target="_blank" rel="noopener noreferrer">FAQ: state ä¸ props çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</a></p>
<h4 id="ç¬¬ä¸‰æ­¥ç¡®å®š-ui-state-çš„æœ€å°ä¸”å®Œæ•´è¡¨ç¤º" class="headerLink">
    <a href="#%e7%ac%ac%e4%b8%89%e6%ad%a5%e7%a1%ae%e5%ae%9a-ui-state-%e7%9a%84%e6%9c%80%e5%b0%8f%e4%b8%94%e5%ae%8c%e6%95%b4%e8%a1%a8%e7%a4%ba" class="header-mark"></a>ç¬¬ä¸‰æ­¥ï¼šç¡®å®š UI state çš„æœ€å°ï¼ˆä¸”å®Œæ•´ï¼‰è¡¨ç¤º</h4><p>æƒ³è¦ä½¿ä½ çš„ UI å…·å¤‡äº¤äº’åŠŸèƒ½ï¼Œéœ€è¦æœ‰è§¦å‘åŸºç¡€æ•°æ®æ¨¡å‹æ”¹å˜çš„èƒ½åŠ›ã€‚React é€šè¿‡å®ç° <strong>state</strong> æ¥å®Œæˆè¿™ä¸ªä»»åŠ¡ã€‚</p>
<p>ä¸ºäº†æ­£ç¡®åœ°æ„å»ºåº”ç”¨ï¼Œä½ é¦–å…ˆéœ€è¦æ‰¾å‡ºåº”ç”¨æ‰€éœ€çš„ state çš„æœ€å°è¡¨ç¤ºï¼Œå¹¶æ ¹æ®éœ€è¦è®¡ç®—å‡ºå…¶ä»–æ‰€æœ‰æ•°æ®ã€‚å…¶ä¸­çš„å…³é”®æ­£æ˜¯ <a href="https://en.wikipedia.org/wiki/Don%27t_repeat_yourself" target="_blank" rel="noopener noreferrer">DRY: <em>Donâ€™t Repeat Yourself</em></a>ã€‚åªä¿ç•™åº”ç”¨æ‰€éœ€çš„å¯å˜ state çš„æœ€å°é›†åˆï¼Œå…¶ä»–æ•°æ®å‡ç”±å®ƒä»¬è®¡ç®—äº§ç”Ÿã€‚æ¯”å¦‚ï¼Œä½ è¦ç¼–å†™ä¸€ä¸ªä»»åŠ¡æ¸…å•åº”ç”¨ï¼Œä½ åªéœ€è¦ä¿å­˜ä¸€ä¸ªåŒ…å«æ‰€æœ‰äº‹é¡¹çš„æ•°ç»„ï¼Œè€Œæ— éœ€é¢å¤–ä¿å­˜ä¸€ä¸ªå•ç‹¬çš„ state å˜é‡ï¼ˆç”¨äºå­˜å‚¨ä»»åŠ¡ä¸ªæ•°ï¼‰ã€‚å½“ä½ éœ€è¦å±•ç¤ºä»»åŠ¡ä¸ªæ•°æ—¶ï¼Œåªéœ€è¦åˆ©ç”¨è¯¥æ•°ç»„çš„ length å±æ€§å³å¯ã€‚</p>
<p>æˆ‘ä»¬çš„ç¤ºä¾‹åº”ç”¨æ‹¥æœ‰å¦‚ä¸‹æ•°æ®ï¼š</p>
<ul>
<li>åŒ…å«æ‰€æœ‰äº§å“çš„åŸå§‹åˆ—è¡¨</li>
<li>ç”¨æˆ·è¾“å…¥çš„æœç´¢è¯</li>
<li>å¤é€‰æ¡†æ˜¯å¦é€‰ä¸­çš„å€¼</li>
<li>ç»è¿‡æœç´¢ç­›é€‰çš„äº§å“åˆ—è¡¨</li>
</ul>
<p>é€šè¿‡é—®è‡ªå·±ä»¥ä¸‹ä¸‰ä¸ªé—®é¢˜ï¼Œä½ å¯ä»¥é€ä¸ªæ£€æŸ¥ç›¸åº”æ•°æ®æ˜¯å¦å±äº stateï¼š</p>
<ol>
<li>è¯¥æ•°æ®æ˜¯å¦æ˜¯ç”±çˆ¶ç»„ä»¶é€šè¿‡ props ä¼ é€’è€Œæ¥çš„ï¼Ÿå¦‚æœæ˜¯ï¼Œé‚£å®ƒåº”è¯¥ä¸æ˜¯ stateã€‚</li>
<li>è¯¥æ•°æ®æ˜¯å¦éšæ—¶é—´çš„æ¨ç§»è€Œä¿æŒä¸å˜ï¼Ÿå¦‚æœæ˜¯ï¼Œé‚£å®ƒåº”è¯¥ä¹Ÿä¸æ˜¯ stateã€‚</li>
<li>ä½ èƒ½å¦æ ¹æ®å…¶ä»– state æˆ– props è®¡ç®—å‡ºè¯¥æ•°æ®çš„å€¼ï¼Ÿå¦‚æœæ˜¯ï¼Œé‚£å®ƒä¹Ÿä¸æ˜¯ stateã€‚</li>
</ol>
<p>åŒ…å«æ‰€æœ‰äº§å“çš„åŸå§‹åˆ—è¡¨æ˜¯ç»ç”± props ä¼ å…¥çš„ï¼Œæ‰€ä»¥å®ƒä¸æ˜¯ stateï¼›æœç´¢è¯å’Œå¤é€‰æ¡†çš„å€¼åº”è¯¥æ˜¯ stateï¼Œå› ä¸ºå®ƒä»¬éšæ—¶é—´ä¼šå‘ç”Ÿæ”¹å˜ä¸”æ— æ³•ç”±å…¶ä»–æ•°æ®è®¡ç®—è€Œæ¥ï¼›ç»è¿‡æœç´¢ç­›é€‰çš„äº§å“åˆ—è¡¨ä¸æ˜¯ stateï¼Œå› ä¸ºå®ƒçš„ç»“æœå¯ä»¥ç”±äº§å“çš„åŸå§‹åˆ—è¡¨æ ¹æ®æœç´¢è¯å’Œå¤é€‰æ¡†çš„é€‰æ‹©è®¡ç®—å‡ºæ¥ã€‚</p>
<p>ç»¼ä¸Šæ‰€è¿°ï¼Œå±äº state çš„æœ‰ï¼š</p>
<ul>
<li>ç”¨æˆ·è¾“å…¥çš„æœç´¢è¯</li>
<li>å¤é€‰æ¡†æ˜¯å¦é€‰ä¸­çš„å€¼</li>
</ul>
<h4 id="ç¬¬å››æ­¥ç¡®å®š-state-æ”¾ç½®çš„ä½ç½®" class="headerLink">
    <a href="#%e7%ac%ac%e5%9b%9b%e6%ad%a5%e7%a1%ae%e5%ae%9a-state-%e6%94%be%e7%bd%ae%e7%9a%84%e4%bd%8d%e7%bd%ae" class="header-mark"></a>ç¬¬å››æ­¥ï¼šç¡®å®š state æ”¾ç½®çš„ä½ç½®</h4><p>å‚é˜… <a href="https://codepen.io/" target="_blank" rel="noopener noreferrer">CodePen</a> ä¸Šçš„ <a href="https://codepen.io/gaearon/pen/qPrNQZ" target="_blank" rel="noopener noreferrer">React å“²å­¦ï¼šç¬¬å››æ­¥</a>ã€‚</p>
<p>æˆ‘ä»¬å·²ç»ç¡®å®šäº†åº”ç”¨æ‰€éœ€çš„ state çš„æœ€å°é›†åˆã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬éœ€è¦ç¡®å®šå“ªä¸ªç»„ä»¶èƒ½å¤Ÿæ”¹å˜è¿™äº› stateï¼Œæˆ–è€…è¯´<em>æ‹¥æœ‰</em>è¿™äº› stateã€‚</p>
<p>æ³¨æ„ï¼šReact ä¸­çš„æ•°æ®æµæ˜¯å•å‘çš„ï¼Œå¹¶é¡ºç€ç»„ä»¶å±‚çº§ä»ä¸Šå¾€ä¸‹ä¼ é€’ã€‚å“ªä¸ªç»„ä»¶åº”è¯¥æ‹¥æœ‰æŸä¸ª state è¿™ä»¶äº‹ï¼Œ<strong>å¯¹åˆå­¦è€…æ¥è¯´å¾€å¾€æ˜¯æœ€éš¾ç†è§£çš„éƒ¨åˆ†</strong>ã€‚å°½ç®¡è¿™å¯èƒ½åœ¨ä¸€å¼€å§‹ä¸æ˜¯é‚£ä¹ˆæ¸…æ™°ï¼Œä½†ä½ å¯ä»¥å°è¯•é€šè¿‡ä»¥ä¸‹æ­¥éª¤æ¥åˆ¤æ–­ï¼š</p>
<p>å¯¹äºåº”ç”¨ä¸­çš„æ¯ä¸€ä¸ª stateï¼š</p>
<ul>
<li>æ‰¾åˆ°æ ¹æ®è¿™ä¸ª state è¿›è¡Œæ¸²æŸ“çš„æ‰€æœ‰ç»„ä»¶ã€‚</li>
<li>æ‰¾åˆ°ä»–ä»¬çš„å…±åŒæ‰€æœ‰è€…ï¼ˆcommon ownerï¼‰ç»„ä»¶ï¼ˆåœ¨ç»„ä»¶å±‚çº§ä¸Šé«˜äºæ‰€æœ‰éœ€è¦è¯¥ state çš„ç»„ä»¶ï¼‰ã€‚</li>
<li>è¯¥å…±åŒæ‰€æœ‰è€…ç»„ä»¶æˆ–è€…æ¯”å®ƒå±‚çº§æ›´é«˜çš„ç»„ä»¶åº”è¯¥æ‹¥æœ‰è¯¥ stateã€‚</li>
<li>å¦‚æœä½ æ‰¾ä¸åˆ°ä¸€ä¸ªåˆé€‚çš„ä½ç½®æ¥å­˜æ”¾è¯¥ stateï¼Œå°±å¯ä»¥ç›´æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ç»„ä»¶æ¥å­˜æ”¾è¯¥ stateï¼Œå¹¶å°†è¿™ä¸€æ–°ç»„ä»¶ç½®äºé«˜äºå…±åŒæ‰€æœ‰è€…ç»„ä»¶å±‚çº§çš„ä½ç½®ã€‚</li>
</ul>
<p>æ ¹æ®ä»¥ä¸Šç­–ç•¥é‡æ–°è€ƒè™‘æˆ‘ä»¬çš„ç¤ºä¾‹åº”ç”¨ï¼š</p>
<ul>
<li><code>ProductTable</code> éœ€è¦æ ¹æ® state ç­›é€‰äº§å“åˆ—è¡¨ã€‚<code>SearchBar</code> éœ€è¦å±•ç¤ºæœç´¢è¯å’Œå¤é€‰æ¡†çš„çŠ¶æ€ã€‚</li>
<li>ä»–ä»¬çš„å…±åŒæ‰€æœ‰è€…æ˜¯ <code>FilterableProductTable</code>ã€‚</li>
<li>å› æ­¤ï¼Œæœç´¢è¯å’Œå¤é€‰æ¡†çš„å€¼åº”è¯¥å¾ˆè‡ªç„¶åœ°å­˜æ”¾åœ¨ <code>FilterableProductTable</code> ç»„ä»¶ä¸­ã€‚</li>
</ul>
<p>å¾ˆå¥½ï¼Œæˆ‘ä»¬å·²ç»å†³å®šæŠŠè¿™äº› state å­˜æ”¾åœ¨ <code>FilterableProductTable</code> ç»„ä»¶ä¸­ã€‚é¦–å…ˆï¼Œå°†å®ä¾‹å±æ€§ <code>this.state = {filterText: '', inStockOnly: false}</code> æ·»åŠ åˆ° <code>FilterableProductTable</code> çš„ <code>constructor</code> ä¸­ï¼Œè®¾ç½®åº”ç”¨çš„åˆå§‹ stateï¼›æ¥ç€ï¼Œå°† <code>filterText</code> å’Œ <code>inStockOnly</code> ä½œä¸º props ä¼ å…¥ <code>ProductTable</code> å’Œ <code>SearchBar</code>ï¼›æœ€åï¼Œç”¨è¿™äº› props ç­›é€‰ <code>ProductTable</code> ä¸­çš„äº§å“ä¿¡æ¯ï¼Œå¹¶è®¾ç½® <code>SearchBar</code> çš„è¡¨å•å€¼ã€‚</p>
<p>ä½ ç°åœ¨å¯ä»¥çœ‹åˆ°åº”ç”¨çš„å˜åŒ–äº†ï¼šå°† <code>filterText</code> è®¾ç½®ä¸º <code>&quot;ball&quot;</code> å¹¶åˆ·æ–°åº”ç”¨ï¼Œä½ èƒ½å‘ç°è¡¨æ ¼ä¸­çš„æ•°æ®å·²ç»æ›´æ–°äº†ã€‚</p>
<h4 id="ç¬¬äº”æ­¥æ·»åŠ åå‘æ•°æ®æµ" class="headerLink">
    <a href="#%e7%ac%ac%e4%ba%94%e6%ad%a5%e6%b7%bb%e5%8a%a0%e5%8f%8d%e5%90%91%e6%95%b0%e6%8d%ae%e6%b5%81" class="header-mark"></a>ç¬¬äº”æ­¥ï¼šæ·»åŠ åå‘æ•°æ®æµ</h4><p>å‚é˜… <a href="https://codepen.io/" target="_blank" rel="noopener noreferrer">CodePen</a> ä¸Šçš„ <a href="https://codepen.io/gaearon/pen/LzWZvb" target="_blank" rel="noopener noreferrer">React å“²å­¦ï¼šç¬¬äº”æ­¥</a>ã€‚</p>
<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»å€ŸåŠ©è‡ªä¸Šè€Œä¸‹ä¼ é€’çš„ props å’Œ state æ¸²æŸ“äº†ä¸€ä¸ªåº”ç”¨ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬å°†å°è¯•è®©æ•°æ®åå‘ä¼ é€’ï¼šå¤„äºè¾ƒä½å±‚çº§çš„è¡¨å•ç»„ä»¶æ›´æ–°è¾ƒé«˜å±‚çº§çš„ <code>FilterableProductTable</code> ä¸­çš„ stateã€‚</p>
<p>React é€šè¿‡ä¸€ç§æ¯”ä¼ ç»Ÿçš„åŒå‘ç»‘å®šç•¥å¾®ç¹ççš„æ–¹æ³•æ¥å®ç°åå‘æ•°æ®ä¼ é€’ã€‚å°½ç®¡å¦‚æ­¤ï¼Œä½†è¿™ç§éœ€è¦æ˜¾å¼å£°æ˜çš„æ–¹æ³•æ›´æœ‰åŠ©äºäººä»¬ç†è§£ç¨‹åºçš„è¿ä½œæ–¹å¼ã€‚</p>
<p>å¦‚æœä½ å°è¯•åœ¨ä¸Šä¸€ä¸ªç¤ºä¾‹çš„æœç´¢æ¡†ä¸­è¾“å…¥æˆ–å‹¾é€‰å¤é€‰æ¡†ï¼ˆæ­¥éª¤ 4ï¼‰ï¼ŒReact ä¸ä¼šäº§ç”Ÿä»»ä½•å“åº”ã€‚è¿™æ˜¯æ­£å¸¸çš„ï¼Œå› ä¸ºæˆ‘ä»¬ä¹‹å‰å·²ç»å°† <code>input</code> çš„å€¼è®¾ç½®ä¸ºäº†ä» <code>FilterableProductTable</code> çš„ <code>state</code> ä¼ é€’è€Œæ¥çš„å›ºå®šå€¼ã€‚</p>
<p>è®©æˆ‘ä»¬é‡æ–°æ¢³ç†ä¸€ä¸‹éœ€è¦å®ç°çš„åŠŸèƒ½ï¼šæ¯å½“ç”¨æˆ·æ”¹å˜è¡¨å•çš„å€¼ï¼Œæˆ‘ä»¬éœ€è¦æ”¹å˜ state æ¥åæ˜ ç”¨æˆ·çš„å½“å‰è¾“å…¥ã€‚ç”±äº state åªèƒ½ç”±æ‹¥æœ‰å®ƒä»¬çš„ç»„ä»¶è¿›è¡Œæ›´æ”¹ï¼Œ<code>FilterableProductTable</code> å¿…é¡»å°†ä¸€ä¸ªèƒ½å¤Ÿè§¦å‘ state æ”¹å˜çš„å›è°ƒå‡½æ•°ï¼ˆcallbackï¼‰ä¼ é€’ç»™ <code>SearchBar</code>ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¾“å…¥æ¡†çš„ <code>onChange</code> äº‹ä»¶æ¥ç›‘è§†ç”¨æˆ·è¾“å…¥çš„å˜åŒ–ï¼Œå¹¶é€šçŸ¥ <code>FilterableProductTable</code> ä¼ é€’ç»™ <code>SearchBar</code> çš„å›è°ƒå‡½æ•°ã€‚ç„¶åè¯¥å›è°ƒå‡½æ•°å°†è°ƒç”¨ <code>setState()</code>ï¼Œä»è€Œæ›´æ–°åº”ç”¨ã€‚</p>
<h2 id="æ‰©å±•" class="headerLink">
    <a href="#%e6%89%a9%e5%b1%95" class="header-mark"></a>æ‰©å±•</h2><h3 id="ç†è§£-virtual-dom" class="headerLink">
    <a href="#%e7%90%86%e8%a7%a3-virtual-dom" class="header-mark"></a>ç†è§£ Virtual DOM</h3><ul>
<li>è™šæ‹Ÿ DOM å¦‚ä½•å·¥ä½œ(DIFF ç®—æ³•)
<ul>
<li>å¹¿åº¦ä¼˜å…ˆåˆ†å±‚æ¯”è¾ƒï¼Œé’ˆå¯¹ UI å¾ˆå°‘å‘ç”Ÿè·¨å±‚ç§»åŠ¨</li>
<li>å…„å¼Ÿé—´ä½ç½®ç§»åŠ¨ä¼šæ ¹æ® key äº¤æ¢ä½ç½®</li>
<li>DOM è·¨å±‚ç§»åŠ¨ React ä¸ä¼šåšæ£€æŸ¥ï¼Œå°±æ˜¯ç®€å•çš„åˆ é™¤ç„¶åæ·»åŠ </li>
</ul>
</li>
<li>è™šæ‹Ÿ DOM çš„ä¸¤ä¸ªå‡è®¾
<ul>
<li>ç»„ä»¶çš„ DOM ç»“æ„æ˜¯ç›¸å¯¹ç¨³å®šçš„</li>
<li>ç±»å‹ç›¸åŒçš„å…„å¼ŸèŠ‚ç‚¹å¯ä»¥è¢«å”¯ä¸€æ ‡è¯†</li>
</ul>
</li>
</ul>
<h3 id="ç»„ä»¶è®¾è®¡æ¨¡å¼" class="headerLink">
    <a href="#%e7%bb%84%e4%bb%b6%e8%ae%be%e8%ae%a1%e6%a8%a1%e5%bc%8f" class="header-mark"></a>ç»„ä»¶è®¾è®¡æ¨¡å¼</h3><h4 id="é«˜é˜¶ç»„ä»¶" class="headerLink">
    <a href="#%e9%ab%98%e9%98%b6%e7%bb%84%e4%bb%b6" class="header-mark"></a>é«˜é˜¶ç»„ä»¶</h4><ul>
<li>
<p>é«˜é˜¶ç»„ä»¶æ¥æ”¶ç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œå®šä¹‰é€šç”¨é€»è¾‘ã€çŠ¶æ€ï¼Œrender æ–¹æ³•ä¸­å°†å®šä¹‰çš„çŠ¶æ€å’Œé€»è¾‘ä½œä¸º props ä¼ ç»™æ¥æ”¶çš„ç»„ä»¶å¹¶ç›´æ¥è¿”å›ã€‚</p>
</li>
<li>
<p>é«˜é˜¶ç»„ä»¶ç±»ä¼¼äºå·²å®ç°çš„åŠŸèƒ½æ¥å£ï¼Œå­ç»„ä»¶å¼•å…¥é«˜é˜¶ç»„ä»¶<code>import é«˜é˜¶ç»„ä»¶å‡½æ•°å form &quot;ç»„ä»¶è·¯å¾„&quot;</code>ï¼Œåœ¨å†…éƒ¨ä½¿ç”¨é«˜é˜¶ç»„ä»¶å°†ä¼šä¼ é€’çš„ propsï¼Œç„¶åå¯¼å‡ºé€šè¿‡é«˜é˜¶ç»„ä»¶å°è£…çš„ç»„ä»¶ç»™å¤–éƒ¨ä½¿ç”¨<code>export default é«˜é˜¶ç»„ä»¶å‡½æ•°å(ç»„ä»¶)</code></p>
</li>
<li>
<p>ä¸è¦æ”¹å˜åŸå§‹ç»„ä»¶ï¼Œé«˜é˜¶ç»„ä»¶åº”è¯¥ä½¿ç”¨ç»„åˆæŠ€æœ¯ï¼Œå°†è¾“å…¥ç»„ä»¶åŒ…è£¹åˆ°ä¸€ä¸ªå®¹å™¨ç»„ä»¶ã€‚</p>
</li>
<li>
<p>çº¦å®šï¼šè´¯ç©¿ä¼ é€’ä¸ç›¸å…³ props å±æ€§ç»™è¢«åŒ…è£¹çš„ç»„ä»¶</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JSX" data-lang="JSX"><span class="line"><span class="cl"><span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// è¿‡æ»¤æ‰ä¸“ç”¨äºè¿™ä¸ªé˜¶ç»„ä»¶çš„propså±æ€§ï¼Œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// ä¸åº”è¯¥è¢«è´¯ç©¿ä¼ é€’
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">const</span> <span class="p">{</span> <span class="nx">extraProp</span><span class="p">,</span> <span class="p">...</span><span class="nx">passThroughProps</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// å‘è¢«åŒ…è£¹çš„ç»„ä»¶æ³¨å…¥propså±æ€§ï¼Œè¿™äº›ä¸€èˆ¬éƒ½æ˜¯çŠ¶æ€å€¼æˆ–
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="c1">// å®ä¾‹æ–¹æ³•
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kr">const</span> <span class="nx">injectedProp</span> <span class="o">=</span> <span class="nx">someStateOrInstanceMethod</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="c1">// å‘è¢«åŒ…è£¹çš„ç»„ä»¶ä¼ é€’propså±æ€§
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">WrappedComponent</span>
</span></span><span class="line"><span class="cl">      <span class="na">injectedProp</span><span class="o">=</span><span class="p">{</span><span class="nx">injectedProp</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span><span class="na">...passThroughProps</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>çº¦å®šï¼šåŒ…è£…æ˜¾ç¤ºåå­—ä»¥ä¾¿äºè°ƒè¯•</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JSX" data-lang="JSX"><span class="line"><span class="cl"><span class="c1">//æœ€å¸¸ç”¨çš„æŠ€æœ¯æ˜¯åŒ…è£¹æ˜¾ç¤ºåå­—ç»™è¢«åŒ…è£¹çš„ç»„ä»¶ã€‚æ‰€ä»¥ï¼Œå¦‚æœä½ çš„é«˜é˜¶ç»„ä»¶åå­—æ˜¯ withSubscriptionï¼Œ
</span></span></span><span class="line"><span class="cl"><span class="c1">//ä¸”è¢«åŒ…è£¹çš„ç»„ä»¶çš„æ˜¾ç¤ºåå­—æ˜¯ CommentListï¼Œé‚£ä¹ˆå°±æ˜¯ç”¨ WithSubscription(CommentList)è¿™æ ·çš„æ˜¾ç¤ºåå­—
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">withSubscription</span><span class="p">(</span><span class="nx">WrappedComponent</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="kr">class</span> <span class="nx">WithSubscription</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/* ... */</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="nx">WithSubscription</span><span class="p">.</span><span class="nx">displayName</span> <span class="o">=</span> <span class="sb">`WithSubscription(</span><span class="si">${</span><span class="nx">getDisplayName</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="nx">WrappedComponent</span>
</span></span><span class="line"><span class="cl">  <span class="p">)</span><span class="si">}</span><span class="sb">)`</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">WithSubscription</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">getDisplayName</span><span class="p">(</span><span class="nx">WrappedComponent</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="nx">WrappedComponent</span><span class="p">.</span><span class="nx">displayName</span> <span class="o">||</span> <span class="nx">WrappedComponent</span><span class="p">.</span><span class="nx">name</span> <span class="o">||</span> <span class="s2">&#34;Component&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>å‘Šè¯«ï¼šä¸è¦åœ¨ render æ–¹æ³•å†…ä½¿ç”¨é«˜é˜¶ç»„ä»¶</p>
</li>
<li>
<p>å‘Šè¯«ï¼šå¿…é¡»å°†é™æ€æ–¹æ³•åšæ‹·è´ã€‚å½“ä½ åº”ç”¨ä¸€ä¸ªé«˜é˜¶ç»„ä»¶åˆ°ä¸€ä¸ªç»„ä»¶æ—¶ï¼ŒåŸå§‹ç»„ä»¶è¢«åŒ…è£¹äºä¸€ä¸ªå®¹å™¨ç»„ä»¶å†…ï¼Œä¹Ÿå°±æ„å‘³ç€æ–°ç»„ä»¶ä¼šæ²¡æœ‰åŸå§‹ç»„ä»¶çš„ä»»ä½•é™æ€æ–¹æ³•ã€‚</p>
</li>
<li>
<p>å‘Šè¯«ï¼šRefs å±æ€§ä¸èƒ½è´¯ç©¿ä¼ é€’</p>
</li>
<li>
<p>å…¸å‹åœºæ™¯ï¼šé€šç”¨é€»è¾‘å¤ç”¨</p>
</li>
</ul>
<iframe
  class="website-card-embed"
  data-src="https://website-card-embed.dramacat.top/?url=https%3a%2f%2freact.docschina.org%2fdocs%2fhigher-order-components.html"
  style="width: 100%; height: 124px"
  frameborder="no"
></iframe>
<h4 id="æ¡†æ¶å¤–åŒ…è£…ç»„ä»¶" class="headerLink">
    <a href="#%e6%a1%86%e6%9e%b6%e5%a4%96%e5%8c%85%e8%a3%85%e7%bb%84%e4%bb%b6" class="header-mark"></a>æ¡†æ¶(å¤–åŒ…è£…)ç»„ä»¶</h4><ul>
<li>æ¡†æ¶ç»„ä»¶æ¥æ”¶ props.children ä½œä¸ºå¯å˜çš„ UI æ˜¾ç¤ºã€‚å®šä¹‰é€šç”¨ UIï¼Œå˜åŒ–éƒ¨åˆ†ä½¿ç”¨ props.childrenï¼Œä½¿ç”¨è€…å†³å®šè¿™éƒ¨åˆ†å¦‚ä½•å±•ç¤ºã€‚</li>
<li>å…¸å‹åœºæ™¯ï¼šé€šç”¨ UI å¤ç”¨</li>
</ul>
<h3 id="context" class="headerLink">
    <a href="#context" class="header-mark"></a>Context</h3><ul>
<li>
<p>Context é€šè¿‡ç»„ä»¶æ ‘æä¾›äº†ä¸€ä¸ªä¼ é€’æ•°æ®çš„æ–¹æ³•ï¼Œä»è€Œé¿å…äº†åœ¨æ¯ä¸€ä¸ªå±‚çº§æ‰‹åŠ¨çš„ä¼ é€’ props å±æ€§ã€‚</p>
</li>
<li>
<p>ä¸è¦ä»…ä»…ä¸ºäº†é¿å…åœ¨å‡ ä¸ªå±‚çº§ä¸‹çš„ç»„ä»¶ä¼ é€’ props è€Œä½¿ç”¨ contextï¼Œå®ƒæ˜¯è¢«ç”¨äºåœ¨å¤šä¸ªå±‚çº§çš„å¤šä¸ªç»„ä»¶éœ€è¦è®¿é—®ç›¸åŒæ•°æ®çš„æƒ…æ™¯ã€‚</p>
</li>
<li>
<p>å®ä¾‹</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JSX" data-lang="JSX"><span class="line"><span class="cl"><span class="c1">// åˆ›å»ºä¸€ä¸ª theme Context,  é»˜è®¤ theme çš„å€¼ä¸º light
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">const</span> <span class="nx">ThemeContext</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createContext</span><span class="p">(</span><span class="s2">&#34;light&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">function</span> <span class="nx">ThemedButton</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// ThemedButton ç»„ä»¶ä» context æ¥æ”¶ theme
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">ThemeContext.Consumer</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span><span class="nx">theme</span> <span class="p">=&gt;</span> <span class="p">&lt;</span><span class="nt">Button</span> <span class="p">{</span><span class="na">...props</span><span class="p">}</span> <span class="na">theme</span><span class="o">=</span><span class="p">{</span><span class="nx">theme</span><span class="p">}</span> <span class="p">/&gt;}</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">ThemeContext.Consumer</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// ä¸­é—´ç»„ä»¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">function</span> <span class="nx">Toolbar</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">ThemedButton</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">ThemeContext.Provider</span> <span class="na">value</span><span class="o">=</span><span class="s">&#34;dark&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">Toolbar</span> <span class="p">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;/</span><span class="nt">ThemeContext.Provider</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>å¯ä»¥ä½¿ç”¨é«˜é˜¶ç»„ä»¶çš„è®¾è®¡æ¨¡å¼å¾ˆå®¹æ˜“çš„å°è£… Context</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JSX" data-lang="JSX"><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">ThemeContext</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createContext</span><span class="p">(</span><span class="s2">&#34;light&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">// åœ¨å‡½æ•°ä¸­å¼•å…¥ç»„ä»¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kr">export</span> <span class="kd">function</span> <span class="nx">withTheme</span><span class="p">(</span><span class="nx">Component</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// ç„¶åè¿”å›å¦ä¸€ä¸ªç»„ä»¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">return</span> <span class="kd">function</span> <span class="nx">ThemedComponent</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// æœ€åä½¿ç”¨context themeæ¸²æŸ“è¿™ä¸ªè¢«å°è£…ç»„ä»¶
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">// æ³¨æ„æˆ‘ä»¬ç…§å¸¸å¼•ç”¨äº†è¢«æ·»åŠ çš„å±æ€§
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">ThemeContext.Consumer</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="nx">theme</span> <span class="p">=&gt;</span> <span class="p">&lt;</span><span class="nt">Component</span> <span class="p">{</span><span class="na">...props</span><span class="p">}</span> <span class="na">theme</span><span class="o">=</span><span class="p">{</span><span class="nx">theme</span><span class="p">}</span> <span class="p">/&gt;}</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;/</span><span class="nt">ThemeContext.Consumer</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
<li>
<p>React ä»¥å‰ä½¿ç”¨å®éªŒæ€§çš„ context API è¿è¡Œï¼Œæ—§çš„ API å°†ä¼šåœ¨ 16.x ç‰ˆæœ¬ä¸­å¾—åˆ°æ”¯æŒï¼Œä½†ä½¿ç”¨åˆ°å®ƒçš„åº”ç”¨åº”è¯¥è¿ç§»åˆ°æ–°ç‰ˆæœ¬ã€‚é—ç•™çš„ API å°†åœ¨æœªæ¥çš„ React ç‰ˆæœ¬ä¸­è¢«ç§»é™¤ã€‚</p>
</li>
</ul>
<iframe
  class="website-card-embed"
  data-src="https://website-card-embed.dramacat.top/?url=https%3a%2f%2freact.docschina.org%2fdocs%2fcontext.html"
  style="width: 100%; height: 124px"
  frameborder="no"
></iframe>
<h3 id="è„šæ‰‹æ¶å·¥å…·" class="headerLink">
    <a href="#%e8%84%9a%e6%89%8b%e6%9e%b6%e5%b7%a5%e5%85%b7" class="header-mark"></a>è„šæ‰‹æ¶å·¥å…·</h3><p><a href="https://github.com/facebook/create-react-app" target="_blank" rel="noopener noreferrer">Create React App</a> æ˜¯ Facebook çš„ä¸€ä¸ªæœ€ç®€ä¾èµ–çš„è„šæ‰‹æ¶å·¥å…·ï¼Œé€‚åˆå­¦ä¹  React æˆ–è€…å¼€å‘ç®€å•åº”ç”¨ã€‚</p>
<p><a href="http://rekit.js.org/" target="_blank" rel="noopener noreferrer">Rekit</a> åŸºäº Create React App å¤šæ•´åˆäº†å¾ˆå¤šå¿…è¦çš„åº“ï¼ŒåŒæ—¶æä¾›æ‹†åˆ†å¤§å‹é¡¹ç›®è€¦åˆåº¦çš„æ¶æ„ã€‚</p>
<p><a href="https://codesandbox.io" target="_blank" rel="noopener noreferrer">Codesandbox</a> åœ¨çº¿ IDE + è„šæ‰‹æ¶ï¼Œä¸å…³æ³¨é¡¹ç›®ç»†èŠ‚ï¼Œæ‰“åŒ…éƒ¨ç½²è¿‡ç¨‹éšè—ã€‚</p>
<iframe
  class="website-card-embed"
  data-src="https://website-card-embed.dramacat.top/?url=http%3a%2f%2frekit.js.org%2f"
  style="width: 100%; height: 124px"
  frameborder="no"
></iframe>
<h3 id="ç”Ÿæ€åœˆ" class="headerLink">
    <a href="#%e7%94%9f%e6%80%81%e5%9c%88" class="header-mark"></a>ç”Ÿæ€åœˆ</h3><h4 id="redux" class="headerLink">
    <a href="#redux" class="header-mark"></a>Redux</h4><p><a href="https://redux.js.org" target="_blank" rel="noopener noreferrer">Redux</a> æ˜¯ React å…¨å®¶æ¡¶çš„ä¸€å‘˜ï¼ŒRedux æ˜¯ JavaScript çŠ¶æ€å®¹å™¨ï¼Œæä¾›å¯é¢„æµ‹åŒ–çš„çŠ¶æ€ç®¡ç†ã€‚</p>
<p><iframe
  class="website-card-embed"
  data-src="https://website-card-embed.dramacat.top/?url=https%3a%2f%2fredux.js.org%2fusage%2findex"
  style="width: 100%; height: 124px"
  frameborder="no"
></iframe>
<iframe
  class="website-card-embed"
  data-src="https://website-card-embed.dramacat.top/?url=https%3a%2f%2fblog.dramacat.top%2fredux%2f"
  style="width: 100%; height: 124px"
  frameborder="no"
></iframe></p>
<h4 id="react-router" class="headerLink">
    <a href="#react-router" class="header-mark"></a>React Router</h4><p>React Router æ˜¯å®Œæ•´çš„ React è·¯ç”±è§£å†³æ–¹æ¡ˆã€‚React Router ä¿æŒ UI ä¸ URL åŒæ­¥ã€‚å®ƒæ‹¥æœ‰ç®€å•çš„ API ä¸å¼ºå¤§çš„åŠŸèƒ½ä¾‹å¦‚ä»£ç ç¼“å†²åŠ è½½ã€åŠ¨æ€è·¯ç”±åŒ¹é…ã€ä»¥åŠå»ºç«‹æ­£ç¡®çš„ä½ç½®è¿‡æ¸¡å¤„ç†ã€‚</p>
<iframe
  class="website-card-embed"
  data-src="https://website-card-embed.dramacat.top/?url=https%3a%2f%2fblog.dramacat.top%2freact-router%2f"
  style="width: 100%; height: 124px"
  frameborder="no"
></iframe>
<h4 id="webpack" class="headerLink">
    <a href="#webpack" class="header-mark"></a>webpack</h4><p>å‰ç«¯æ‰“åŒ…å·¥å…·</p>
<h4 id="react-loadable" class="headerLink">
    <a href="#react-loadable" class="header-mark"></a>react-loadable</h4><p>å’Œ webpack ç»“åˆå®ç°æŒ‰éœ€åŠ è½½ï¼Œæé«˜ APP ç¬¬ä¸€æ¬¡è®¿é—®é€Ÿåº¦</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JSX" data-lang="JSX"><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">Loadable</span> <span class="nx">from</span> <span class="s1">&#39;react-loadable&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">Loading</span> <span class="nx">from</span> <span class="s1">&#39;./my-loading-component&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">const</span> <span class="nx">LoadableComponent</span> <span class="o">=</span> <span class="nx">Loadable</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">  <span class="nx">loader</span><span class="o">:</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="kr">import</span><span class="p">(</span><span class="s1">&#39;./my-component&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">  <span class="nx">loading</span><span class="o">:</span> <span class="nx">Loading</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="k">default</span> <span class="kr">class</span> <span class="nx">App</span> <span class="kr">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">&lt;</span><span class="nt">LoadableComponent</span><span class="p">/&gt;;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="hook" class="headerLink">
    <a href="#hook" class="header-mark"></a>Hook</h3><h4 id="hook-æ¦‚è§ˆ" class="headerLink">
    <a href="#hook-%e6%a6%82%e8%a7%88" class="header-mark"></a>Hook æ¦‚è§ˆ</h4><p><em>Hook</em> æ˜¯ React 16.8 çš„æ–°å¢ç‰¹æ€§ã€‚å®ƒå¯ä»¥è®©ä½ åœ¨ä¸ç¼–å†™ class çš„æƒ…å†µä¸‹ä½¿ç”¨ state ä»¥åŠå…¶ä»–çš„ React ç‰¹æ€§ã€‚</p>
<p>Hook æ˜¯<a href="https://zh-hans.reactjs.org/docs/hooks-intro.html#no-breaking-changes" target="_blank" rel="noopener noreferrer">å‘ä¸‹å…¼å®¹çš„</a>ã€‚æœ¬é¡µé¢ä¸ºæœ‰ç»éªŒçš„ React ç”¨æˆ·æä¾›ä¸€ä¸ªå¯¹ Hook çš„æ¦‚è§ˆã€‚è¿™æ˜¯ä¸€ä¸ªç›¸å½“å¿«é€Ÿçš„æ¦‚è§ˆï¼Œå¦‚æœä½ æœ‰ç–‘æƒ‘ï¼Œå¯ä»¥å‚é˜…ä¸‹é¢è¿™æ ·çš„é»„è‰²æç¤ºæ¡†ã€‚</p>
<blockquote>
<p>è¯¦ç»†è¯´æ˜</p>
<p>æœ‰å…³æˆ‘ä»¬ä¸ºä»€ä¹ˆè¦åœ¨ React ä¸­å¼•å…¥ Hook çš„åŸå› ï¼Œè¯·å‚è€ƒ<a href="https://zh-hans.reactjs.org/docs/hooks-intro.html#motivation" target="_blank" rel="noopener noreferrer">åŠ¨æœº</a>ã€‚</p>
</blockquote>
<p><strong>â†‘â†‘â†‘ æ¯ä¸ªéƒ¨åˆ†çš„ç»“å°¾éƒ½ä¼šæœ‰ä¸€ä¸ªå¦‚ä¸Šæ‰€ç¤ºçš„é»„è‰²æ–¹æ¡†ã€‚</strong> å®ƒä»¬ä¼šé“¾æ¥åˆ°æ›´è¯¦ç»†çš„è¯´æ˜ã€‚</p>
<h5 id="-state-hook" class="headerLink">
    <a href="#-state-hook" class="header-mark"></a>ğŸ“Œ State Hook</h5><p>è¿™ä¸ªä¾‹å­ç”¨æ¥æ˜¾ç¤ºä¸€ä¸ªè®¡æ•°å™¨ã€‚å½“ä½ ç‚¹å‡»æŒ‰é’®ï¼Œè®¡æ•°å™¨çš„å€¼å°±ä¼šå¢åŠ ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">import</span> <span class="n">React</span><span class="p">,</span> <span class="p">{</span> <span class="n">useState</span> <span class="p">}</span> <span class="n">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">Example</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="err">å£°æ˜ä¸€ä¸ªå«</span> <span class="err">â€œ</span><span class="n">count</span><span class="err">â€</span> <span class="err">çš„</span> <span class="n">state</span> <span class="err">å˜é‡ã€‚</span>  <span class="k">const</span> <span class="p">[</span><span class="n">count</span><span class="p">,</span> <span class="n">setCount</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">You</span> <span class="n">clicked</span> <span class="p">{</span><span class="n">count</span><span class="p">}</span> <span class="n">times</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">button</span> <span class="n">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="n">setCount</span><span class="p">(</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)}</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="n">Click</span> <span class="n">me</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;/</span><span class="n">button</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨è¿™é‡Œï¼Œ<code>useState</code> å°±æ˜¯ä¸€ä¸ª <em>Hook</em> ï¼ˆç­‰ä¸‹æˆ‘ä»¬ä¼šè®²åˆ°è¿™æ˜¯ä»€ä¹ˆæ„æ€ï¼‰ã€‚é€šè¿‡åœ¨å‡½æ•°ç»„ä»¶é‡Œè°ƒç”¨å®ƒæ¥ç»™ç»„ä»¶æ·»åŠ ä¸€äº›å†…éƒ¨ stateã€‚React ä¼šåœ¨é‡å¤æ¸²æŸ“æ—¶ä¿ç•™è¿™ä¸ª stateã€‚<code>useState</code> ä¼šè¿”å›ä¸€å¯¹å€¼ï¼š<strong>å½“å‰</strong>çŠ¶æ€å’Œä¸€ä¸ªè®©ä½ æ›´æ–°å®ƒçš„å‡½æ•°ï¼Œä½ å¯ä»¥åœ¨äº‹ä»¶å¤„ç†å‡½æ•°ä¸­æˆ–å…¶ä»–ä¸€äº›åœ°æ–¹è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚å®ƒç±»ä¼¼ class ç»„ä»¶çš„ <code>this.setState</code>ï¼Œä½†æ˜¯å®ƒä¸ä¼šæŠŠæ–°çš„ state å’Œæ—§çš„ state è¿›è¡Œåˆå¹¶ã€‚ï¼ˆæˆ‘ä»¬ä¼šåœ¨<a href="https://zh-hans.reactjs.org/docs/hooks-state.html" target="_blank" rel="noopener noreferrer">ä½¿ç”¨ State Hook</a> é‡Œå±•ç¤ºä¸€ä¸ªå¯¹æ¯” <code>useState</code> å’Œ <code>this.state</code> çš„ä¾‹å­ï¼‰ã€‚</p>
<p><code>useState</code> å”¯ä¸€çš„å‚æ•°å°±æ˜¯åˆå§‹ stateã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬çš„è®¡æ•°å™¨æ˜¯ä»é›¶å¼€å§‹çš„ï¼Œæ‰€ä»¥åˆå§‹ state å°±æ˜¯ <code>0</code>ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œä¸åŒäº <code>this.state</code>ï¼Œè¿™é‡Œçš„ state ä¸ä¸€å®šè¦æ˜¯ä¸€ä¸ªå¯¹è±¡ â€”â€” å¦‚æœä½ æœ‰éœ€è¦ï¼Œå®ƒä¹Ÿå¯ä»¥æ˜¯ã€‚è¿™ä¸ªåˆå§‹ state å‚æ•°åªæœ‰åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶ä¼šè¢«ç”¨åˆ°ã€‚</p>
<p>####### å£°æ˜å¤šä¸ª state å˜é‡</p>
<p>ä½ å¯ä»¥åœ¨ä¸€ä¸ªç»„ä»¶ä¸­å¤šæ¬¡ä½¿ç”¨ State Hook:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">ExampleWithManyStates</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="err">å£°æ˜å¤šä¸ª</span> <span class="n">state</span> <span class="err">å˜é‡ï¼</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">age</span><span class="p">,</span> <span class="n">setAge</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">fruit</span><span class="p">,</span> <span class="n">setFruit</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="s1">&#39;banana&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">todos</span><span class="p">,</span> <span class="n">setTodos</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">([{</span> <span class="n">text</span><span class="p">:</span> <span class="s1">&#39;Learn Hooks&#39;</span> <span class="p">}]);</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment#Array_destructuring" target="_blank" rel="noopener noreferrer">æ•°ç»„è§£æ„</a>çš„è¯­æ³•è®©æˆ‘ä»¬åœ¨è°ƒç”¨ <code>useState</code> æ—¶å¯ä»¥ç»™ state å˜é‡å–ä¸åŒçš„åå­—ã€‚å½“ç„¶ï¼Œè¿™äº›åå­—å¹¶ä¸æ˜¯ <code>useState</code> API çš„ä¸€éƒ¨åˆ†ã€‚React å‡è®¾å½“ä½ å¤šæ¬¡è°ƒç”¨ <code>useState</code> çš„æ—¶å€™ï¼Œä½ èƒ½ä¿è¯æ¯æ¬¡æ¸²æŸ“æ—¶å®ƒä»¬çš„è°ƒç”¨é¡ºåºæ˜¯ä¸å˜çš„ã€‚åé¢æˆ‘ä»¬ä¼šå†æ¬¡è§£é‡Šå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ä»¥åŠåœ¨ä»€ä¹ˆåœºæ™¯ä¸‹ä½¿ç”¨ã€‚</p>
<p>####### é‚£ä¹ˆï¼Œä»€ä¹ˆæ˜¯ Hook?</p>
<p>Hook æ˜¯ä¸€äº›å¯ä»¥è®©ä½ åœ¨å‡½æ•°ç»„ä»¶é‡Œâ€œé’©å…¥â€ React state åŠç”Ÿå‘½å‘¨æœŸç­‰ç‰¹æ€§çš„å‡½æ•°ã€‚Hook ä¸èƒ½åœ¨ class ç»„ä»¶ä¸­ä½¿ç”¨ â€”â€” è¿™ä½¿å¾—ä½ ä¸ä½¿ç”¨ class ä¹Ÿèƒ½ä½¿ç”¨ Reactã€‚ï¼ˆæˆ‘ä»¬<a href="https://zh-hans.reactjs.org/docs/hooks-intro.html#gradual-adoption-strategy" target="_blank" rel="noopener noreferrer">ä¸æ¨è</a>æŠŠä½ å·²æœ‰çš„ç»„ä»¶å…¨éƒ¨é‡å†™ï¼Œä½†æ˜¯ä½ å¯ä»¥åœ¨æ–°ç»„ä»¶é‡Œå¼€å§‹ä½¿ç”¨ Hookã€‚ï¼‰</p>
<p>React å†…ç½®äº†ä¸€äº›åƒ <code>useState</code> è¿™æ ·çš„ Hookã€‚ä½ ä¹Ÿå¯ä»¥åˆ›å»ºä½ è‡ªå·±çš„ Hook æ¥å¤ç”¨ä¸åŒç»„ä»¶ä¹‹é—´çš„çŠ¶æ€é€»è¾‘ã€‚æˆ‘ä»¬ä¼šå…ˆä»‹ç»è¿™äº›å†…ç½®çš„ Hookã€‚</p>
<blockquote>
<p>è¯¦ç»†è¯´æ˜</p>
<p>ä½ å¯ä»¥åœ¨è¿™ä¸€ç« èŠ‚äº†è§£æ›´å¤šå…³äº State Hook çš„å†…å®¹ï¼š<a href="https://zh-hans.reactjs.org/docs/hooks-state.html" target="_blank" rel="noopener noreferrer">ä½¿ç”¨ State Hook</a>ã€‚</p>
</blockquote>
<h5 id="-effect-hook" class="headerLink">
    <a href="#-effect-hook" class="header-mark"></a>âš¡ï¸ Effect Hook</h5><p>ä½ ä¹‹å‰å¯èƒ½å·²ç»åœ¨ React ç»„ä»¶ä¸­æ‰§è¡Œè¿‡æ•°æ®è·å–ã€è®¢é˜…æˆ–è€…æ‰‹åŠ¨ä¿®æ”¹è¿‡ DOMã€‚æˆ‘ä»¬ç»Ÿä¸€æŠŠè¿™äº›æ“ä½œç§°ä¸ºâ€œå‰¯ä½œç”¨â€ï¼Œæˆ–è€…ç®€ç§°ä¸ºâ€œä½œç”¨â€ã€‚</p>
<p><code>useEffect</code> å°±æ˜¯ä¸€ä¸ª Effect Hookï¼Œç»™å‡½æ•°ç»„ä»¶å¢åŠ äº†æ“ä½œå‰¯ä½œç”¨çš„èƒ½åŠ›ã€‚å®ƒè·Ÿ class ç»„ä»¶ä¸­çš„ <code>componentDidMount</code>ã€<code>componentDidUpdate</code> å’Œ <code>componentWillUnmount</code> å…·æœ‰ç›¸åŒçš„ç”¨é€”ï¼Œåªä¸è¿‡è¢«åˆå¹¶æˆäº†ä¸€ä¸ª APIã€‚ï¼ˆæˆ‘ä»¬ä¼šåœ¨<a href="https://zh-hans.reactjs.org/docs/hooks-effect.html" target="_blank" rel="noopener noreferrer">ä½¿ç”¨ Effect Hook</a> é‡Œå±•ç¤ºå¯¹æ¯” <code>useEffect</code> å’Œè¿™äº›æ–¹æ³•çš„ä¾‹å­ã€‚ï¼‰</p>
<p>ä¾‹å¦‚ï¼Œä¸‹é¢è¿™ä¸ªç»„ä»¶åœ¨ React æ›´æ–° DOM åä¼šè®¾ç½®ä¸€ä¸ªé¡µé¢æ ‡é¢˜ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">import</span> <span class="n">React</span><span class="p">,</span> <span class="p">{</span> <span class="n">useState</span><span class="p">,</span> <span class="n">useEffect</span> <span class="p">}</span> <span class="n">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">Example</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">count</span><span class="p">,</span> <span class="n">setCount</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="err">ç›¸å½“äº</span> <span class="n">componentDidMount</span> <span class="err">å’Œ</span> <span class="n">componentDidUpdate</span><span class="p">:</span>  <span class="n">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>    <span class="o">//</span> <span class="err">ä½¿ç”¨æµè§ˆå™¨çš„</span> <span class="n">API</span> <span class="err">æ›´æ–°é¡µé¢æ ‡é¢˜</span>    <span class="n">document</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="err">`</span><span class="n">You</span> <span class="n">clicked</span> <span class="o">$</span><span class="p">{</span><span class="n">count</span><span class="p">}</span> <span class="n">times</span><span class="err">`</span><span class="p">;</span>  <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">You</span> <span class="n">clicked</span> <span class="p">{</span><span class="n">count</span><span class="p">}</span> <span class="n">times</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">button</span> <span class="n">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="n">setCount</span><span class="p">(</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)}</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="n">Click</span> <span class="n">me</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;/</span><span class="n">button</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å½“ä½ è°ƒç”¨ <code>useEffect</code> æ—¶ï¼Œå°±æ˜¯åœ¨å‘Šè¯‰ React åœ¨å®Œæˆå¯¹ DOM çš„æ›´æ”¹åè¿è¡Œä½ çš„â€œå‰¯ä½œç”¨â€å‡½æ•°ã€‚ç”±äºå‰¯ä½œç”¨å‡½æ•°æ˜¯åœ¨ç»„ä»¶å†…å£°æ˜çš„ï¼Œæ‰€ä»¥å®ƒä»¬å¯ä»¥è®¿é—®åˆ°ç»„ä»¶çš„ props å’Œ stateã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒReact ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“åè°ƒç”¨å‰¯ä½œç”¨å‡½æ•° â€”â€” <strong>åŒ…æ‹¬</strong>ç¬¬ä¸€æ¬¡æ¸²æŸ“çš„æ—¶å€™ã€‚ï¼ˆæˆ‘ä»¬ä¼šåœ¨<a href="https://zh-hans.reactjs.org/docs/hooks-effect.html" target="_blank" rel="noopener noreferrer">ä½¿ç”¨ Effect Hook</a> ä¸­è·Ÿ class ç»„ä»¶çš„ç”Ÿå‘½å‘¨æœŸæ–¹æ³•åšæ›´è¯¦ç»†çš„å¯¹æ¯”ã€‚ï¼‰</p>
<p>å‰¯ä½œç”¨å‡½æ•°è¿˜å¯ä»¥é€šè¿‡è¿”å›ä¸€ä¸ªå‡½æ•°æ¥æŒ‡å®šå¦‚ä½•â€œæ¸…é™¤â€å‰¯ä½œç”¨ã€‚ä¾‹å¦‚ï¼Œåœ¨ä¸‹é¢çš„ç»„ä»¶ä¸­ä½¿ç”¨å‰¯ä½œç”¨å‡½æ•°æ¥è®¢é˜…å¥½å‹çš„åœ¨çº¿çŠ¶æ€ï¼Œå¹¶é€šè¿‡å–æ¶ˆè®¢é˜…æ¥è¿›è¡Œæ¸…é™¤æ“ä½œï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">import</span> <span class="n">React</span><span class="p">,</span> <span class="p">{</span> <span class="n">useState</span><span class="p">,</span> <span class="n">useEffect</span> <span class="p">}</span> <span class="n">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">FriendStatus</span><span class="p">(</span><span class="n">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">isOnline</span><span class="p">,</span> <span class="n">setIsOnline</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="n">null</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">function</span> <span class="n">handleStatusChange</span><span class="p">(</span><span class="n">status</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">setIsOnline</span><span class="p">(</span><span class="n">status</span><span class="o">.</span><span class="n">isOnline</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>    <span class="n">ChatAPI</span><span class="o">.</span><span class="n">subscribeToFriendStatus</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">friend</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">handleStatusChange</span><span class="p">);</span>    <span class="k">return</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>      <span class="n">ChatAPI</span><span class="o">.</span><span class="n">unsubscribeFromFriendStatus</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">friend</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">handleStatusChange</span><span class="p">);</span>    <span class="p">};</span>  <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">isOnline</span> <span class="o">===</span> <span class="n">null</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s1">&#39;Loading...&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">isOnline</span> <span class="err">?</span> <span class="s1">&#39;Online&#39;</span> <span class="p">:</span> <span class="s1">&#39;Offline&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨è¿™ä¸ªç¤ºä¾‹ä¸­ï¼ŒReact ä¼šåœ¨ç»„ä»¶é”€æ¯æ—¶å–æ¶ˆå¯¹ <code>ChatAPI</code> çš„è®¢é˜…ï¼Œç„¶ååœ¨åç»­æ¸²æŸ“æ—¶é‡æ–°æ‰§è¡Œå‰¯ä½œç”¨å‡½æ•°ã€‚ï¼ˆå¦‚æœä¼ ç»™ <code>ChatAPI</code> çš„ <code>props.friend.id</code> æ²¡æœ‰å˜åŒ–ï¼Œä½ ä¹Ÿå¯ä»¥<a href="https://zh-hans.reactjs.org/docs/hooks-effect.html#tip-optimizing-performance-by-skipping-effects" target="_blank" rel="noopener noreferrer">å‘Šè¯‰ React è·³è¿‡é‡æ–°è®¢é˜…</a>ã€‚ï¼‰</p>
<p>è·Ÿ <code>useState</code> ä¸€æ ·ï¼Œä½ å¯ä»¥åœ¨ç»„ä»¶ä¸­å¤šæ¬¡ä½¿ç”¨ <code>useEffect</code> ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">FriendStatusWithCounter</span><span class="p">(</span><span class="n">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">count</span><span class="p">,</span> <span class="n">setCount</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>    <span class="n">document</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="err">`</span><span class="n">You</span> <span class="n">clicked</span> <span class="o">$</span><span class="p">{</span><span class="n">count</span><span class="p">}</span> <span class="n">times</span><span class="err">`</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">isOnline</span><span class="p">,</span> <span class="n">setIsOnline</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="n">null</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>    <span class="n">ChatAPI</span><span class="o">.</span><span class="n">subscribeToFriendStatus</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">friend</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">handleStatusChange</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">ChatAPI</span><span class="o">.</span><span class="n">unsubscribeFromFriendStatus</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">friend</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">handleStatusChange</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">function</span> <span class="n">handleStatusChange</span><span class="p">(</span><span class="n">status</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">setIsOnline</span><span class="p">(</span><span class="n">status</span><span class="o">.</span><span class="n">isOnline</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="o">...</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>é€šè¿‡ä½¿ç”¨ Hookï¼Œä½ å¯ä»¥æŠŠç»„ä»¶å†…ç›¸å…³çš„å‰¯ä½œç”¨ç»„ç»‡åœ¨ä¸€èµ·ï¼ˆä¾‹å¦‚åˆ›å»ºè®¢é˜…åŠå–æ¶ˆè®¢é˜…ï¼‰ï¼Œè€Œä¸è¦æŠŠå®ƒä»¬æ‹†åˆ†åˆ°ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°é‡Œã€‚</p>
<blockquote>
<p>è¯¦ç»†è¯´æ˜</p>
<p>ä½ å¯ä»¥åœ¨è¿™ä¸€ç« èŠ‚äº†è§£æ›´å¤šå…³äº <code>useEffect</code> çš„å†…å®¹ï¼š<a href="https://zh-hans.reactjs.org/docs/hooks-effect.html" target="_blank" rel="noopener noreferrer">ä½¿ç”¨ Effect Hook</a></p>
</blockquote>
<h5 id="-hook-ä½¿ç”¨è§„åˆ™" class="headerLink">
    <a href="#-hook-%e4%bd%bf%e7%94%a8%e8%a7%84%e5%88%99" class="header-mark"></a>âœŒï¸ Hook ä½¿ç”¨è§„åˆ™</h5><p>Hook å°±æ˜¯ JavaScript å‡½æ•°ï¼Œä½†æ˜¯ä½¿ç”¨å®ƒä»¬ä¼šæœ‰ä¸¤ä¸ªé¢å¤–çš„è§„åˆ™ï¼š</p>
<ul>
<li>åªèƒ½åœ¨<strong>å‡½æ•°æœ€å¤–å±‚</strong>è°ƒç”¨ Hookã€‚ä¸è¦åœ¨å¾ªç¯ã€æ¡ä»¶åˆ¤æ–­æˆ–è€…å­å‡½æ•°ä¸­è°ƒç”¨ã€‚</li>
<li>åªèƒ½åœ¨ <strong>React çš„å‡½æ•°ç»„ä»¶</strong>ä¸­è°ƒç”¨ Hookã€‚ä¸è¦åœ¨å…¶ä»– JavaScript å‡½æ•°ä¸­è°ƒç”¨ã€‚ï¼ˆè¿˜æœ‰ä¸€ä¸ªåœ°æ–¹å¯ä»¥è°ƒç”¨ Hook â€”â€” å°±æ˜¯è‡ªå®šä¹‰çš„ Hook ä¸­ï¼Œæˆ‘ä»¬ç¨åä¼šå­¦ä¹ åˆ°ã€‚ï¼‰</li>
</ul>
<p>åŒæ—¶ï¼Œæˆ‘ä»¬æä¾›äº† <a href="https://www.npmjs.com/package/eslint-plugin-react-hooks" target="_blank" rel="noopener noreferrer">linter æ’ä»¶</a>æ¥è‡ªåŠ¨æ‰§è¡Œè¿™äº›è§„åˆ™ã€‚è¿™äº›è§„åˆ™ä¹çœ‹èµ·æ¥ä¼šæœ‰ä¸€äº›é™åˆ¶å’Œä»¤äººå›°æƒ‘ï¼Œä½†æ˜¯è¦è®© Hook æ­£å¸¸å·¥ä½œï¼Œå®ƒä»¬è‡³å…³é‡è¦ã€‚</p>
<blockquote>
<p>è¯¦ç»†è¯´æ˜</p>
<p>ä½ å¯ä»¥åœ¨è¿™ç« èŠ‚äº†è§£æ›´å¤šå…³äºè¿™äº›è§„åˆ™çš„å†…å®¹ï¼š<a href="https://zh-hans.reactjs.org/docs/hooks-rules.html" target="_blank" rel="noopener noreferrer">Hook ä½¿ç”¨è§„åˆ™</a>ã€‚</p>
</blockquote>
<h5 id="-è‡ªå®šä¹‰-hook" class="headerLink">
    <a href="#-%e8%87%aa%e5%ae%9a%e4%b9%89-hook" class="header-mark"></a>ğŸ’¡ è‡ªå®šä¹‰ Hook</h5><p>æœ‰æ—¶å€™æˆ‘ä»¬ä¼šæƒ³è¦åœ¨ç»„ä»¶ä¹‹é—´é‡ç”¨ä¸€äº›çŠ¶æ€é€»è¾‘ã€‚ç›®å‰ä¸ºæ­¢ï¼Œæœ‰ä¸¤ç§ä¸»æµæ–¹æ¡ˆæ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š<a href="https://zh-hans.reactjs.org/docs/higher-order-components.html" target="_blank" rel="noopener noreferrer">é«˜é˜¶ç»„ä»¶</a>å’Œ <a href="https://zh-hans.reactjs.org/docs/render-props.html" target="_blank" rel="noopener noreferrer">render props</a>ã€‚è‡ªå®šä¹‰ Hook å¯ä»¥è®©ä½ åœ¨ä¸å¢åŠ ç»„ä»¶çš„æƒ…å†µä¸‹è¾¾åˆ°åŒæ ·çš„ç›®çš„ã€‚</p>
<p>å‰é¢ï¼Œæˆ‘ä»¬ä»‹ç»äº†ä¸€ä¸ªå« <code>FriendStatus</code> çš„ç»„ä»¶ï¼Œå®ƒé€šè¿‡è°ƒç”¨ <code>useState</code> å’Œ <code>useEffect</code> çš„ Hook æ¥è®¢é˜…ä¸€ä¸ªå¥½å‹çš„åœ¨çº¿çŠ¶æ€ã€‚å‡è®¾æˆ‘ä»¬æƒ³åœ¨å¦ä¸€ä¸ªç»„ä»¶é‡Œé‡ç”¨è¿™ä¸ªè®¢é˜…é€»è¾‘ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªé€»è¾‘æŠ½å–åˆ°ä¸€ä¸ªå«åš <code>useFriendStatus</code> çš„è‡ªå®šä¹‰ Hook é‡Œï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">import</span> <span class="n">React</span><span class="p">,</span> <span class="p">{</span> <span class="n">useState</span><span class="p">,</span> <span class="n">useEffect</span> <span class="p">}</span> <span class="n">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">useFriendStatus</span><span class="p">(</span><span class="n">friendID</span><span class="p">)</span> <span class="p">{</span>  <span class="k">const</span> <span class="p">[</span><span class="n">isOnline</span><span class="p">,</span> <span class="n">setIsOnline</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="n">null</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">function</span> <span class="n">handleStatusChange</span><span class="p">(</span><span class="n">status</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">setIsOnline</span><span class="p">(</span><span class="n">status</span><span class="o">.</span><span class="n">isOnline</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ChatAPI</span><span class="o">.</span><span class="n">subscribeToFriendStatus</span><span class="p">(</span><span class="n">friendID</span><span class="p">,</span> <span class="n">handleStatusChange</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">ChatAPI</span><span class="o">.</span><span class="n">unsubscribeFromFriendStatus</span><span class="p">(</span><span class="n">friendID</span><span class="p">,</span> <span class="n">handleStatusChange</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">isOnline</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å®ƒå°† <code>friendID</code> ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›è¯¥å¥½å‹æ˜¯å¦åœ¨çº¿ï¼š</p>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥åœ¨ä¸¤ä¸ªç»„ä»¶ä¸­ä½¿ç”¨å®ƒï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">FriendStatus</span><span class="p">(</span><span class="n">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">isOnline</span> <span class="o">=</span> <span class="n">useFriendStatus</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">friend</span><span class="o">.</span><span class="n">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">isOnline</span> <span class="o">===</span> <span class="n">null</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s1">&#39;Loading...&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">isOnline</span> <span class="err">?</span> <span class="s1">&#39;Online&#39;</span> <span class="p">:</span> <span class="s1">&#39;Offline&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">FriendListItem</span><span class="p">(</span><span class="n">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">isOnline</span> <span class="o">=</span> <span class="n">useFriendStatus</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">friend</span><span class="o">.</span><span class="n">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">li</span> <span class="n">style</span><span class="o">=</span><span class="p">{{</span> <span class="n">color</span><span class="p">:</span> <span class="n">isOnline</span> <span class="err">?</span> <span class="s1">&#39;green&#39;</span> <span class="p">:</span> <span class="s1">&#39;black&#39;</span> <span class="p">}}</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span><span class="n">props</span><span class="o">.</span><span class="n">friend</span><span class="o">.</span><span class="n">name</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ¯ä¸ªç»„ä»¶é—´çš„ state æ˜¯å®Œå…¨ç‹¬ç«‹çš„ã€‚Hook æ˜¯ä¸€ç§å¤ç”¨<em>çŠ¶æ€é€»è¾‘</em>çš„æ–¹å¼ï¼Œå®ƒä¸å¤ç”¨ state æœ¬èº«ã€‚äº‹å®ä¸Š Hook çš„æ¯æ¬¡<em>è°ƒç”¨</em>éƒ½æœ‰ä¸€ä¸ªå®Œå…¨ç‹¬ç«‹çš„ state â€”â€” å› æ­¤ä½ å¯ä»¥åœ¨å•ä¸ªç»„ä»¶ä¸­å¤šæ¬¡è°ƒç”¨åŒä¸€ä¸ªè‡ªå®šä¹‰ Hookã€‚</p>
<p>è‡ªå®šä¹‰ Hook æ›´åƒæ˜¯ä¸€ç§çº¦å®šè€Œä¸æ˜¯åŠŸèƒ½ã€‚å¦‚æœå‡½æ•°çš„åå­—ä»¥ â€œ<code>use</code>â€ å¼€å¤´å¹¶è°ƒç”¨å…¶ä»– Hookï¼Œæˆ‘ä»¬å°±è¯´è¿™æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰ Hookã€‚ <code>useSomething</code> çš„å‘½åçº¦å®šå¯ä»¥è®©æˆ‘ä»¬çš„ linter æ’ä»¶åœ¨ä½¿ç”¨ Hook çš„ä»£ç ä¸­æ‰¾åˆ° bugã€‚</p>
<p>ä½ å¯ä»¥åˆ›å»ºæ¶µç›–å„ç§åœºæ™¯çš„è‡ªå®šä¹‰ Hookï¼Œå¦‚è¡¨å•å¤„ç†ã€åŠ¨ç”»ã€è®¢é˜…å£°æ˜ã€è®¡æ—¶å™¨ï¼Œç”šè‡³å¯èƒ½è¿˜æœ‰æ›´å¤šæˆ‘ä»¬æ²¡æƒ³åˆ°çš„åœºæ™¯ã€‚æˆ‘ä»¬å¾ˆæœŸå¾…çœ‹åˆ° React ç¤¾åŒºä¼šå‡ºç°ä»€ä¹ˆæ ·çš„è‡ªå®šä¹‰ Hookã€‚</p>
<blockquote>
<p>è¯¦ç»†è¯´æ˜</p>
<p>æˆ‘ä»¬ä¼šåœ¨è¿™ä¸€ç« èŠ‚ä»‹ç»æ›´å¤šå…³äºè‡ªå®šä¹‰ Hook çš„å†…å®¹ï¼š <a href="https://zh-hans.reactjs.org/docs/hooks-custom.html" target="_blank" rel="noopener noreferrer">åˆ›å»ºä½ è‡ªå·±çš„ Hook</a>ã€‚</p>
</blockquote>
<h5 id="-å…¶ä»–-hook" class="headerLink">
    <a href="#-%e5%85%b6%e4%bb%96-hook" class="header-mark"></a>ğŸ”Œ å…¶ä»– Hook</h5><p>é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€äº›ä½¿ç”¨é¢‘ç‡è¾ƒä½çš„ä½†æ˜¯å¾ˆæœ‰ç”¨çš„ Hookã€‚æ¯”å¦‚ï¼Œ<a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#usecontext" target="_blank" rel="noopener noreferrer"><code>useContext</code></a> è®©ä½ ä¸ä½¿ç”¨ç»„ä»¶åµŒå¥—å°±å¯ä»¥è®¢é˜… React çš„ Contextã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">Example</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">locale</span> <span class="o">=</span> <span class="n">useContext</span><span class="p">(</span><span class="n">LocaleContext</span><span class="p">);</span>  <span class="k">const</span> <span class="n">theme</span> <span class="o">=</span> <span class="n">useContext</span><span class="p">(</span><span class="n">ThemeContext</span><span class="p">);</span>  <span class="o">//</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¦å¤– <a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#usereducer" target="_blank" rel="noopener noreferrer"><code>useReducer</code></a> å¯ä»¥è®©ä½ é€šè¿‡ reducer æ¥ç®¡ç†ç»„ä»¶æœ¬åœ°çš„å¤æ‚ stateã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">Todos</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">todos</span><span class="p">,</span> <span class="n">dispatch</span><span class="p">]</span> <span class="o">=</span> <span class="n">useReducer</span><span class="p">(</span><span class="n">todosReducer</span><span class="p">);</span>  <span class="o">//</span> <span class="o">...</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>è¯¦ç»†è¯´æ˜</p>
<p>ä½ å¯ä»¥åœ¨è¿™ä¸€ç« èŠ‚äº†è§£æ›´å¤šå…³äºæ‰€æœ‰å†…ç½® Hook çš„å†…å®¹ï¼š<a href="https://zh-hans.reactjs.org/docs/hooks-reference.html" target="_blank" rel="noopener noreferrer">Hook API ç´¢å¼•</a>ã€‚</p>
</blockquote>
<h4 id="ä½¿ç”¨-state-hook" class="headerLink">
    <a href="#%e4%bd%bf%e7%94%a8-state-hook" class="header-mark"></a>ä½¿ç”¨ State Hook</h4><p><em>Hook</em> æ˜¯ React 16.8 çš„æ–°å¢ç‰¹æ€§ã€‚å®ƒå¯ä»¥è®©ä½ åœ¨ä¸ç¼–å†™ class çš„æƒ…å†µä¸‹ä½¿ç”¨ state ä»¥åŠå…¶ä»–çš„ React ç‰¹æ€§ã€‚</p>
<p><a href="https://zh-hans.reactjs.org/docs/hooks-intro.html" target="_blank" rel="noopener noreferrer">Hook ç®€ä»‹ç« èŠ‚</a>ä¸­ä½¿ç”¨ä¸‹é¢çš„ä¾‹å­ä»‹ç»äº† Hookï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">import</span> <span class="n">React</span><span class="p">,</span> <span class="p">{</span> <span class="n">useState</span> <span class="p">}</span> <span class="n">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">Example</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="err">å£°æ˜ä¸€ä¸ªå«</span> <span class="s2">&#34;count&#34;</span> <span class="err">çš„</span> <span class="n">state</span> <span class="err">å˜é‡</span>  <span class="k">const</span> <span class="p">[</span><span class="n">count</span><span class="p">,</span> <span class="n">setCount</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">You</span> <span class="n">clicked</span> <span class="p">{</span><span class="n">count</span><span class="p">}</span> <span class="n">times</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">button</span> <span class="n">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="n">setCount</span><span class="p">(</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)}</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="n">Click</span> <span class="n">me</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;/</span><span class="n">button</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬å°†é€šè¿‡å°†è¿™æ®µä»£ç ä¸ä¸€ä¸ªç­‰ä»·çš„ class ç¤ºä¾‹è¿›è¡Œæ¯”è¾ƒæ¥å¼€å§‹å­¦ä¹  Hookã€‚</p>
<h5 id="ç­‰ä»·çš„-class-ç¤ºä¾‹" class="headerLink">
    <a href="#%e7%ad%89%e4%bb%b7%e7%9a%84-class-%e7%a4%ba%e4%be%8b" class="header-mark"></a>ç­‰ä»·çš„ class ç¤ºä¾‹</h5><p>å¦‚æœä½ ä¹‹å‰åœ¨ React ä¸­ä½¿ç”¨è¿‡ classï¼Œè¿™æ®µä»£ç çœ‹èµ·æ¥åº”è¯¥å¾ˆç†Ÿæ‚‰ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">class</span> <span class="n">Example</span> <span class="k">extends</span> <span class="n">React</span><span class="o">.</span><span class="n">Component</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">constructor</span><span class="p">(</span><span class="n">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">super</span><span class="p">(</span><span class="n">props</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">this</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">count</span><span class="p">:</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">render</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">You</span> <span class="n">clicked</span> <span class="p">{</span><span class="n">this</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">count</span><span class="p">}</span> <span class="n">times</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">button</span> <span class="n">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="n">this</span><span class="o">.</span><span class="n">setState</span><span class="p">({</span> <span class="n">count</span><span class="p">:</span> <span class="n">this</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">})}</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">          <span class="n">Click</span> <span class="n">me</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="n">button</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>state åˆå§‹å€¼ä¸º <code>{ count: 0 }</code> ï¼Œå½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®åï¼Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨ <code>this.setState()</code> æ¥å¢åŠ  <code>state.count</code>ã€‚æ•´ä¸ªç« èŠ‚ä¸­éƒ½å°†ä½¿ç”¨è¯¥ class çš„ä»£ç ç‰‡æ®µåšç¤ºä¾‹ã€‚</p>
<blockquote>
<p>æ³¨æ„</p>
<p>ä½ å¯èƒ½æƒ³çŸ¥é“ä¸ºä»€ä¹ˆæˆ‘ä»¬åœ¨è¿™é‡Œä½¿ç”¨ä¸€ä¸ªè®¡æ•°å™¨ä¾‹å­è€Œä¸æ˜¯ä¸€ä¸ªæ›´å®é™…çš„ç¤ºä¾‹ã€‚å› ä¸ºæˆ‘ä»¬è¿˜åªæ˜¯åˆæ­¥æ¥è§¦ Hook ï¼Œè¿™å¯ä»¥å¸®åŠ©æˆ‘ä»¬å°†æ³¨æ„åŠ›é›†ä¸­åˆ° API æœ¬èº«ã€‚</p>
</blockquote>
<h5 id="hook-å’Œå‡½æ•°ç»„ä»¶" class="headerLink">
    <a href="#hook-%e5%92%8c%e5%87%bd%e6%95%b0%e7%bb%84%e4%bb%b6" class="header-mark"></a>Hook å’Œå‡½æ•°ç»„ä»¶</h5><p>å¤ä¹ ä¸€ä¸‹ï¼Œ React çš„å‡½æ•°ç»„ä»¶æ˜¯è¿™æ ·çš„ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">const</span> <span class="n">Example</span> <span class="o">=</span> <span class="p">(</span><span class="n">props</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="err">ä½ å¯ä»¥åœ¨è¿™ä½¿ç”¨</span> <span class="n">Hook</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="o">&lt;</span><span class="n">div</span> <span class="o">/&gt;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆ–æ˜¯è¿™æ ·ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">function Example(props) {
</span></span><span class="line"><span class="cl">  // ä½ å¯ä»¥åœ¨è¿™ä½¿ç”¨ Hook
</span></span><span class="line"><span class="cl">  return &lt;div /&gt;;
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½ ä¹‹å‰å¯èƒ½æŠŠå®ƒä»¬å«åšâ€œæ— çŠ¶æ€ç»„ä»¶â€ã€‚ä½†ç°åœ¨æˆ‘ä»¬ä¸ºå®ƒä»¬å¼•å…¥äº†ä½¿ç”¨ React state çš„èƒ½åŠ›ï¼Œæ‰€ä»¥æˆ‘ä»¬æ›´å–œæ¬¢å«å®ƒâ€å‡½æ•°ç»„ä»¶â€ã€‚</p>
<p>Hook åœ¨ class å†…éƒ¨æ˜¯<strong>ä¸</strong>èµ·ä½œç”¨çš„ã€‚ä½†ä½ å¯ä»¥ä½¿ç”¨å®ƒä»¬æ¥å–ä»£ class ã€‚</p>
<h5 id="hook-æ˜¯ä»€ä¹ˆ" class="headerLink">
    <a href="#hook-%e6%98%af%e4%bb%80%e4%b9%88" class="header-mark"></a>Hook æ˜¯ä»€ä¹ˆï¼Ÿ</h5><p>åœ¨æ–°ç¤ºä¾‹ä¸­ï¼Œé¦–å…ˆå¼•å…¥ React ä¸­ <code>useState</code> çš„ Hook</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">import React, { useState } from &#39;react&#39;;
</span></span><span class="line"><span class="cl">function Example() {
</span></span><span class="line"><span class="cl">  // ...
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Hook æ˜¯ä»€ä¹ˆï¼Ÿ</strong> Hook æ˜¯ä¸€ä¸ªç‰¹æ®Šçš„å‡½æ•°ï¼Œå®ƒå¯ä»¥è®©ä½ â€œé’©å…¥â€ React çš„ç‰¹æ€§ã€‚ä¾‹å¦‚ï¼Œ<code>useState</code> æ˜¯å…è®¸ä½ åœ¨ React å‡½æ•°ç»„ä»¶ä¸­æ·»åŠ  state çš„ Hookã€‚ç¨åæˆ‘ä»¬å°†å­¦ä¹ å…¶ä»– Hookã€‚</p>
<p><strong>ä»€ä¹ˆæ—¶å€™æˆ‘ä¼šç”¨ Hookï¼Ÿ</strong> å¦‚æœä½ åœ¨ç¼–å†™å‡½æ•°ç»„ä»¶å¹¶æ„è¯†åˆ°éœ€è¦å‘å…¶æ·»åŠ ä¸€äº› stateï¼Œä»¥å‰çš„åšæ³•æ˜¯å¿…é¡»å°†å…¶è½¬åŒ–ä¸º classã€‚ç°åœ¨ä½ å¯ä»¥åœ¨ç°æœ‰çš„å‡½æ•°ç»„ä»¶ä¸­ä½¿ç”¨ Hookã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼š</p>
<p>åœ¨ç»„ä»¶ä¸­æœ‰äº›ç‰¹æ®Šçš„è§„åˆ™ï¼Œè§„å®šä»€ä¹ˆåœ°æ–¹èƒ½ä½¿ç”¨ Hookï¼Œä»€ä¹ˆåœ°æ–¹ä¸èƒ½ä½¿ç”¨ã€‚æˆ‘ä»¬å°†åœ¨ <a href="https://zh-hans.reactjs.org/docs/hooks-rules.html" target="_blank" rel="noopener noreferrer">Hook è§„åˆ™</a>ä¸­å­¦ä¹ å®ƒä»¬ã€‚</p>
</blockquote>
<h5 id="å£°æ˜-state-å˜é‡" class="headerLink">
    <a href="#%e5%a3%b0%e6%98%8e-state-%e5%8f%98%e9%87%8f" class="header-mark"></a>å£°æ˜ State å˜é‡</h5><p>åœ¨ class ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡åœ¨æ„é€ å‡½æ•°ä¸­è®¾ç½® <code>this.state</code> ä¸º <code>{ count: 0 }</code> æ¥åˆå§‹åŒ– <code>count</code> state ä¸º <code>0</code>ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">class</span> <span class="n">Example</span> <span class="k">extends</span> <span class="n">React</span><span class="o">.</span><span class="n">Component</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">constructor</span><span class="p">(</span><span class="n">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">super</span><span class="p">(</span><span class="n">props</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">this</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="p">{</span>      <span class="n">count</span><span class="p">:</span> <span class="mi">0</span>    <span class="p">};</span>  <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨å‡½æ•°ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰ <code>this</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½åˆ†é…æˆ–è¯»å– <code>this.state</code>ã€‚æˆ‘ä»¬ç›´æ¥åœ¨ç»„ä»¶ä¸­è°ƒç”¨ <code>useState</code> Hookï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">import</span> <span class="n">React</span><span class="p">,</span> <span class="p">{</span> <span class="n">useState</span> <span class="p">}</span> <span class="n">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">Example</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="err">å£°æ˜ä¸€ä¸ªå«</span> <span class="err">â€œ</span><span class="n">count</span><span class="err">â€</span> <span class="err">çš„</span> <span class="n">state</span> <span class="err">å˜é‡</span>  <span class="k">const</span> <span class="p">[</span><span class="n">count</span><span class="p">,</span> <span class="n">setCount</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong><code>è°ƒç”¨ useState</code> æ–¹æ³•çš„æ—¶å€™åšäº†ä»€ä¹ˆ?</strong> å®ƒå®šä¹‰ä¸€ä¸ª â€œstate å˜é‡â€ã€‚æˆ‘ä»¬çš„å˜é‡å« <code>count</code>ï¼Œ ä½†æ˜¯æˆ‘ä»¬å¯ä»¥å«ä»–ä»»ä½•åå­—ï¼Œæ¯”å¦‚ <code>banana</code>ã€‚è¿™æ˜¯ä¸€ç§åœ¨å‡½æ•°è°ƒç”¨æ—¶ä¿å­˜å˜é‡çš„æ–¹å¼ â€”â€” <code>useState</code> æ˜¯ä¸€ç§æ–°æ–¹æ³•ï¼Œå®ƒä¸ class é‡Œé¢çš„ <code>this.state</code> æä¾›çš„åŠŸèƒ½å®Œå…¨ç›¸åŒã€‚ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨å‡½æ•°é€€å‡ºåå˜é‡å°±ä¼šâ€æ¶ˆå¤±â€ï¼Œè€Œ state ä¸­çš„å˜é‡ä¼šè¢« React ä¿ç•™ã€‚</p>
<p><strong><code>useState</code> éœ€è¦å“ªäº›å‚æ•°ï¼Ÿ</strong> <code>useState()</code> æ–¹æ³•é‡Œé¢å”¯ä¸€çš„å‚æ•°å°±æ˜¯åˆå§‹ stateã€‚ä¸åŒäº class çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ç…§éœ€è¦ä½¿ç”¨æ•°å­—æˆ–å­—ç¬¦ä¸²å¯¹å…¶è¿›è¡Œèµ‹å€¼ï¼Œè€Œä¸ä¸€å®šæ˜¯å¯¹è±¡ã€‚åœ¨ç¤ºä¾‹ä¸­ï¼Œåªéœ€ä½¿ç”¨æ•°å­—æ¥è®°å½•ç”¨æˆ·ç‚¹å‡»æ¬¡æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼ äº† <code>0</code> ä½œä¸ºå˜é‡çš„åˆå§‹ stateã€‚ï¼ˆå¦‚æœæˆ‘ä»¬æƒ³è¦åœ¨ state ä¸­å­˜å‚¨ä¸¤ä¸ªä¸åŒçš„å˜é‡ï¼Œåªéœ€è°ƒç”¨ <code>useState()</code> ä¸¤æ¬¡å³å¯ã€‚ï¼‰</p>
<p><strong><code>useState</code> æ–¹æ³•çš„è¿”å›å€¼æ˜¯ä»€ä¹ˆï¼Ÿ</strong> è¿”å›å€¼ä¸ºï¼šå½“å‰ state ä»¥åŠæ›´æ–° state çš„å‡½æ•°ã€‚è¿™å°±æ˜¯æˆ‘ä»¬å†™ <code>const [count, setCount] = useState()</code> çš„åŸå› ã€‚è¿™ä¸ class é‡Œé¢ <code>this.state.count</code> å’Œ <code>this.setState</code> ç±»ä¼¼ï¼Œå”¯ä¸€åŒºåˆ«å°±æ˜¯ä½ éœ€è¦æˆå¯¹çš„è·å–å®ƒä»¬ã€‚å¦‚æœä½ ä¸ç†Ÿæ‚‰æˆ‘ä»¬ä½¿ç”¨çš„è¯­æ³•ï¼Œæˆ‘ä»¬ä¼šåœ¨<a href="https://zh-hans.reactjs.org/docs/hooks-state.html#tip-what-do-square-brackets-mean" target="_blank" rel="noopener noreferrer">æœ¬ç« èŠ‚çš„åº•éƒ¨</a>ä»‹ç»å®ƒã€‚</p>
<p>æ—¢ç„¶æˆ‘ä»¬çŸ¥é“äº† <code>useState</code> çš„ä½œç”¨ï¼Œæˆ‘ä»¬çš„ç¤ºä¾‹åº”è¯¥æ›´å®¹æ˜“ç†è§£äº†ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">import</span> <span class="n">React</span><span class="p">,</span> <span class="p">{</span> <span class="n">useState</span> <span class="p">}</span> <span class="n">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">Example</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="err">å£°æ˜ä¸€ä¸ªå«</span> <span class="s2">&#34;count&#34;</span> <span class="err">çš„</span> <span class="n">state</span> <span class="err">å˜é‡</span>  <span class="k">const</span> <span class="p">[</span><span class="n">count</span><span class="p">,</span> <span class="n">setCount</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬å£°æ˜äº†ä¸€ä¸ªå« <code>count</code> çš„ state å˜é‡ï¼Œç„¶åæŠŠå®ƒè®¾ä¸º <code>0</code>ã€‚React ä¼šåœ¨é‡å¤æ¸²æŸ“æ—¶è®°ä½å®ƒå½“å‰çš„å€¼ï¼Œå¹¶ä¸”æä¾›æœ€æ–°çš„å€¼ç»™æˆ‘ä»¬çš„å‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨ <code>setCount</code> æ¥æ›´æ–°å½“å‰çš„ <code>count</code>ã€‚</p>
<blockquote>
<p>æ³¨æ„</p>
<p>ä½ å¯èƒ½æƒ³çŸ¥é“ï¼šä¸ºä»€ä¹ˆå« <code>useState</code> è€Œä¸å« <code>createState</code>?</p>
<p>â€œCreateâ€ å¯èƒ½ä¸æ˜¯å¾ˆå‡†ç¡®ï¼Œå› ä¸º state åªåœ¨ç»„ä»¶é¦–æ¬¡æ¸²æŸ“çš„æ—¶å€™è¢«åˆ›å»ºã€‚åœ¨ä¸‹ä¸€æ¬¡é‡æ–°æ¸²æŸ“æ—¶ï¼Œ<code>useState</code> è¿”å›ç»™æˆ‘ä»¬å½“å‰çš„ stateã€‚å¦åˆ™å®ƒå°±ä¸æ˜¯ â€œstateâ€äº†ï¼è¿™ä¹Ÿæ˜¯ Hook çš„åå­—<em>æ€»æ˜¯</em>ä»¥ <code>use</code> å¼€å¤´çš„ä¸€ä¸ªåŸå› ã€‚æˆ‘ä»¬å°†åœ¨åé¢çš„ <a href="https://zh-hans.reactjs.org/docs/hooks-rules.html" target="_blank" rel="noopener noreferrer">Hook è§„åˆ™</a>ä¸­äº†è§£åŸå› ã€‚</p>
</blockquote>
<h5 id="è¯»å–-state" class="headerLink">
    <a href="#%e8%af%bb%e5%8f%96-state" class="header-mark"></a>è¯»å– State</h5><p>å½“æˆ‘ä»¬æƒ³åœ¨ class ä¸­æ˜¾ç¤ºå½“å‰çš„ countï¼Œæˆ‘ä»¬è¯»å– <code>this.state.count</code>ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">  &lt;p&gt;You clicked {this.state.count} times&lt;/p&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ç”¨ <code>count</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">  &lt;p&gt;You clicked {count} times&lt;/p&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="æ›´æ–°-state" class="headerLink">
    <a href="#%e6%9b%b4%e6%96%b0-state" class="header-mark"></a>æ›´æ–° State</h5><p>åœ¨ class ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è°ƒç”¨ <code>this.setState()</code> æ¥æ›´æ–° <code>count</code> å€¼ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">  &lt;button onClick={() =&gt; this.setState({ count: this.state.count + 1 })}&gt;    Click me
</span></span><span class="line"><span class="cl">  &lt;/button&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å·²ç»æœ‰äº† <code>setCount</code> å’Œ <code>count</code> å˜é‡ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦ <code>this</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">  &lt;button onClick={() =&gt; setCount(count + 1)}&gt;    Click me
</span></span><span class="line"><span class="cl">  &lt;/button&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="æ€»ç»“" class="headerLink">
    <a href="#%e6%80%bb%e7%bb%93" class="header-mark"></a>æ€»ç»“</h5><p>ç°åœ¨è®©æˆ‘ä»¬æ¥<strong>ä»”ç»†å›é¡¾ä¸€ä¸‹å­¦åˆ°çš„çŸ¥è¯†</strong>ï¼Œçœ‹ä¸‹æˆ‘ä»¬æ˜¯å¦çœŸæ­£ç†è§£äº†ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"> <span class="mi">1</span><span class="p">:</span>  <span class="n">import</span> <span class="n">React</span><span class="p">,</span> <span class="p">{</span> <span class="n">useState</span> <span class="p">}</span> <span class="n">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span> <span class="mi">2</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"> <span class="mi">3</span><span class="p">:</span>  <span class="n">function</span> <span class="n">Example</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl"> <span class="mi">4</span><span class="p">:</span>    <span class="k">const</span> <span class="p">[</span><span class="n">count</span><span class="p">,</span> <span class="n">setCount</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span> <span class="mi">5</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"> <span class="mi">6</span><span class="p">:</span>    <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl"> <span class="mi">7</span><span class="p">:</span>      <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"> <span class="mi">8</span><span class="p">:</span>        <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">You</span> <span class="n">clicked</span> <span class="p">{</span><span class="n">count</span><span class="p">}</span> <span class="n">times</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"> <span class="mi">9</span><span class="p">:</span>        <span class="o">&lt;</span><span class="n">button</span> <span class="n">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="n">setCount</span><span class="p">(</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)}</span><span class="o">&gt;</span><span class="mi">10</span><span class="p">:</span>         <span class="n">Click</span> <span class="n">me</span>
</span></span><span class="line"><span class="cl"><span class="mi">11</span><span class="p">:</span>        <span class="o">&lt;/</span><span class="n">button</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="mi">12</span><span class="p">:</span>      <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="mi">13</span><span class="p">:</span>    <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="mi">14</span><span class="p">:</span>  <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li><strong>ç¬¬ä¸€è¡Œ:</strong> å¼•å…¥ React ä¸­çš„ <code>useState</code> Hookã€‚å®ƒè®©æˆ‘ä»¬åœ¨å‡½æ•°ç»„ä»¶ä¸­å­˜å‚¨å†…éƒ¨ stateã€‚</li>
<li><strong>ç¬¬å››è¡Œ:</strong> åœ¨ <code>Example</code> ç»„ä»¶å†…éƒ¨ï¼Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨ <code>useState</code> Hook å£°æ˜äº†ä¸€ä¸ªæ–°çš„ state å˜é‡ã€‚å®ƒè¿”å›ä¸€å¯¹å€¼ç»™åˆ°æˆ‘ä»¬å‘½åçš„å˜é‡ä¸Šã€‚æˆ‘ä»¬æŠŠå˜é‡å‘½åä¸º <code>count</code>ï¼Œå› ä¸ºå®ƒå­˜å‚¨çš„æ˜¯ç‚¹å‡»æ¬¡æ•°ã€‚æˆ‘ä»¬é€šè¿‡ä¼  <code>0</code> ä½œä¸º <code>useState</code> å”¯ä¸€çš„å‚æ•°æ¥å°†å…¶åˆå§‹åŒ–ä¸º <code>0</code>ã€‚ç¬¬äºŒä¸ªè¿”å›çš„å€¼æœ¬èº«å°±æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚å®ƒè®©æˆ‘ä»¬å¯ä»¥æ›´æ–° <code>count</code> çš„å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å«å®ƒ <code>setCount</code>ã€‚</li>
<li><strong>ç¬¬ä¹è¡Œ:</strong> å½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®åï¼Œæˆ‘ä»¬ä¼ é€’ä¸€ä¸ªæ–°çš„å€¼ç»™ <code>setCount</code>ã€‚React ä¼šé‡æ–°æ¸²æŸ“ <code>Example</code> ç»„ä»¶ï¼Œå¹¶æŠŠæœ€æ–°çš„ <code>count</code> ä¼ ç»™å®ƒã€‚</li>
</ul>
<p>ä¹ä¸€çœ‹è¿™ä¼¼ä¹æœ‰ç‚¹å¤ªå¤šäº†ã€‚ä¸è¦æ€¥äºæ±‚æˆï¼å¦‚æœä½ æœ‰ä¸ç†è§£çš„åœ°æ–¹ï¼Œè¯·å†æ¬¡æŸ¥çœ‹ä»¥ä¸Šä»£ç å¹¶ä»å¤´åˆ°å°¾é˜…è¯»ã€‚æˆ‘ä»¬ä¿è¯ä¸€æ—¦ä½ è¯•ç€â€å¿˜è®°â€ class é‡Œé¢ state æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œå¹¶ç”¨æ–°çš„çœ¼å…‰çœ‹è¿™æ®µä»£ç ï¼Œå°±å®¹æ˜“ç†è§£äº†ã€‚</p>
<h6 id="æç¤ºæ–¹æ‹¬å·æœ‰ä»€ä¹ˆç”¨" class="headerLink">
    <a href="#%e6%8f%90%e7%a4%ba%e6%96%b9%e6%8b%ac%e5%8f%b7%e6%9c%89%e4%bb%80%e4%b9%88%e7%94%a8" class="header-mark"></a>æç¤ºï¼šæ–¹æ‹¬å·æœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h6><p>ä½ å¯èƒ½æ³¨æ„åˆ°æˆ‘ä»¬ç”¨æ–¹æ‹¬å·å®šä¹‰äº†ä¸€ä¸ª state å˜é‡</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">count</span><span class="p">,</span> <span class="n">setCount</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç­‰å·å·¦è¾¹åå­—å¹¶ä¸æ˜¯ React API çš„éƒ¨åˆ†ï¼Œä½ å¯ä»¥è‡ªå·±å–åå­—ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">fruit</span><span class="p">,</span> <span class="n">setFruit</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="s1">&#39;banana&#39;</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™ç§ JavaScript è¯­æ³•å«<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment#Array_destructuring" target="_blank" rel="noopener noreferrer">æ•°ç»„è§£æ„</a>ã€‚å®ƒæ„å‘³ç€æˆ‘ä»¬åŒæ—¶åˆ›å»ºäº† <code>fruit</code> å’Œ <code>setFruit</code> ä¸¤ä¸ªå˜é‡ï¼Œ<code>fruit</code> çš„å€¼ä¸º <code>useState</code> è¿”å›çš„ç¬¬ä¸€ä¸ªå€¼ï¼Œ<code>setFruit</code> æ˜¯è¿”å›çš„ç¬¬äºŒä¸ªå€¼ã€‚å®ƒç­‰ä»·äºä¸‹é¢çš„ä»£ç ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl">  <span class="k">var</span> <span class="n">fruitStateVariable</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="s1">&#39;banana&#39;</span><span class="p">);</span> <span class="o">//</span> <span class="err">è¿”å›ä¸€ä¸ªæœ‰ä¸¤ä¸ªå…ƒç´ çš„æ•°ç»„</span>
</span></span><span class="line"><span class="cl">  <span class="k">var</span> <span class="n">fruit</span> <span class="o">=</span> <span class="n">fruitStateVariable</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span> <span class="o">//</span> <span class="err">æ•°ç»„é‡Œçš„ç¬¬ä¸€ä¸ªå€¼</span>
</span></span><span class="line"><span class="cl">  <span class="k">var</span> <span class="n">setFruit</span> <span class="o">=</span> <span class="n">fruitStateVariable</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="o">//</span> <span class="err">æ•°ç»„é‡Œçš„ç¬¬äºŒä¸ªå€¼</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å½“æˆ‘ä»¬ä½¿ç”¨ <code>useState</code> å®šä¹‰ state å˜é‡æ—¶å€™ï¼Œå®ƒè¿”å›ä¸€ä¸ªæœ‰ä¸¤ä¸ªå€¼çš„æ•°ç»„ã€‚ç¬¬ä¸€ä¸ªå€¼æ˜¯å½“å‰çš„ stateï¼Œç¬¬äºŒä¸ªå€¼æ˜¯æ›´æ–° state çš„å‡½æ•°ã€‚ä½¿ç”¨ <code>[0]</code> å’Œ <code>[1]</code> æ¥è®¿é—®æœ‰ç‚¹ä»¤äººå›°æƒ‘ï¼Œå› ä¸ºå®ƒä»¬æœ‰ç‰¹å®šçš„å«ä¹‰ã€‚è¿™å°±æ˜¯æˆ‘ä»¬ä½¿ç”¨æ•°ç»„è§£æ„çš„åŸå› ã€‚</p>
<blockquote>
<p>æ³¨æ„</p>
<p>ä½ å¯èƒ½ä¼šå¥½å¥‡ React æ€ä¹ˆçŸ¥é“ <code>useState</code> å¯¹åº”çš„æ˜¯å“ªä¸ªç»„ä»¶ï¼Œå› ä¸ºæˆ‘ä»¬å¹¶æ²¡æœ‰ä¼ é€’ <code>this</code> ç»™ Reactã€‚æˆ‘ä»¬å°†åœ¨ FAQ éƒ¨åˆ†å›ç­”<a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#how-does-react-associate-hook-calls-with-components" target="_blank" rel="noopener noreferrer">è¿™ä¸ªé—®é¢˜</a>ä»¥åŠè®¸å¤šå…¶ä»–é—®é¢˜ã€‚</p>
</blockquote>
<h6 id="æç¤ºä½¿ç”¨å¤šä¸ª-state-å˜é‡" class="headerLink">
    <a href="#%e6%8f%90%e7%a4%ba%e4%bd%bf%e7%94%a8%e5%a4%9a%e4%b8%aa-state-%e5%8f%98%e9%87%8f" class="header-mark"></a>æç¤ºï¼šä½¿ç”¨å¤šä¸ª state å˜é‡</h6><p>å°† state å˜é‡å£°æ˜ä¸ºä¸€å¯¹ <code>[something, setSomething]</code> ä¹Ÿå¾ˆæ–¹ä¾¿ï¼Œå› ä¸ºå¦‚æœæˆ‘ä»¬æƒ³ä½¿ç”¨å¤šä¸ª state å˜é‡ï¼Œå®ƒå…è®¸æˆ‘ä»¬ç»™ä¸åŒçš„ state å˜é‡å–ä¸åŒçš„åç§°ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">ExampleWithManyStates</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="err">å£°æ˜å¤šä¸ª</span> <span class="n">state</span> <span class="err">å˜é‡</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">age</span><span class="p">,</span> <span class="n">setAge</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="mi">42</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">fruit</span><span class="p">,</span> <span class="n">setFruit</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="s1">&#39;banana&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">todos</span><span class="p">,</span> <span class="n">setTodos</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">([{</span> <span class="n">text</span><span class="p">:</span> <span class="s1">&#39;å­¦ä¹  Hook&#39;</span> <span class="p">}]);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨ä»¥ä¸Šç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬æœ‰å±€éƒ¨å˜é‡ <code>age</code>ï¼Œ<code>fruit</code> å’Œ <code>todos</code>ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥å•ç‹¬æ›´æ–°å®ƒä»¬ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">  function handleOrangeClick() {
</span></span><span class="line"><span class="cl">    // å’Œ this.setState({ fruit: &#39;orange&#39; }) ç±»ä¼¼
</span></span><span class="line"><span class="cl">    setFruit(&#39;orange&#39;);
</span></span><span class="line"><span class="cl">  }
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½ <strong>ä¸å¿…</strong>ä½¿ç”¨å¤šä¸ª state å˜é‡ã€‚State å˜é‡å¯ä»¥å¾ˆå¥½åœ°å­˜å‚¨å¯¹è±¡å’Œæ•°ç»„ï¼Œå› æ­¤ï¼Œä½ ä»ç„¶å¯ä»¥å°†ç›¸å…³æ•°æ®åˆ†ä¸ºä¸€ç»„ã€‚ç„¶è€Œï¼Œä¸åƒ class ä¸­çš„ <code>this.setState</code>ï¼Œæ›´æ–° state å˜é‡æ€»æ˜¯<em>æ›¿æ¢</em>å®ƒè€Œä¸æ˜¯åˆå¹¶å®ƒã€‚</p>
<p>æˆ‘ä»¬<a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#should-i-use-one-or-many-state-variables" target="_blank" rel="noopener noreferrer">åœ¨ FAQ ä¸­</a>æä¾›äº†æ›´å¤šå…³äºåˆ†ç¦»ç‹¬ç«‹ state å˜é‡çš„å»ºè®®ã€‚</p>
<h4 id="ä½¿ç”¨-effect-hook" class="headerLink">
    <a href="#%e4%bd%bf%e7%94%a8-effect-hook" class="header-mark"></a>ä½¿ç”¨ Effect Hook</h4><p><em>Hook</em> æ˜¯ React 16.8 çš„æ–°å¢ç‰¹æ€§ã€‚å®ƒå¯ä»¥è®©ä½ åœ¨ä¸ç¼–å†™ class çš„æƒ…å†µä¸‹ä½¿ç”¨ state ä»¥åŠå…¶ä»–çš„ React ç‰¹æ€§ã€‚</p>
<p><em>Effect Hook</em> å¯ä»¥è®©ä½ åœ¨å‡½æ•°ç»„ä»¶ä¸­æ‰§è¡Œå‰¯ä½œç”¨æ“ä½œ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">import</span> <span class="n">React</span><span class="p">,</span> <span class="p">{</span> <span class="n">useState</span><span class="p">,</span> <span class="n">useEffect</span> <span class="p">}</span> <span class="n">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">Example</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">count</span><span class="p">,</span> <span class="n">setCount</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">Similar</span> <span class="n">to</span> <span class="n">componentDidMount</span> <span class="ow">and</span> <span class="n">componentDidUpdate</span><span class="p">:</span>  <span class="n">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>    <span class="o">//</span> <span class="n">Update</span> <span class="n">the</span> <span class="n">document</span> <span class="n">title</span> <span class="n">using</span> <span class="n">the</span> <span class="n">browser</span> <span class="n">API</span>    <span class="n">document</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="err">`</span><span class="n">You</span> <span class="n">clicked</span> <span class="o">$</span><span class="p">{</span><span class="n">count</span><span class="p">}</span> <span class="n">times</span><span class="err">`</span><span class="p">;</span>  <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">You</span> <span class="n">clicked</span> <span class="p">{</span><span class="n">count</span><span class="p">}</span> <span class="n">times</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">button</span> <span class="n">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="n">setCount</span><span class="p">(</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)}</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="n">Click</span> <span class="n">me</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;/</span><span class="n">button</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ®µä»£ç åŸºäº<a href="https://zh-hans.reactjs.org/docs/hooks-state.html" target="_blank" rel="noopener noreferrer">ä¸Šä¸€ç« èŠ‚ä¸­çš„è®¡æ•°å™¨ç¤ºä¾‹</a>è¿›è¡Œä¿®æ”¹ï¼Œæˆ‘ä»¬ä¸ºè®¡æ•°å™¨å¢åŠ äº†ä¸€ä¸ªå°åŠŸèƒ½ï¼šå°† document çš„ title è®¾ç½®ä¸ºåŒ…å«äº†ç‚¹å‡»æ¬¡æ•°çš„æ¶ˆæ¯ã€‚</p>
<p>æ•°æ®è·å–ï¼Œè®¾ç½®è®¢é˜…ä»¥åŠæ‰‹åŠ¨æ›´æ”¹ React ç»„ä»¶ä¸­çš„ DOM éƒ½å±äºå‰¯ä½œç”¨ã€‚ä¸ç®¡ä½ çŸ¥ä¸çŸ¥é“è¿™äº›æ“ä½œï¼Œæˆ–æ˜¯â€œå‰¯ä½œç”¨â€è¿™ä¸ªåå­—ï¼Œåº”è¯¥éƒ½åœ¨ç»„ä»¶ä¸­ä½¿ç”¨è¿‡å®ƒä»¬ã€‚</p>
<blockquote>
<p>æç¤º</p>
<p>å¦‚æœä½ ç†Ÿæ‚‰ React class çš„ç”Ÿå‘½å‘¨æœŸå‡½æ•°ï¼Œä½ å¯ä»¥æŠŠ <code>useEffect</code> Hook çœ‹åš <code>componentDidMount</code>ï¼Œ<code>componentDidUpdate</code> å’Œ <code>componentWillUnmount</code> è¿™ä¸‰ä¸ªå‡½æ•°çš„ç»„åˆã€‚</p>
</blockquote>
<p>åœ¨ React ç»„ä»¶ä¸­æœ‰ä¸¤ç§å¸¸è§å‰¯ä½œç”¨æ“ä½œï¼šéœ€è¦æ¸…é™¤çš„å’Œä¸éœ€è¦æ¸…é™¤çš„ã€‚æˆ‘ä»¬æ¥æ›´ä»”ç»†åœ°çœ‹ä¸€ä¸‹ä»–ä»¬ä¹‹é—´çš„åŒºåˆ«ã€‚</p>
<h5 id="æ— éœ€æ¸…é™¤çš„-effect" class="headerLink">
    <a href="#%e6%97%a0%e9%9c%80%e6%b8%85%e9%99%a4%e7%9a%84-effect" class="header-mark"></a>æ— éœ€æ¸…é™¤çš„ effect</h5><p>æœ‰æ—¶å€™ï¼Œæˆ‘ä»¬åªæƒ³**åœ¨ React æ›´æ–° DOM ä¹‹åè¿è¡Œä¸€äº›é¢å¤–çš„ä»£ç ã€‚**æ¯”å¦‚å‘é€ç½‘ç»œè¯·æ±‚ï¼Œæ‰‹åŠ¨å˜æ›´ DOMï¼Œè®°å½•æ—¥å¿—ï¼Œè¿™äº›éƒ½æ˜¯å¸¸è§çš„æ— éœ€æ¸…é™¤çš„æ“ä½œã€‚å› ä¸ºæˆ‘ä»¬åœ¨æ‰§è¡Œå®Œè¿™äº›æ“ä½œä¹‹åï¼Œå°±å¯ä»¥å¿½ç•¥ä»–ä»¬äº†ã€‚è®©æˆ‘ä»¬å¯¹æ¯”ä¸€ä¸‹ä½¿ç”¨ class å’Œ Hook éƒ½æ˜¯æ€ä¹ˆå®ç°è¿™äº›å‰¯ä½œç”¨çš„ã€‚</p>
<h6 id="ä½¿ç”¨-class-çš„ç¤ºä¾‹" class="headerLink">
    <a href="#%e4%bd%bf%e7%94%a8-class-%e7%9a%84%e7%a4%ba%e4%be%8b" class="header-mark"></a>ä½¿ç”¨ class çš„ç¤ºä¾‹</h6><p>åœ¨ React çš„ class ç»„ä»¶ä¸­ï¼Œ<code>render</code> å‡½æ•°æ˜¯ä¸åº”è¯¥æœ‰ä»»ä½•å‰¯ä½œç”¨çš„ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œåœ¨è¿™é‡Œæ‰§è¡Œæ“ä½œå¤ªæ—©äº†ï¼Œæˆ‘ä»¬åŸºæœ¬ä¸Šéƒ½å¸Œæœ›åœ¨ React æ›´æ–° DOM ä¹‹åæ‰æ‰§è¡Œæˆ‘ä»¬çš„æ“ä½œã€‚</p>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨ React class ä¸­ï¼Œæˆ‘ä»¬æŠŠå‰¯ä½œç”¨æ“ä½œæ”¾åˆ° <code>componentDidMount</code> å’Œ <code>componentDidUpdate</code> å‡½æ•°ä¸­ã€‚å›åˆ°ç¤ºä¾‹ä¸­ï¼Œè¿™æ˜¯ä¸€ä¸ª React è®¡æ•°å™¨çš„ class ç»„ä»¶ã€‚å®ƒåœ¨ React å¯¹ DOM è¿›è¡Œæ“ä½œä¹‹åï¼Œç«‹å³æ›´æ–°äº† document çš„ title å±æ€§</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">class</span> <span class="n">Example</span> <span class="k">extends</span> <span class="n">React</span><span class="o">.</span><span class="n">Component</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">constructor</span><span class="p">(</span><span class="n">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">super</span><span class="p">(</span><span class="n">props</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">this</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">count</span><span class="p">:</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">componentDidMount</span><span class="p">()</span> <span class="p">{</span>    <span class="n">document</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="err">`</span><span class="n">You</span> <span class="n">clicked</span> <span class="o">$</span><span class="p">{</span><span class="n">this</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">count</span><span class="p">}</span> <span class="n">times</span><span class="err">`</span><span class="p">;</span>  <span class="p">}</span>  <span class="n">componentDidUpdate</span><span class="p">()</span> <span class="p">{</span>    <span class="n">document</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="err">`</span><span class="n">You</span> <span class="n">clicked</span> <span class="o">$</span><span class="p">{</span><span class="n">this</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">count</span><span class="p">}</span> <span class="n">times</span><span class="err">`</span><span class="p">;</span>  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">render</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">You</span> <span class="n">clicked</span> <span class="p">{</span><span class="n">this</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">count</span><span class="p">}</span> <span class="n">times</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">button</span> <span class="n">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="n">this</span><span class="o">.</span><span class="n">setState</span><span class="p">({</span> <span class="n">count</span><span class="p">:</span> <span class="n">this</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span> <span class="p">})}</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">          <span class="n">Click</span> <span class="n">me</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;/</span><span class="n">button</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ³¨æ„ï¼Œ<strong>åœ¨è¿™ä¸ª class ä¸­ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­ç¼–å†™é‡å¤çš„ä»£ç ã€‚</strong></p>
<p>è¿™æ˜¯å› ä¸ºå¾ˆå¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨ç»„ä»¶åŠ è½½å’Œæ›´æ–°æ—¶æ‰§è¡ŒåŒæ ·çš„æ“ä½œã€‚ä»æ¦‚å¿µä¸Šè¯´ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒåœ¨æ¯æ¬¡æ¸²æŸ“ä¹‹åæ‰§è¡Œ â€”â€” ä½† React çš„ class ç»„ä»¶æ²¡æœ‰æä¾›è¿™æ ·çš„æ–¹æ³•ã€‚å³ä½¿æˆ‘ä»¬æå–å‡ºä¸€ä¸ªæ–¹æ³•ï¼Œæˆ‘ä»¬è¿˜æ˜¯è¦åœ¨ä¸¤ä¸ªåœ°æ–¹è°ƒç”¨å®ƒã€‚</p>
<p>ç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ <code>useEffect</code> æ‰§è¡Œç›¸åŒçš„æ“ä½œã€‚</p>
<h6 id="ä½¿ç”¨-hook-çš„ç¤ºä¾‹" class="headerLink">
    <a href="#%e4%bd%bf%e7%94%a8-hook-%e7%9a%84%e7%a4%ba%e4%be%8b" class="header-mark"></a>ä½¿ç”¨ Hook çš„ç¤ºä¾‹</h6><p>æˆ‘ä»¬åœ¨æœ¬ç« èŠ‚å¼€å§‹æ—¶å·²ç»çœ‹åˆ°äº†è¿™ä¸ªç¤ºä¾‹ï¼Œä½†è®©æˆ‘ä»¬å†ä»”ç»†è§‚å¯Ÿå®ƒï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">import</span> <span class="n">React</span><span class="p">,</span> <span class="p">{</span> <span class="n">useState</span><span class="p">,</span> <span class="n">useEffect</span> <span class="p">}</span> <span class="n">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">Example</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">count</span><span class="p">,</span> <span class="n">setCount</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>    <span class="n">document</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="err">`</span><span class="n">You</span> <span class="n">clicked</span> <span class="o">$</span><span class="p">{</span><span class="n">count</span><span class="p">}</span> <span class="n">times</span><span class="err">`</span><span class="p">;</span>  <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">You</span> <span class="n">clicked</span> <span class="p">{</span><span class="n">count</span><span class="p">}</span> <span class="n">times</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">button</span> <span class="n">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="n">setCount</span><span class="p">(</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)}</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="n">Click</span> <span class="n">me</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;/</span><span class="n">button</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong><code>useEffect</code> åšäº†ä»€ä¹ˆï¼Ÿ</strong> é€šè¿‡ä½¿ç”¨è¿™ä¸ª Hookï¼Œä½ å¯ä»¥å‘Šè¯‰ React ç»„ä»¶éœ€è¦åœ¨æ¸²æŸ“åæ‰§è¡ŒæŸäº›æ“ä½œã€‚React ä¼šä¿å­˜ä½ ä¼ é€’çš„å‡½æ•°ï¼ˆæˆ‘ä»¬å°†å®ƒç§°ä¹‹ä¸º â€œeffectâ€ï¼‰ï¼Œå¹¶ä¸”åœ¨æ‰§è¡Œ DOM æ›´æ–°ä¹‹åè°ƒç”¨å®ƒã€‚åœ¨è¿™ä¸ª effect ä¸­ï¼Œæˆ‘ä»¬è®¾ç½®äº† document çš„ title å±æ€§ï¼Œä¸è¿‡æˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰§è¡Œæ•°æ®è·å–æˆ–è°ƒç”¨å…¶ä»–å‘½ä»¤å¼çš„ APIã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆåœ¨ç»„ä»¶å†…éƒ¨è°ƒç”¨ <code>useEffect</code>ï¼Ÿ</strong> å°† <code>useEffect</code> æ”¾åœ¨ç»„ä»¶å†…éƒ¨è®©æˆ‘ä»¬å¯ä»¥åœ¨ effect ä¸­ç›´æ¥è®¿é—® <code>count</code> state å˜é‡ï¼ˆæˆ–å…¶ä»– propsï¼‰ã€‚æˆ‘ä»¬ä¸éœ€è¦ç‰¹æ®Šçš„ API æ¥è¯»å–å®ƒ â€”â€” å®ƒå·²ç»ä¿å­˜åœ¨å‡½æ•°ä½œç”¨åŸŸä¸­ã€‚Hook ä½¿ç”¨äº† JavaScript çš„é—­åŒ…æœºåˆ¶ï¼Œè€Œä¸ç”¨åœ¨ JavaScript å·²ç»æä¾›äº†è§£å†³æ–¹æ¡ˆçš„æƒ…å†µä¸‹ï¼Œè¿˜å¼•å…¥ç‰¹å®šçš„ React APIã€‚</p>
<p><strong><code>useEffect</code> ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“åéƒ½æ‰§è¡Œå—ï¼Ÿ</strong> æ˜¯çš„ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒåœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“ä¹‹å<em>å’Œ</em>æ¯æ¬¡æ›´æ–°ä¹‹åéƒ½ä¼šæ‰§è¡Œã€‚ï¼ˆæˆ‘ä»¬ç¨åä¼šè°ˆåˆ°<a href="https://zh-hans.reactjs.org/docs/hooks-effect.html#tip-optimizing-performance-by-skipping-effects" target="_blank" rel="noopener noreferrer">å¦‚ä½•æ§åˆ¶å®ƒ</a>ã€‚ï¼‰ä½ å¯èƒ½ä¼šæ›´å®¹æ˜“æ¥å— effect å‘ç”Ÿåœ¨â€œæ¸²æŸ“ä¹‹åâ€è¿™ç§æ¦‚å¿µï¼Œä¸ç”¨å†å»è€ƒè™‘â€œæŒ‚è½½â€è¿˜æ˜¯â€œæ›´æ–°â€ã€‚React ä¿è¯äº†æ¯æ¬¡è¿è¡Œ effect çš„åŒæ—¶ï¼ŒDOM éƒ½å·²ç»æ›´æ–°å®Œæ¯•ã€‚</p>
<h6 id="è¯¦ç»†è¯´æ˜" class="headerLink">
    <a href="#%e8%af%a6%e7%bb%86%e8%af%b4%e6%98%8e" class="header-mark"></a>è¯¦ç»†è¯´æ˜</h6><p>ç°åœ¨æˆ‘ä»¬å·²ç»å¯¹ effect æœ‰äº†å¤§è‡´äº†è§£ï¼Œä¸‹é¢è¿™äº›ä»£ç åº”è¯¥ä¸éš¾çœ‹æ‡‚äº†ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">Example</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">count</span><span class="p">,</span> <span class="n">setCount</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">document</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="err">`</span><span class="n">You</span> <span class="n">clicked</span> <span class="o">$</span><span class="p">{</span><span class="n">count</span><span class="p">}</span> <span class="n">times</span><span class="err">`</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬å£°æ˜äº† <code>count</code> state å˜é‡ï¼Œå¹¶å‘Šè¯‰ React æˆ‘ä»¬éœ€è¦ä½¿ç”¨ effectã€‚ç´§æ¥ç€ä¼ é€’å‡½æ•°ç»™ <code>useEffect</code> Hookã€‚æ­¤å‡½æ•°å°±æ˜¯æˆ‘ä»¬çš„ effectã€‚ç„¶åä½¿ç”¨ <code>document.title</code> æµè§ˆå™¨ API è®¾ç½® document çš„ titleã€‚æˆ‘ä»¬å¯ä»¥åœ¨ effect ä¸­è·å–åˆ°æœ€æ–°çš„ <code>count</code> å€¼ï¼Œå› ä¸ºä»–åœ¨å‡½æ•°çš„ä½œç”¨åŸŸå†…ã€‚å½“ React æ¸²æŸ“ç»„ä»¶æ—¶ï¼Œä¼šä¿å­˜å·²ä½¿ç”¨çš„ effectï¼Œå¹¶åœ¨æ›´æ–°å®Œ DOM åæ‰§è¡Œå®ƒã€‚è¿™ä¸ªè¿‡ç¨‹åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½ä¼šå‘ç”Ÿï¼ŒåŒ…æ‹¬é¦–æ¬¡æ¸²æŸ“ã€‚</p>
<p>ç»éªŒä¸°å¯Œçš„ JavaScript å¼€å‘äººå‘˜å¯èƒ½ä¼šæ³¨æ„åˆ°ï¼Œä¼ é€’ç»™ <code>useEffect</code> çš„å‡½æ•°åœ¨æ¯æ¬¡æ¸²æŸ“ä¸­éƒ½ä¼šæœ‰æ‰€ä¸åŒï¼Œè¿™æ˜¯åˆ»æ„ä¸ºä¹‹çš„ã€‚äº‹å®ä¸Šè¿™æ­£æ˜¯æˆ‘ä»¬å¯ä»¥åœ¨ effect ä¸­è·å–æœ€æ–°çš„ <code>count</code> çš„å€¼ï¼Œè€Œä¸ç”¨æ‹…å¿ƒå…¶è¿‡æœŸçš„åŸå› ã€‚æ¯æ¬¡æˆ‘ä»¬é‡æ–°æ¸²æŸ“ï¼Œéƒ½ä¼šç”Ÿæˆ<em>æ–°çš„</em> effectï¼Œæ›¿æ¢æ‰ä¹‹å‰çš„ã€‚æŸç§æ„ä¹‰ä¸Šè®²ï¼Œeffect æ›´åƒæ˜¯æ¸²æŸ“ç»“æœçš„ä¸€éƒ¨åˆ† â€”â€” æ¯ä¸ª effect â€œå±äºâ€ä¸€æ¬¡ç‰¹å®šçš„æ¸²æŸ“ã€‚æˆ‘ä»¬å°†åœ¨<a href="https://zh-hans.reactjs.org/docs/hooks-effect.html#explanation-why-effects-run-on-each-update" target="_blank" rel="noopener noreferrer">æœ¬ç« èŠ‚åç»­éƒ¨åˆ†</a>æ›´æ¸…æ¥šåœ°äº†è§£è¿™æ ·åšçš„æ„ä¹‰ã€‚</p>
<blockquote>
<p>æç¤º</p>
<p>ä¸ <code>componentDidMount</code> æˆ– <code>componentDidUpdate</code> ä¸åŒï¼Œä½¿ç”¨ <code>useEffect</code> è°ƒåº¦çš„ effect ä¸ä¼šé˜»å¡æµè§ˆå™¨æ›´æ–°å±å¹•ï¼Œè¿™è®©ä½ çš„åº”ç”¨çœ‹èµ·æ¥å“åº”æ›´å¿«ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œeffect ä¸éœ€è¦åŒæ­¥åœ°æ‰§è¡Œã€‚åœ¨ä¸ªåˆ«æƒ…å†µä¸‹ï¼ˆä¾‹å¦‚æµ‹é‡å¸ƒå±€ï¼‰ï¼Œæœ‰å•ç‹¬çš„ <a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#uselayouteffect" target="_blank" rel="noopener noreferrer"><code>useLayoutEffect</code></a> Hook ä¾›ä½ ä½¿ç”¨ï¼Œå…¶ API ä¸ <code>useEffect</code> ç›¸åŒã€‚</p>
</blockquote>
<h5 id="éœ€è¦æ¸…é™¤çš„-effect" class="headerLink">
    <a href="#%e9%9c%80%e8%a6%81%e6%b8%85%e9%99%a4%e7%9a%84-effect" class="header-mark"></a>éœ€è¦æ¸…é™¤çš„ effect</h5><p>ä¹‹å‰ï¼Œæˆ‘ä»¬ç ”ç©¶äº†å¦‚ä½•ä½¿ç”¨ä¸éœ€è¦æ¸…é™¤çš„å‰¯ä½œç”¨ï¼Œè¿˜æœ‰ä¸€äº›å‰¯ä½œç”¨æ˜¯éœ€è¦æ¸…é™¤çš„ã€‚ä¾‹å¦‚<strong>è®¢é˜…å¤–éƒ¨æ•°æ®æº</strong>ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæ¸…é™¤å·¥ä½œæ˜¯éå¸¸é‡è¦çš„ï¼Œå¯ä»¥é˜²æ­¢å¼•èµ·å†…å­˜æ³„éœ²ï¼ç°åœ¨è®©æˆ‘ä»¬æ¥æ¯”è¾ƒä¸€ä¸‹å¦‚ä½•ç”¨ Class å’Œ Hook æ¥å®ç°ã€‚</p>
<h6 id="ä½¿ç”¨-class-çš„ç¤ºä¾‹-1" class="headerLink">
    <a href="#%e4%bd%bf%e7%94%a8-class-%e7%9a%84%e7%a4%ba%e4%be%8b-1" class="header-mark"></a>ä½¿ç”¨ Class çš„ç¤ºä¾‹</h6><p>åœ¨ React class ä¸­ï¼Œä½ é€šå¸¸ä¼šåœ¨ <code>componentDidMount</code> ä¸­è®¾ç½®è®¢é˜…ï¼Œå¹¶åœ¨ <code>componentWillUnmount</code> ä¸­æ¸…é™¤å®ƒã€‚ä¾‹å¦‚ï¼Œå‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ª <code>ChatAPI</code> æ¨¡å—ï¼Œå®ƒå…è®¸æˆ‘ä»¬è®¢é˜…å¥½å‹çš„åœ¨çº¿çŠ¶æ€ã€‚ä»¥ä¸‹æ˜¯æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨ class è®¢é˜…å’Œæ˜¾ç¤ºè¯¥çŠ¶æ€ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">class</span> <span class="n">FriendStatus</span> <span class="k">extends</span> <span class="n">React</span><span class="o">.</span><span class="n">Component</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">constructor</span><span class="p">(</span><span class="n">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">super</span><span class="p">(</span><span class="n">props</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">this</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="p">{</span> <span class="n">isOnline</span><span class="p">:</span> <span class="n">null</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="n">this</span><span class="o">.</span><span class="n">handleStatusChange</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">handleStatusChange</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">this</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">componentDidMount</span><span class="p">()</span> <span class="p">{</span>    <span class="n">ChatAPI</span><span class="o">.</span><span class="n">subscribeToFriendStatus</span><span class="p">(</span>      <span class="n">this</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">friend</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>      <span class="n">this</span><span class="o">.</span><span class="n">handleStatusChange</span>    <span class="p">);</span>  <span class="p">}</span>  <span class="n">componentWillUnmount</span><span class="p">()</span> <span class="p">{</span>    <span class="n">ChatAPI</span><span class="o">.</span><span class="n">unsubscribeFromFriendStatus</span><span class="p">(</span>      <span class="n">this</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">friend</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>      <span class="n">this</span><span class="o">.</span><span class="n">handleStatusChange</span>    <span class="p">);</span>  <span class="p">}</span>  <span class="n">handleStatusChange</span><span class="p">(</span><span class="n">status</span><span class="p">)</span> <span class="p">{</span>    <span class="n">this</span><span class="o">.</span><span class="n">setState</span><span class="p">({</span>      <span class="n">isOnline</span><span class="p">:</span> <span class="n">status</span><span class="o">.</span><span class="n">isOnline</span>    <span class="p">});</span>  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">render</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="n">this</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">isOnline</span> <span class="o">===</span> <span class="n">null</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="s1">&#39;Loading...&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">this</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">isOnline</span> <span class="err">?</span> <span class="s1">&#39;Online&#39;</span> <span class="p">:</span> <span class="s1">&#39;Offline&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä½ ä¼šæ³¨æ„åˆ° <code>componentDidMount</code> å’Œ <code>componentWillUnmount</code> ä¹‹é—´ç›¸äº’å¯¹åº”ã€‚ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸå‡½æ•°è¿«ä½¿æˆ‘ä»¬æ‹†åˆ†è¿™äº›é€»è¾‘ä»£ç ï¼Œå³ä½¿è¿™ä¸¤éƒ¨åˆ†ä»£ç éƒ½ä½œç”¨äºç›¸åŒçš„å‰¯ä½œç”¨ã€‚</p>
<blockquote>
<p>æ³¨æ„</p>
<p>çœ¼å°–çš„è¯»è€…å¯èƒ½å·²ç»æ³¨æ„åˆ°äº†ï¼Œè¿™ä¸ªç¤ºä¾‹è¿˜éœ€è¦ç¼–å†™ <code>componentDidUpdate</code> æ–¹æ³•æ‰èƒ½ä¿è¯å®Œå…¨æ­£ç¡®ã€‚æˆ‘ä»¬å…ˆæš‚æ—¶å¿½ç•¥è¿™ä¸€ç‚¹ï¼Œæœ¬ç« èŠ‚ä¸­<a href="https://zh-hans.reactjs.org/docs/hooks-effect.html#explanation-why-effects-run-on-each-update" target="_blank" rel="noopener noreferrer">åç»­éƒ¨åˆ†</a>ä¼šä»‹ç»å®ƒã€‚</p>
</blockquote>
<h6 id="ä½¿ç”¨-hook-çš„ç¤ºä¾‹-1" class="headerLink">
    <a href="#%e4%bd%bf%e7%94%a8-hook-%e7%9a%84%e7%a4%ba%e4%be%8b-1" class="header-mark"></a>ä½¿ç”¨ Hook çš„ç¤ºä¾‹</h6><p>å¦‚ä½•ä½¿ç”¨ Hook ç¼–å†™è¿™ä¸ªç»„ä»¶ã€‚</p>
<p>ä½ å¯èƒ½è®¤ä¸ºéœ€è¦å•ç‹¬çš„ effect æ¥æ‰§è¡Œæ¸…é™¤æ“ä½œã€‚ä½†ç”±äºæ·»åŠ å’Œåˆ é™¤è®¢é˜…çš„ä»£ç çš„ç´§å¯†æ€§ï¼Œæ‰€ä»¥ <code>useEffect</code> çš„è®¾è®¡æ˜¯åœ¨åŒä¸€ä¸ªåœ°æ–¹æ‰§è¡Œã€‚å¦‚æœä½ çš„ effect è¿”å›ä¸€ä¸ªå‡½æ•°ï¼ŒReact å°†ä¼šåœ¨æ‰§è¡Œæ¸…é™¤æ“ä½œæ—¶è°ƒç”¨å®ƒï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">import</span> <span class="n">React</span><span class="p">,</span> <span class="p">{</span> <span class="n">useState</span><span class="p">,</span> <span class="n">useEffect</span> <span class="p">}</span> <span class="n">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">FriendStatus</span><span class="p">(</span><span class="n">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">isOnline</span><span class="p">,</span> <span class="n">setIsOnline</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="n">null</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>    <span class="n">function</span> <span class="n">handleStatusChange</span><span class="p">(</span><span class="n">status</span><span class="p">)</span> <span class="p">{</span>      <span class="n">setIsOnline</span><span class="p">(</span><span class="n">status</span><span class="o">.</span><span class="n">isOnline</span><span class="p">);</span>    <span class="p">}</span>    <span class="n">ChatAPI</span><span class="o">.</span><span class="n">subscribeToFriendStatus</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">friend</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">handleStatusChange</span><span class="p">);</span>    <span class="o">//</span> <span class="n">Specify</span> <span class="n">how</span> <span class="n">to</span> <span class="n">clean</span> <span class="n">up</span> <span class="n">after</span> <span class="n">this</span> <span class="n">effect</span><span class="p">:</span>    <span class="k">return</span> <span class="n">function</span> <span class="n">cleanup</span><span class="p">()</span> <span class="p">{</span>      <span class="n">ChatAPI</span><span class="o">.</span><span class="n">unsubscribeFromFriendStatus</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">friend</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">handleStatusChange</span><span class="p">);</span>    <span class="p">};</span>  <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">isOnline</span> <span class="o">===</span> <span class="n">null</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s1">&#39;Loading...&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">isOnline</span> <span class="err">?</span> <span class="s1">&#39;Online&#39;</span> <span class="p">:</span> <span class="s1">&#39;Offline&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ä¸ºä»€ä¹ˆè¦åœ¨ effect ä¸­è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Ÿ</strong> è¿™æ˜¯ effect å¯é€‰çš„æ¸…é™¤æœºåˆ¶ã€‚æ¯ä¸ª effect éƒ½å¯ä»¥è¿”å›ä¸€ä¸ªæ¸…é™¤å‡½æ•°ã€‚å¦‚æ­¤å¯ä»¥å°†æ·»åŠ å’Œç§»é™¤è®¢é˜…çš„é€»è¾‘æ”¾åœ¨ä¸€èµ·ã€‚å®ƒä»¬éƒ½å±äº effect çš„ä¸€éƒ¨åˆ†ã€‚</p>
<p><strong>React ä½•æ—¶æ¸…é™¤ effectï¼Ÿ</strong> React ä¼šåœ¨ç»„ä»¶å¸è½½çš„æ—¶å€™æ‰§è¡Œæ¸…é™¤æ“ä½œã€‚æ­£å¦‚ä¹‹å‰å­¦åˆ°çš„ï¼Œeffect åœ¨æ¯æ¬¡æ¸²æŸ“çš„æ—¶å€™éƒ½ä¼šæ‰§è¡Œã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ React <em>ä¼š</em>åœ¨æ‰§è¡Œå½“å‰ effect ä¹‹å‰å¯¹ä¸Šä¸€ä¸ª effect è¿›è¡Œæ¸…é™¤ã€‚æˆ‘ä»¬ç¨åå°†è®¨è®º<a href="https://zh-hans.reactjs.org/docs/hooks-effect.html#explanation-why-effects-run-on-each-update" target="_blank" rel="noopener noreferrer">ä¸ºä»€ä¹ˆè¿™å°†åŠ©äºé¿å… bug</a>ä»¥åŠ<a href="https://zh-hans.reactjs.org/docs/hooks-effect.html#tip-optimizing-performance-by-skipping-effects" target="_blank" rel="noopener noreferrer">å¦‚ä½•åœ¨é‡åˆ°æ€§èƒ½é—®é¢˜æ—¶è·³è¿‡æ­¤è¡Œä¸º</a>ã€‚</p>
<blockquote>
<p>æ³¨æ„</p>
<p>å¹¶ä¸æ˜¯å¿…é¡»ä¸º effect ä¸­è¿”å›çš„å‡½æ•°å‘½åã€‚è¿™é‡Œæˆ‘ä»¬å°†å…¶å‘½åä¸º <code>cleanup</code> æ˜¯ä¸ºäº†è¡¨æ˜æ­¤å‡½æ•°çš„ç›®çš„ï¼Œä½†å…¶å®ä¹Ÿå¯ä»¥è¿”å›ä¸€ä¸ªç®­å¤´å‡½æ•°æˆ–è€…ç»™èµ·ä¸€ä¸ªåˆ«çš„åå­—ã€‚</p>
</blockquote>
<h5 id="å°ç»“" class="headerLink">
    <a href="#%e5%b0%8f%e7%bb%93" class="header-mark"></a>å°ç»“</h5><p>äº†è§£äº† <code>useEffect</code> å¯ä»¥åœ¨ç»„ä»¶æ¸²æŸ“åå®ç°å„ç§ä¸åŒçš„å‰¯ä½œç”¨ã€‚æœ‰äº›å‰¯ä½œç”¨å¯èƒ½éœ€è¦æ¸…é™¤ï¼Œæ‰€ä»¥éœ€è¦è¿”å›ä¸€ä¸ªå‡½æ•°ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">  useEffect(() =&gt; {
</span></span><span class="line"><span class="cl">    function handleStatusChange(status) {
</span></span><span class="line"><span class="cl">      setIsOnline(status.isOnline);
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    ChatAPI.subscribeToFriendStatus(props.friend.id, handleStatusChange);
</span></span><span class="line"><span class="cl">    return () =&gt; {
</span></span><span class="line"><span class="cl">      ChatAPI.unsubscribeFromFriendStatus(props.friend.id, handleStatusChange);
</span></span><span class="line"><span class="cl">    };
</span></span><span class="line"><span class="cl">  });
</span></span></code></pre></td></tr></table>
</div>
</div><p>å…¶ä»–çš„ effect å¯èƒ½ä¸å¿…æ¸…é™¤ï¼Œæ‰€ä»¥ä¸éœ€è¦è¿”å›ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">  useEffect(() =&gt; {
</span></span><span class="line"><span class="cl">    document.title = `You clicked ${count} times`;
</span></span><span class="line"><span class="cl">  });
</span></span></code></pre></td></tr></table>
</div>
</div><p>effect Hook ä½¿ç”¨åŒä¸€ä¸ª API æ¥æ»¡è¶³è¿™ä¸¤ç§æƒ…å†µã€‚</p>
<hr>
<p><strong>å¦‚æœä½ å¯¹ Effect Hook çš„æœºåˆ¶å·²ç»æœ‰å¾ˆå¥½çš„æŠŠæ¡ï¼Œæˆ–è€…æš‚æ—¶éš¾ä»¥æ¶ˆåŒ–æ›´å¤šå†…å®¹ï¼Œä½ ç°åœ¨å°±å¯ä»¥è·³è½¬åˆ°<a href="https://zh-hans.reactjs.org/docs/hooks-rules.html" target="_blank" rel="noopener noreferrer">ä¸‹ä¸€ç« èŠ‚å­¦ä¹  Hook çš„è§„åˆ™</a>ã€‚</strong></p>
<hr>
<h5 id="ä½¿ç”¨-effect-çš„æç¤º" class="headerLink">
    <a href="#%e4%bd%bf%e7%94%a8-effect-%e7%9a%84%e6%8f%90%e7%a4%ba" class="header-mark"></a>ä½¿ç”¨ Effect çš„æç¤º</h5><p>åœ¨æœ¬èŠ‚ä¸­å°†ç»§ç»­æ·±å…¥äº†è§£ <code>useEffect</code> çš„æŸäº›ç‰¹æ€§ï¼Œæœ‰ç»éªŒçš„ React ä½¿ç”¨è€…å¯èƒ½ä¼šå¯¹æ­¤æ„Ÿå…´è¶£ã€‚ä½ ä¸ä¸€å®šè¦åœ¨ç°åœ¨äº†è§£ä»–ä»¬ï¼Œä½ å¯ä»¥éšæ—¶æŸ¥çœ‹æ­¤é¡µé¢ä»¥äº†è§£æœ‰å…³ Effect Hook çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚</p>
<h6 id="æç¤º-ä½¿ç”¨å¤šä¸ª-effect-å®ç°å…³æ³¨ç‚¹åˆ†ç¦»" class="headerLink">
    <a href="#%e6%8f%90%e7%a4%ba-%e4%bd%bf%e7%94%a8%e5%a4%9a%e4%b8%aa-effect-%e5%ae%9e%e7%8e%b0%e5%85%b3%e6%b3%a8%e7%82%b9%e5%88%86%e7%a6%bb" class="header-mark"></a>æç¤º: ä½¿ç”¨å¤šä¸ª Effect å®ç°å…³æ³¨ç‚¹åˆ†ç¦»</h6><p>ä½¿ç”¨ Hook å…¶ä¸­ä¸€ä¸ª<a href="https://zh-hans.reactjs.org/docs/hooks-intro.html#complex-components-become-hard-to-understand" target="_blank" rel="noopener noreferrer">ç›®çš„</a>å°±æ˜¯è¦è§£å†³ class ä¸­ç”Ÿå‘½å‘¨æœŸå‡½æ•°ç»å¸¸åŒ…å«ä¸ç›¸å…³çš„é€»è¾‘ï¼Œä½†åˆæŠŠç›¸å…³é€»è¾‘åˆ†ç¦»åˆ°äº†å‡ ä¸ªä¸åŒæ–¹æ³•ä¸­çš„é—®é¢˜ã€‚ä¸‹è¿°ä»£ç æ˜¯å°†å‰è¿°ç¤ºä¾‹ä¸­çš„è®¡æ•°å™¨å’Œå¥½å‹åœ¨çº¿çŠ¶æ€æŒ‡ç¤ºå™¨é€»è¾‘ç»„åˆåœ¨ä¸€èµ·çš„ç»„ä»¶ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">class</span> <span class="n">FriendStatusWithCounter</span> <span class="k">extends</span> <span class="n">React</span><span class="o">.</span><span class="n">Component</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">constructor</span><span class="p">(</span><span class="n">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">super</span><span class="p">(</span><span class="n">props</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">this</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="p">{</span> <span class="n">count</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">isOnline</span><span class="p">:</span> <span class="n">null</span> <span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="n">this</span><span class="o">.</span><span class="n">handleStatusChange</span> <span class="o">=</span> <span class="n">this</span><span class="o">.</span><span class="n">handleStatusChange</span><span class="o">.</span><span class="n">bind</span><span class="p">(</span><span class="n">this</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">componentDidMount</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">document</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="err">`</span><span class="n">You</span> <span class="n">clicked</span> <span class="o">$</span><span class="p">{</span><span class="n">this</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">count</span><span class="p">}</span> <span class="n">times</span><span class="err">`</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="n">ChatAPI</span><span class="o">.</span><span class="n">subscribeToFriendStatus</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="n">this</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">friend</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">this</span><span class="o">.</span><span class="n">handleStatusChange</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">componentDidUpdate</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">document</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="err">`</span><span class="n">You</span> <span class="n">clicked</span> <span class="o">$</span><span class="p">{</span><span class="n">this</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">count</span><span class="p">}</span> <span class="n">times</span><span class="err">`</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">componentWillUnmount</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">ChatAPI</span><span class="o">.</span><span class="n">unsubscribeFromFriendStatus</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">      <span class="n">this</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">friend</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="n">this</span><span class="o">.</span><span class="n">handleStatusChange</span>
</span></span><span class="line"><span class="cl">    <span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">handleStatusChange</span><span class="p">(</span><span class="n">status</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">this</span><span class="o">.</span><span class="n">setState</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">      <span class="n">isOnline</span><span class="p">:</span> <span class="n">status</span><span class="o">.</span><span class="n">isOnline</span>
</span></span><span class="line"><span class="cl">    <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="o">...</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯ä»¥å‘ç°è®¾ç½® <code>document.title</code> çš„é€»è¾‘æ˜¯å¦‚ä½•è¢«åˆ†å‰²åˆ° <code>componentDidMount</code> å’Œ <code>componentDidUpdate</code> ä¸­çš„ï¼Œè®¢é˜…é€»è¾‘åˆæ˜¯å¦‚ä½•è¢«åˆ†å‰²åˆ° <code>componentDidMount</code> å’Œ <code>componentWillUnmount</code> ä¸­çš„ã€‚è€Œä¸” <code>componentDidMount</code> ä¸­åŒæ—¶åŒ…å«äº†ä¸¤ä¸ªä¸åŒåŠŸèƒ½çš„ä»£ç ã€‚</p>
<p>é‚£ä¹ˆ Hook å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿå°±åƒ<a href="https://zh-hans.reactjs.org/docs/hooks-state.html#tip-using-multiple-state-variables" target="_blank" rel="noopener noreferrer">ä½ å¯ä»¥ä½¿ç”¨å¤šä¸ª <em>state</em> çš„ Hook</a> ä¸€æ ·ï¼Œä½ ä¹Ÿå¯ä»¥ä½¿ç”¨å¤šä¸ª effectã€‚è¿™ä¼šå°†ä¸ç›¸å…³é€»è¾‘åˆ†ç¦»åˆ°ä¸åŒçš„ effect ä¸­ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">FriendStatusWithCounter</span><span class="p">(</span><span class="n">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">count</span><span class="p">,</span> <span class="n">setCount</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>    <span class="n">document</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="err">`</span><span class="n">You</span> <span class="n">clicked</span> <span class="o">$</span><span class="p">{</span><span class="n">count</span><span class="p">}</span> <span class="n">times</span><span class="err">`</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">isOnline</span><span class="p">,</span> <span class="n">setIsOnline</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="n">null</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>    <span class="n">function</span> <span class="n">handleStatusChange</span><span class="p">(</span><span class="n">status</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">setIsOnline</span><span class="p">(</span><span class="n">status</span><span class="o">.</span><span class="n">isOnline</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">ChatAPI</span><span class="o">.</span><span class="n">subscribeToFriendStatus</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">friend</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">handleStatusChange</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">ChatAPI</span><span class="o">.</span><span class="n">unsubscribeFromFriendStatus</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">friend</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">handleStatusChange</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Hook å…è®¸æˆ‘ä»¬æŒ‰ç…§ä»£ç çš„ç”¨é€”åˆ†ç¦»ä»–ä»¬ï¼Œ</strong> è€Œä¸æ˜¯åƒç”Ÿå‘½å‘¨æœŸå‡½æ•°é‚£æ ·ã€‚React å°†æŒ‰ç…§ effect å£°æ˜çš„é¡ºåºä¾æ¬¡è°ƒç”¨ç»„ä»¶ä¸­çš„<em>æ¯ä¸€ä¸ª</em> effectã€‚</p>
<h6 id="è§£é‡Š-ä¸ºä»€ä¹ˆæ¯æ¬¡æ›´æ–°çš„æ—¶å€™éƒ½è¦è¿è¡Œ-effect" class="headerLink">
    <a href="#%e8%a7%a3%e9%87%8a-%e4%b8%ba%e4%bb%80%e4%b9%88%e6%af%8f%e6%ac%a1%e6%9b%b4%e6%96%b0%e7%9a%84%e6%97%b6%e5%80%99%e9%83%bd%e8%a6%81%e8%bf%90%e8%a1%8c-effect" class="header-mark"></a>è§£é‡Š: ä¸ºä»€ä¹ˆæ¯æ¬¡æ›´æ–°çš„æ—¶å€™éƒ½è¦è¿è¡Œ Effect</h6><p>å¦‚æœä½ å·²ç»ä¹ æƒ¯äº†ä½¿ç”¨ classï¼Œé‚£ä¹ˆä½ æˆ–è®¸ä¼šç–‘æƒ‘ä¸ºä»€ä¹ˆ effect çš„æ¸…é™¤é˜¶æ®µåœ¨æ¯æ¬¡é‡æ–°æ¸²æŸ“æ—¶éƒ½ä¼šæ‰§è¡Œï¼Œè€Œä¸æ˜¯åªåœ¨å¸è½½ç»„ä»¶çš„æ—¶å€™æ‰§è¡Œä¸€æ¬¡ã€‚è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªå®é™…çš„ä¾‹å­ï¼Œçœ‹çœ‹ä¸ºä»€ä¹ˆè¿™ä¸ªè®¾è®¡å¯ä»¥å¸®åŠ©æˆ‘ä»¬åˆ›å»º bug æ›´å°‘çš„ç»„ä»¶ã€‚</p>
<p>åœ¨<a href="https://zh-hans.reactjs.org/docs/hooks-effect.html#example-using-classes-1" target="_blank" rel="noopener noreferrer">æœ¬ç« èŠ‚å¼€å§‹æ—¶</a>ï¼Œæˆ‘ä»¬ä»‹ç»äº†ä¸€ä¸ªç”¨äºæ˜¾ç¤ºå¥½å‹æ˜¯å¦åœ¨çº¿çš„ <code>FriendStatus</code> ç»„ä»¶ã€‚ä» class ä¸­ props è¯»å– <code>friend.id</code>ï¼Œç„¶ååœ¨ç»„ä»¶æŒ‚è½½åè®¢é˜…å¥½å‹çš„çŠ¶æ€ï¼Œå¹¶åœ¨å¸è½½ç»„ä»¶çš„æ—¶å€™å–æ¶ˆè®¢é˜…ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">  componentDidMount() {
</span></span><span class="line"><span class="cl">    ChatAPI.subscribeToFriendStatus(
</span></span><span class="line"><span class="cl">      this.props.friend.id,
</span></span><span class="line"><span class="cl">      this.handleStatusChange
</span></span><span class="line"><span class="cl">    );
</span></span><span class="line"><span class="cl">  }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  componentWillUnmount() {
</span></span><span class="line"><span class="cl">    ChatAPI.unsubscribeFromFriendStatus(
</span></span><span class="line"><span class="cl">      this.props.friend.id,
</span></span><span class="line"><span class="cl">      this.handleStatusChange
</span></span><span class="line"><span class="cl">    );
</span></span><span class="line"><span class="cl">  }
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ä½†æ˜¯å½“ç»„ä»¶å·²ç»æ˜¾ç¤ºåœ¨å±å¹•ä¸Šæ—¶ï¼Œ<code>friend</code> prop å‘ç”Ÿå˜åŒ–æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</strong> æˆ‘ä»¬çš„ç»„ä»¶å°†ç»§ç»­å±•ç¤ºåŸæ¥çš„å¥½å‹çŠ¶æ€ã€‚è¿™æ˜¯ä¸€ä¸ª bugã€‚è€Œä¸”æˆ‘ä»¬è¿˜ä¼šå› ä¸ºå–æ¶ˆè®¢é˜…æ—¶ä½¿ç”¨é”™è¯¯çš„å¥½å‹ ID å¯¼è‡´å†…å­˜æ³„éœ²æˆ–å´©æºƒçš„é—®é¢˜ã€‚</p>
<p>åœ¨ class ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ  <code>componentDidUpdate</code> æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">  componentDidMount() {
</span></span><span class="line"><span class="cl">    ChatAPI.subscribeToFriendStatus(
</span></span><span class="line"><span class="cl">      this.props.friend.id,
</span></span><span class="line"><span class="cl">      this.handleStatusChange
</span></span><span class="line"><span class="cl">    );
</span></span><span class="line"><span class="cl">  }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  componentDidUpdate(prevProps) {    // å–æ¶ˆè®¢é˜…ä¹‹å‰çš„ friend.id    ChatAPI.unsubscribeFromFriendStatus(      prevProps.friend.id,      this.handleStatusChange    );    // è®¢é˜…æ–°çš„ friend.id    ChatAPI.subscribeToFriendStatus(      this.props.friend.id,      this.handleStatusChange    );  }
</span></span><span class="line"><span class="cl">  componentWillUnmount() {
</span></span><span class="line"><span class="cl">    ChatAPI.unsubscribeFromFriendStatus(
</span></span><span class="line"><span class="cl">      this.props.friend.id,
</span></span><span class="line"><span class="cl">      this.handleStatusChange
</span></span><span class="line"><span class="cl">    );
</span></span><span class="line"><span class="cl">  }
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¿˜è®°æ­£ç¡®åœ°å¤„ç† <code>componentDidUpdate</code> æ˜¯ React åº”ç”¨ä¸­å¸¸è§çš„ bug æ¥æºã€‚</p>
<p>ç°åœ¨çœ‹ä¸€ä¸‹ä½¿ç”¨ Hook çš„ç‰ˆæœ¬ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">function FriendStatus(props) {
</span></span><span class="line"><span class="cl">  // ...
</span></span><span class="line"><span class="cl">  useEffect(() =&gt; {
</span></span><span class="line"><span class="cl">    // ...
</span></span><span class="line"><span class="cl">    ChatAPI.subscribeToFriendStatus(props.friend.id, handleStatusChange);
</span></span><span class="line"><span class="cl">    return () =&gt; {
</span></span><span class="line"><span class="cl">      ChatAPI.unsubscribeFromFriendStatus(props.friend.id, handleStatusChange);
</span></span><span class="line"><span class="cl">    };
</span></span><span class="line"><span class="cl">  });
</span></span></code></pre></td></tr></table>
</div>
</div><p>å®ƒå¹¶ä¸ä¼šå—åˆ°æ­¤ bug å½±å“ã€‚(è™½ç„¶æˆ‘ä»¬æ²¡æœ‰å¯¹å®ƒåšä»»ä½•æ”¹åŠ¨ã€‚)</p>
<p>å¹¶ä¸éœ€è¦ç‰¹å®šçš„ä»£ç æ¥å¤„ç†æ›´æ–°é€»è¾‘ï¼Œå› ä¸º <code>useEffect</code> <em>é»˜è®¤</em>å°±ä¼šå¤„ç†ã€‚å®ƒä¼šåœ¨è°ƒç”¨ä¸€ä¸ªæ–°çš„ effect ä¹‹å‰å¯¹å‰ä¸€ä¸ª effect è¿›è¡Œæ¸…ç†ã€‚ä¸ºäº†è¯´æ˜è¿™ä¸€ç‚¹ï¼Œä¸‹é¢æŒ‰æ—¶é—´åˆ—å‡ºä¸€ä¸ªå¯èƒ½ä¼šäº§ç”Ÿçš„è®¢é˜…å’Œå–æ¶ˆè®¢é˜…æ“ä½œè°ƒç”¨åºåˆ—ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">// Mount with { friend: { id: 100 } } props
</span></span><span class="line"><span class="cl">ChatAPI.subscribeToFriendStatus(100, handleStatusChange);     // è¿è¡Œç¬¬ä¸€ä¸ª effect
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// Update with { friend: { id: 200 } } props
</span></span><span class="line"><span class="cl">ChatAPI.unsubscribeFromFriendStatus(100, handleStatusChange); // æ¸…é™¤ä¸Šä¸€ä¸ª effect
</span></span><span class="line"><span class="cl">ChatAPI.subscribeToFriendStatus(200, handleStatusChange);     // è¿è¡Œä¸‹ä¸€ä¸ª effect
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// Update with { friend: { id: 300 } } props
</span></span><span class="line"><span class="cl">ChatAPI.unsubscribeFromFriendStatus(200, handleStatusChange); // æ¸…é™¤ä¸Šä¸€ä¸ª effect
</span></span><span class="line"><span class="cl">ChatAPI.subscribeToFriendStatus(300, handleStatusChange);     // è¿è¡Œä¸‹ä¸€ä¸ª effect
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// Unmount
</span></span><span class="line"><span class="cl">ChatAPI.unsubscribeFromFriendStatus(300, handleStatusChange); // æ¸…é™¤æœ€åä¸€ä¸ª effect
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ­¤é»˜è®¤è¡Œä¸ºä¿è¯äº†ä¸€è‡´æ€§ï¼Œé¿å…äº†åœ¨ class ç»„ä»¶ä¸­å› ä¸ºæ²¡æœ‰å¤„ç†æ›´æ–°é€»è¾‘è€Œå¯¼è‡´å¸¸è§çš„ bugã€‚</p>
<h6 id="æç¤º-é€šè¿‡è·³è¿‡-effect-è¿›è¡Œæ€§èƒ½ä¼˜åŒ–" class="headerLink">
    <a href="#%e6%8f%90%e7%a4%ba-%e9%80%9a%e8%bf%87%e8%b7%b3%e8%bf%87-effect-%e8%bf%9b%e8%a1%8c%e6%80%a7%e8%83%bd%e4%bc%98%e5%8c%96" class="header-mark"></a>æç¤º: é€šè¿‡è·³è¿‡ Effect è¿›è¡Œæ€§èƒ½ä¼˜åŒ–</h6><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ¯æ¬¡æ¸²æŸ“åéƒ½æ‰§è¡Œæ¸…ç†æˆ–è€…æ‰§è¡Œ effect å¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ã€‚åœ¨ class ç»„ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ <code>componentDidUpdate</code> ä¸­æ·»åŠ å¯¹ <code>prevProps</code> æˆ– <code>prevState</code> çš„æ¯”è¾ƒé€»è¾‘è§£å†³ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">componentDidUpdate(prevProps, prevState) {
</span></span><span class="line"><span class="cl">  if (prevState.count !== this.state.count) {
</span></span><span class="line"><span class="cl">    document.title = `You clicked ${this.state.count} times`;
</span></span><span class="line"><span class="cl">  }
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿™æ˜¯å¾ˆå¸¸è§çš„éœ€æ±‚ï¼Œæ‰€ä»¥å®ƒè¢«å†…ç½®åˆ°äº† <code>useEffect</code> çš„ Hook API ä¸­ã€‚å¦‚æœæŸäº›ç‰¹å®šå€¼åœ¨ä¸¤æ¬¡é‡æ¸²æŸ“ä¹‹é—´æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œä½ å¯ä»¥é€šçŸ¥ React <strong>è·³è¿‡</strong>å¯¹ effect çš„è°ƒç”¨ï¼Œåªè¦ä¼ é€’æ•°ç»„ä½œä¸º <code>useEffect</code> çš„ç¬¬äºŒä¸ªå¯é€‰å‚æ•°å³å¯ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">useEffect(() =&gt; {
</span></span><span class="line"><span class="cl">  document.title = `You clicked ${count} times`;
</span></span><span class="line"><span class="cl">}, [count]); // ä»…åœ¨ count æ›´æ”¹æ—¶æ›´æ–°
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸Šé¢è¿™ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¼ å…¥ <code>[count]</code> ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ã€‚è¿™ä¸ªå‚æ•°æ˜¯ä»€ä¹ˆä½œç”¨å‘¢ï¼Ÿå¦‚æœ <code>count</code> çš„å€¼æ˜¯ <code>5</code>ï¼Œè€Œä¸”æˆ‘ä»¬çš„ç»„ä»¶é‡æ¸²æŸ“çš„æ—¶å€™ <code>count</code> è¿˜æ˜¯ç­‰äº <code>5</code>ï¼ŒReact å°†å¯¹å‰ä¸€æ¬¡æ¸²æŸ“çš„ <code>[5]</code> å’Œåä¸€æ¬¡æ¸²æŸ“çš„ <code>[5]</code> è¿›è¡Œæ¯”è¾ƒã€‚å› ä¸ºæ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½æ˜¯ç›¸ç­‰çš„(<code>5 === 5</code>)ï¼ŒReact ä¼šè·³è¿‡è¿™ä¸ª effectï¼Œè¿™å°±å®ç°äº†æ€§èƒ½çš„ä¼˜åŒ–ã€‚</p>
<p>å½“æ¸²æŸ“æ—¶ï¼Œå¦‚æœ <code>count</code> çš„å€¼æ›´æ–°æˆäº† <code>6</code>ï¼ŒReact å°†ä¼šæŠŠå‰ä¸€æ¬¡æ¸²æŸ“æ—¶çš„æ•°ç»„ <code>[5]</code> å’Œè¿™æ¬¡æ¸²æŸ“çš„æ•°ç»„ <code>[6]</code> ä¸­çš„å…ƒç´ è¿›è¡Œå¯¹æ¯”ã€‚è¿™æ¬¡å› ä¸º <code>5 !== 6</code>ï¼ŒReact å°±ä¼šå†æ¬¡è°ƒç”¨ effectã€‚å¦‚æœæ•°ç»„ä¸­æœ‰å¤šä¸ªå…ƒç´ ï¼Œå³ä½¿åªæœ‰ä¸€ä¸ªå…ƒç´ å‘ç”Ÿå˜åŒ–ï¼ŒReact ä¹Ÿä¼šæ‰§è¡Œ effectã€‚</p>
<p>å¯¹äºæœ‰æ¸…é™¤æ“ä½œçš„ effect åŒæ ·é€‚ç”¨ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">useEffect(() =&gt; {
</span></span><span class="line"><span class="cl">  function handleStatusChange(status) {
</span></span><span class="line"><span class="cl">    setIsOnline(status.isOnline);
</span></span><span class="line"><span class="cl">  }
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  ChatAPI.subscribeToFriendStatus(props.friend.id, handleStatusChange);
</span></span><span class="line"><span class="cl">  return () =&gt; {
</span></span><span class="line"><span class="cl">    ChatAPI.unsubscribeFromFriendStatus(props.friend.id, handleStatusChange);
</span></span><span class="line"><span class="cl">  };
</span></span><span class="line"><span class="cl">}, [props.friend.id]); // ä»…åœ¨ props.friend.id å‘ç”Ÿå˜åŒ–æ—¶ï¼Œé‡æ–°è®¢é˜…
</span></span></code></pre></td></tr></table>
</div>
</div><p>æœªæ¥ç‰ˆæœ¬ï¼Œå¯èƒ½ä¼šåœ¨æ„å»ºæ—¶è‡ªåŠ¨æ·»åŠ ç¬¬äºŒä¸ªå‚æ•°ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼š</p>
<p>å¦‚æœä½ è¦ä½¿ç”¨æ­¤ä¼˜åŒ–æ–¹å¼ï¼Œè¯·ç¡®ä¿æ•°ç»„ä¸­åŒ…å«äº†<strong>æ‰€æœ‰å¤–éƒ¨ä½œç”¨åŸŸä¸­ä¼šéšæ—¶é—´å˜åŒ–å¹¶ä¸”åœ¨ effect ä¸­ä½¿ç”¨çš„å˜é‡</strong>ï¼Œå¦åˆ™ä½ çš„ä»£ç ä¼šå¼•ç”¨åˆ°å…ˆå‰æ¸²æŸ“ä¸­çš„æ—§å˜é‡ã€‚å‚é˜…æ–‡æ¡£ï¼Œäº†è§£æ›´å¤šå…³äº<a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#is-it-safe-to-omit-functions-from-the-list-of-dependencies" target="_blank" rel="noopener noreferrer">å¦‚ä½•å¤„ç†å‡½æ•°</a>ä»¥åŠ<a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#what-can-i-do-if-my-effect-dependencies-change-too-often" target="_blank" rel="noopener noreferrer">æ•°ç»„é¢‘ç¹å˜åŒ–æ—¶çš„æªæ–½</a>å†…å®¹ã€‚</p>
<p>å¦‚æœæƒ³æ‰§è¡Œåªè¿è¡Œä¸€æ¬¡çš„ effectï¼ˆä»…åœ¨ç»„ä»¶æŒ‚è½½å’Œå¸è½½æ—¶æ‰§è¡Œï¼‰ï¼Œå¯ä»¥ä¼ é€’ä¸€ä¸ªç©ºæ•°ç»„ï¼ˆ<code>[]</code>ï¼‰ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ã€‚è¿™å°±å‘Šè¯‰ React ä½ çš„ effect ä¸ä¾èµ–äº props æˆ– state ä¸­çš„ä»»ä½•å€¼ï¼Œæ‰€ä»¥å®ƒæ°¸è¿œéƒ½ä¸éœ€è¦é‡å¤æ‰§è¡Œã€‚è¿™å¹¶ä¸å±äºç‰¹æ®Šæƒ…å†µ â€”â€” å®ƒä¾ç„¶éµå¾ªä¾èµ–æ•°ç»„çš„å·¥ä½œæ–¹å¼ã€‚</p>
<p>å¦‚æœä½ ä¼ å…¥äº†ä¸€ä¸ªç©ºæ•°ç»„ï¼ˆ<code>[]</code>ï¼‰ï¼Œeffect å†…éƒ¨çš„ props å’Œ state å°±ä¼šä¸€ç›´æ‹¥æœ‰å…¶åˆå§‹å€¼ã€‚å°½ç®¡ä¼ å…¥ <code>[]</code> ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°æ›´æ¥è¿‘å¤§å®¶æ›´ç†Ÿæ‚‰çš„ <code>componentDidMount</code> å’Œ <code>componentWillUnmount</code> æ€ç»´æ¨¡å¼ï¼Œä½†æˆ‘ä»¬æœ‰<a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#is-it-safe-to-omit-functions-from-the-list-of-dependencies" target="_blank" rel="noopener noreferrer">æ›´å¥½çš„</a><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#what-can-i-do-if-my-effect-dependencies-change-too-often" target="_blank" rel="noopener noreferrer">æ–¹å¼</a>æ¥é¿å…è¿‡äºé¢‘ç¹çš„é‡å¤è°ƒç”¨ effectã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¯·è®°å¾— React ä¼šç­‰å¾…æµè§ˆå™¨å®Œæˆç”»é¢æ¸²æŸ“ä¹‹åæ‰ä¼šå»¶è¿Ÿè°ƒç”¨ <code>useEffect</code>ï¼Œå› æ­¤ä¼šä½¿å¾—é¢å¤–æ“ä½œå¾ˆæ–¹ä¾¿ã€‚</p>
<p>æˆ‘ä»¬æ¨èå¯ç”¨ <a href="https://www.npmjs.com/package/eslint-plugin-react-hooks#installation" target="_blank" rel="noopener noreferrer"><code>eslint-plugin-react-hooks</code></a> ä¸­çš„ <a href="https://github.com/facebook/react/issues/14920" target="_blank" rel="noopener noreferrer"><code>exhaustive-deps</code></a> è§„åˆ™ã€‚æ­¤è§„åˆ™ä¼šåœ¨æ·»åŠ é”™è¯¯ä¾èµ–æ—¶å‘å‡ºè­¦å‘Šå¹¶ç»™å‡ºä¿®å¤å»ºè®®ã€‚</p>
</blockquote>
<h4 id="hook-è§„åˆ™" class="headerLink">
    <a href="#hook-%e8%a7%84%e5%88%99" class="header-mark"></a>Hook è§„åˆ™</h4><p><em>Hook</em> æ˜¯ React 16.8 çš„æ–°å¢ç‰¹æ€§ã€‚å®ƒå¯ä»¥è®©ä½ åœ¨ä¸ç¼–å†™ class çš„æƒ…å†µä¸‹ä½¿ç”¨ state ä»¥åŠå…¶ä»–çš„ React ç‰¹æ€§ã€‚</p>
<p>Hook æœ¬è´¨å°±æ˜¯ JavaScript å‡½æ•°ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨å®ƒæ—¶éœ€è¦éµå¾ªä¸¤æ¡è§„åˆ™ã€‚æˆ‘ä»¬æä¾›äº†ä¸€ä¸ª <a href="https://www.npmjs.com/package/eslint-plugin-react-hooks" target="_blank" rel="noopener noreferrer">linter æ’ä»¶</a>æ¥å¼ºåˆ¶æ‰§è¡Œè¿™äº›è§„åˆ™ï¼š</p>
<h6 id="åªåœ¨æœ€é¡¶å±‚ä½¿ç”¨-hook" class="headerLink">
    <a href="#%e5%8f%aa%e5%9c%a8%e6%9c%80%e9%a1%b6%e5%b1%82%e4%bd%bf%e7%94%a8-hook" class="header-mark"></a>åªåœ¨æœ€é¡¶å±‚ä½¿ç”¨ Hook</h6><p><strong>ä¸è¦åœ¨å¾ªç¯ï¼Œæ¡ä»¶æˆ–åµŒå¥—å‡½æ•°ä¸­è°ƒç”¨ Hookï¼Œ</strong> ç¡®ä¿æ€»æ˜¯åœ¨ä½ çš„ React å‡½æ•°çš„æœ€é¡¶å±‚ä»¥åŠä»»ä½• return ä¹‹å‰è°ƒç”¨ä»–ä»¬ã€‚éµå®ˆè¿™æ¡è§„åˆ™ï¼Œä½ å°±èƒ½ç¡®ä¿ Hook åœ¨æ¯ä¸€æ¬¡æ¸²æŸ“ä¸­éƒ½æŒ‰ç…§åŒæ ·çš„é¡ºåºè¢«è°ƒç”¨ã€‚è¿™è®© React èƒ½å¤Ÿåœ¨å¤šæ¬¡çš„ <code>useState</code> å’Œ <code>useEffect</code> è°ƒç”¨ä¹‹é—´ä¿æŒ hook çŠ¶æ€çš„æ­£ç¡®ã€‚(å¦‚æœä½ å¯¹æ­¤æ„Ÿåˆ°å¥½å¥‡ï¼Œæˆ‘ä»¬åœ¨<a href="https://zh-hans.reactjs.org/docs/hooks-rules.html#explanation" target="_blank" rel="noopener noreferrer">ä¸‹é¢</a>ä¼šæœ‰æ›´æ·±å…¥çš„è§£é‡Šã€‚)</p>
<h6 id="åªåœ¨-react-å‡½æ•°ä¸­è°ƒç”¨-hook" class="headerLink">
    <a href="#%e5%8f%aa%e5%9c%a8-react-%e5%87%bd%e6%95%b0%e4%b8%ad%e8%b0%83%e7%94%a8-hook" class="header-mark"></a>åªåœ¨ React å‡½æ•°ä¸­è°ƒç”¨ Hook</h6><p>**ä¸è¦åœ¨æ™®é€šçš„ JavaScript å‡½æ•°ä¸­è°ƒç”¨ Hookã€‚**ä½ å¯ä»¥ï¼š</p>
<ul>
<li>âœ… åœ¨ React çš„å‡½æ•°ç»„ä»¶ä¸­è°ƒç”¨ Hook</li>
<li>âœ… åœ¨è‡ªå®šä¹‰ Hook ä¸­è°ƒç”¨å…¶ä»– Hook (æˆ‘ä»¬å°†ä¼šåœ¨<a href="https://zh-hans.reactjs.org/docs/hooks-custom.html" target="_blank" rel="noopener noreferrer">ä¸‹ä¸€é¡µ</a> ä¸­å­¦ä¹ è¿™ä¸ªã€‚)</li>
</ul>
<p>éµå¾ªæ­¤è§„åˆ™ï¼Œç¡®ä¿ç»„ä»¶çš„çŠ¶æ€é€»è¾‘åœ¨ä»£ç ä¸­æ¸…æ™°å¯è§ã€‚</p>
<h5 id="eslint-æ’ä»¶" class="headerLink">
    <a href="#eslint-%e6%8f%92%e4%bb%b6" class="header-mark"></a>ESLint æ’ä»¶</h5><p>æˆ‘ä»¬å‘å¸ƒäº†ä¸€ä¸ªåä¸º <a href="https://www.npmjs.com/package/eslint-plugin-react-hooks" target="_blank" rel="noopener noreferrer"><code>eslint-plugin-react-hooks</code></a> çš„ ESLint æ’ä»¶æ¥å¼ºåˆ¶æ‰§è¡Œè¿™ä¸¤æ¡è§„åˆ™ã€‚å¦‚æœä½ æƒ³å°è¯•ä¸€ä¸‹ï¼Œå¯ä»¥å°†æ­¤æ’ä»¶æ·»åŠ åˆ°ä½ çš„é¡¹ç›®ä¸­ï¼š</p>
<p>æˆ‘ä»¬æ‰“ç®—åç»­ç‰ˆæœ¬é»˜è®¤æ·»åŠ æ­¤æ’ä»¶åˆ° <a href="https://zh-hans.reactjs.org/docs/create-a-new-react-app.html#create-react-app" target="_blank" rel="noopener noreferrer">Create React App</a> åŠå…¶ä»–ç±»ä¼¼çš„å·¥å…·åŒ…ä¸­ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">npm install eslint-plugin-react-hooks --save-dev
</span></span><span class="line"><span class="cl">// ä½ çš„ ESLint é…ç½®
</span></span><span class="line"><span class="cl">{
</span></span><span class="line"><span class="cl">  &#34;plugins&#34;: [
</span></span><span class="line"><span class="cl">    // ...
</span></span><span class="line"><span class="cl">    &#34;react-hooks&#34;
</span></span><span class="line"><span class="cl">  ],
</span></span><span class="line"><span class="cl">  &#34;rules&#34;: {
</span></span><span class="line"><span class="cl">    // ...
</span></span><span class="line"><span class="cl">    &#34;react-hooks/rules-of-hooks&#34;: &#34;error&#34;, // æ£€æŸ¥ Hook çš„è§„åˆ™
</span></span><span class="line"><span class="cl">    &#34;react-hooks/exhaustive-deps&#34;: &#34;warn&#34; // æ£€æŸ¥ effect çš„ä¾èµ–
</span></span><span class="line"><span class="cl">  }
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>**ç°åœ¨ä½ å¯ä»¥è·³è½¬åˆ°ä¸‹ä¸€ç« èŠ‚å­¦ä¹ å¦‚ä½•ç¼–å†™<a href="https://zh-hans.reactjs.org/docs/hooks-custom.html" target="_blank" rel="noopener noreferrer">ä½ è‡ªå·±çš„ Hook</a>ã€‚**åœ¨æœ¬ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ç»§ç»­è§£é‡Šè¿™äº›è§„åˆ™èƒŒåçš„åŸå› ã€‚</p>
<h5 id="è¯´æ˜" class="headerLink">
    <a href="#%e8%af%b4%e6%98%8e" class="header-mark"></a>è¯´æ˜</h5><p>æ­£å¦‚æˆ‘ä»¬<a href="https://zh-hans.reactjs.org/docs/hooks-state.html#tip-using-multiple-state-variables" target="_blank" rel="noopener noreferrer">ä¹‹å‰å­¦åˆ°</a>çš„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å•ä¸ªç»„ä»¶ä¸­ä½¿ç”¨å¤šä¸ª State Hook æˆ– Effect Hookï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">Form</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="mf">1.</span> <span class="n">Use</span> <span class="n">the</span> <span class="n">name</span> <span class="n">state</span> <span class="n">variable</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">name</span><span class="p">,</span> <span class="n">setName</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="s1">&#39;Mary&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="mf">2.</span> <span class="n">Use</span> <span class="n">an</span> <span class="n">effect</span> <span class="k">for</span> <span class="n">persisting</span> <span class="n">the</span> <span class="n">form</span>
</span></span><span class="line"><span class="cl">  <span class="n">useEffect</span><span class="p">(</span><span class="n">function</span> <span class="n">persistForm</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">localStorage</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="s1">&#39;formData&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="mf">3.</span> <span class="n">Use</span> <span class="n">the</span> <span class="n">surname</span> <span class="n">state</span> <span class="n">variable</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">surname</span><span class="p">,</span> <span class="n">setSurname</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="s1">&#39;Poppins&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="mf">4.</span> <span class="n">Use</span> <span class="n">an</span> <span class="n">effect</span> <span class="k">for</span> <span class="n">updating</span> <span class="n">the</span> <span class="n">title</span>
</span></span><span class="line"><span class="cl">  <span class="n">useEffect</span><span class="p">(</span><span class="n">function</span> <span class="n">updateTitle</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">document</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span> <span class="o">+</span> <span class="n">surname</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>é‚£ä¹ˆ React æ€ä¹ˆçŸ¥é“å“ªä¸ª state å¯¹åº”å“ªä¸ª <code>useState</code>ï¼Ÿç­”æ¡ˆæ˜¯ React é çš„æ˜¯ Hook è°ƒç”¨çš„é¡ºåºã€‚å› ä¸ºæˆ‘ä»¬çš„ç¤ºä¾‹ä¸­ï¼ŒHook çš„è°ƒç”¨é¡ºåºåœ¨æ¯æ¬¡æ¸²æŸ“ä¸­éƒ½æ˜¯ç›¸åŒçš„ï¼Œæ‰€ä»¥å®ƒèƒ½å¤Ÿæ­£å¸¸å·¥ä½œï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">// ------------
</span></span><span class="line"><span class="cl">// é¦–æ¬¡æ¸²æŸ“
</span></span><span class="line"><span class="cl">// ------------
</span></span><span class="line"><span class="cl">useState(&#39;Mary&#39;)           // 1. ä½¿ç”¨ &#39;Mary&#39; åˆå§‹åŒ–å˜é‡åä¸º name çš„ state
</span></span><span class="line"><span class="cl">useEffect(persistForm)     // 2. æ·»åŠ  effect ä»¥ä¿å­˜ form æ“ä½œ
</span></span><span class="line"><span class="cl">useState(&#39;Poppins&#39;)        // 3. ä½¿ç”¨ &#39;Poppins&#39; åˆå§‹åŒ–å˜é‡åä¸º surname çš„ state
</span></span><span class="line"><span class="cl">useEffect(updateTitle)     // 4. æ·»åŠ  effect ä»¥æ›´æ–°æ ‡é¢˜
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// -------------
</span></span><span class="line"><span class="cl">// äºŒæ¬¡æ¸²æŸ“
</span></span><span class="line"><span class="cl">// -------------
</span></span><span class="line"><span class="cl">useState(&#39;Mary&#39;)           // 1. è¯»å–å˜é‡åä¸º name çš„ stateï¼ˆå‚æ•°è¢«å¿½ç•¥ï¼‰
</span></span><span class="line"><span class="cl">useEffect(persistForm)     // 2. æ›¿æ¢ä¿å­˜ form çš„ effect
</span></span><span class="line"><span class="cl">useState(&#39;Poppins&#39;)        // 3. è¯»å–å˜é‡åä¸º surname çš„ stateï¼ˆå‚æ•°è¢«å¿½ç•¥ï¼‰
</span></span><span class="line"><span class="cl">useEffect(updateTitle)     // 4. æ›¿æ¢æ›´æ–°æ ‡é¢˜çš„ effect
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">// ...
</span></span></code></pre></td></tr></table>
</div>
</div><p>åªè¦ Hook çš„è°ƒç”¨é¡ºåºåœ¨å¤šæ¬¡æ¸²æŸ“ä¹‹é—´ä¿æŒä¸€è‡´ï¼ŒReact å°±èƒ½æ­£ç¡®åœ°å°†å†…éƒ¨ state å’Œå¯¹åº”çš„ Hook è¿›è¡Œå…³è”ã€‚ä½†å¦‚æœæˆ‘ä»¬å°†ä¸€ä¸ª Hook (ä¾‹å¦‚ <code>persistForm</code> effect) è°ƒç”¨æ”¾åˆ°ä¸€ä¸ªæ¡ä»¶è¯­å¥ä¸­ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">  // ğŸ”´ åœ¨æ¡ä»¶è¯­å¥ä¸­ä½¿ç”¨ Hook è¿åç¬¬ä¸€æ¡è§„åˆ™
</span></span><span class="line"><span class="cl">  if (name !== &#39;&#39;) {
</span></span><span class="line"><span class="cl">    useEffect(function persistForm() {
</span></span><span class="line"><span class="cl">      localStorage.setItem(&#39;formData&#39;, name);
</span></span><span class="line"><span class="cl">    });
</span></span><span class="line"><span class="cl">  }
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“ä¸­ <code>name !== ''</code> è¿™ä¸ªæ¡ä»¶å€¼ä¸º <code>true</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šæ‰§è¡Œè¿™ä¸ª Hookã€‚ä½†æ˜¯ä¸‹ä¸€æ¬¡æ¸²æŸ“æ—¶æˆ‘ä»¬å¯èƒ½æ¸…ç©ºäº†è¡¨å•ï¼Œè¡¨è¾¾å¼å€¼å˜ä¸º <code>false</code>ã€‚æ­¤æ—¶çš„æ¸²æŸ“ä¼šè·³è¿‡è¯¥ Hookï¼ŒHook çš„è°ƒç”¨é¡ºåºå‘ç”Ÿäº†æ”¹å˜ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">useState(&#39;Mary&#39;)           // 1. è¯»å–å˜é‡åä¸º name çš„ stateï¼ˆå‚æ•°è¢«å¿½ç•¥ï¼‰
</span></span><span class="line"><span class="cl">// useEffect(persistForm)  // ğŸ”´ æ­¤ Hook è¢«å¿½ç•¥ï¼
</span></span><span class="line"><span class="cl">useState(&#39;Poppins&#39;)        // ğŸ”´ 2 ï¼ˆä¹‹å‰ä¸º 3ï¼‰ã€‚è¯»å–å˜é‡åä¸º surname çš„ state å¤±è´¥
</span></span><span class="line"><span class="cl">useEffect(updateTitle)     // ğŸ”´ 3 ï¼ˆä¹‹å‰ä¸º 4ï¼‰ã€‚æ›¿æ¢æ›´æ–°æ ‡é¢˜çš„ effect å¤±è´¥
</span></span></code></pre></td></tr></table>
</div>
</div><p>React ä¸çŸ¥é“ç¬¬äºŒä¸ª <code>useState</code> çš„ Hook åº”è¯¥è¿”å›ä»€ä¹ˆã€‚React ä¼šä»¥ä¸ºåœ¨è¯¥ç»„ä»¶ä¸­ç¬¬äºŒä¸ª Hook çš„è°ƒç”¨åƒä¸Šæ¬¡çš„æ¸²æŸ“ä¸€æ ·ï¼Œå¯¹åº”çš„æ˜¯ <code>persistForm</code> çš„ effectï¼Œä½†å¹¶éå¦‚æ­¤ã€‚ä»è¿™é‡Œå¼€å§‹ï¼Œåé¢çš„ Hook è°ƒç”¨éƒ½è¢«æå‰æ‰§è¡Œï¼Œå¯¼è‡´ bug çš„äº§ç”Ÿã€‚</p>
<p>**è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ Hook éœ€è¦åœ¨æˆ‘ä»¬ç»„ä»¶çš„æœ€é¡¶å±‚è°ƒç”¨ã€‚**å¦‚æœæˆ‘ä»¬æƒ³è¦æœ‰æ¡ä»¶åœ°æ‰§è¡Œä¸€ä¸ª effectï¼Œå¯ä»¥å°†åˆ¤æ–­æ”¾åˆ° Hook çš„<em>å†…éƒ¨</em>ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">  useEffect(function persistForm() {
</span></span><span class="line"><span class="cl">    // ğŸ‘ å°†æ¡ä»¶åˆ¤æ–­æ”¾ç½®åœ¨ effect ä¸­
</span></span><span class="line"><span class="cl">    if (name !== &#39;&#39;) {
</span></span><span class="line"><span class="cl">      localStorage.setItem(&#39;formData&#39;, name);
</span></span><span class="line"><span class="cl">    }
</span></span><span class="line"><span class="cl">  });
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>æ³¨æ„ï¼šå¦‚æœä½¿ç”¨äº†<a href="https://www.npmjs.com/package/eslint-plugin-react-hooks" target="_blank" rel="noopener noreferrer">æä¾›çš„ lint æ’ä»¶</a>ï¼Œå°±æ— éœ€æ‹…å¿ƒæ­¤é—®é¢˜ã€‚</strong> ä¸è¿‡ä½ ç°åœ¨çŸ¥é“äº†ä¸ºä»€ä¹ˆ Hook ä¼šè¿™æ ·å·¥ä½œï¼Œä¹ŸçŸ¥é“äº†è¿™ä¸ªè§„åˆ™æ˜¯ä¸ºäº†é¿å…ä»€ä¹ˆé—®é¢˜ã€‚</p>
<h4 id="è‡ªå®šä¹‰-hook" class="headerLink">
    <a href="#%e8%87%aa%e5%ae%9a%e4%b9%89-hook" class="header-mark"></a>è‡ªå®šä¹‰ Hook</h4><p><em>Hook</em> æ˜¯ React 16.8 çš„æ–°å¢ç‰¹æ€§ã€‚å®ƒå¯ä»¥è®©ä½ åœ¨ä¸ç¼–å†™ class çš„æƒ…å†µä¸‹ä½¿ç”¨ state ä»¥åŠå…¶ä»–çš„ React ç‰¹æ€§ã€‚</p>
<p>é€šè¿‡è‡ªå®šä¹‰ Hookï¼Œå¯ä»¥å°†ç»„ä»¶é€»è¾‘æå–åˆ°å¯é‡ç”¨çš„å‡½æ•°ä¸­ã€‚</p>
<p>åœ¨æˆ‘ä»¬å­¦ä¹ <a href="https://zh-hans.reactjs.org/docs/hooks-effect.html#example-using-hooks-1" target="_blank" rel="noopener noreferrer">ä½¿ç”¨ Effect Hook</a> æ—¶ï¼Œæˆ‘ä»¬å·²ç»è§è¿‡è¿™ä¸ªèŠå¤©ç¨‹åºä¸­çš„ç»„ä»¶ï¼Œè¯¥ç»„ä»¶ç”¨äºæ˜¾ç¤ºå¥½å‹çš„åœ¨çº¿çŠ¶æ€ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">import</span> <span class="n">React</span><span class="p">,</span> <span class="p">{</span> <span class="n">useState</span><span class="p">,</span> <span class="n">useEffect</span> <span class="p">}</span> <span class="n">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">FriendStatus</span><span class="p">(</span><span class="n">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">isOnline</span><span class="p">,</span> <span class="n">setIsOnline</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="n">null</span><span class="p">);</span>  <span class="n">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>    <span class="n">function</span> <span class="n">handleStatusChange</span><span class="p">(</span><span class="n">status</span><span class="p">)</span> <span class="p">{</span>      <span class="n">setIsOnline</span><span class="p">(</span><span class="n">status</span><span class="o">.</span><span class="n">isOnline</span><span class="p">);</span>    <span class="p">}</span>    <span class="n">ChatAPI</span><span class="o">.</span><span class="n">subscribeToFriendStatus</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">friend</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">handleStatusChange</span><span class="p">);</span>    <span class="k">return</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>      <span class="n">ChatAPI</span><span class="o">.</span><span class="n">unsubscribeFromFriendStatus</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">friend</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">handleStatusChange</span><span class="p">);</span>    <span class="p">};</span>  <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">isOnline</span> <span class="o">===</span> <span class="n">null</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s1">&#39;Loading...&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">isOnline</span> <span class="err">?</span> <span class="s1">&#39;Online&#39;</span> <span class="p">:</span> <span class="s1">&#39;Offline&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç°åœ¨æˆ‘ä»¬å‡è®¾èŠå¤©åº”ç”¨ä¸­æœ‰ä¸€ä¸ªè”ç³»äººåˆ—è¡¨ï¼Œå½“ç”¨æˆ·åœ¨çº¿æ—¶éœ€è¦æŠŠåå­—è®¾ç½®ä¸ºç»¿è‰²ã€‚æˆ‘ä»¬å¯ä»¥æŠŠä¸Šé¢ç±»ä¼¼çš„é€»è¾‘å¤åˆ¶å¹¶ç²˜è´´åˆ° <code>FriendListItem</code> ç»„ä»¶ä¸­æ¥ï¼Œä½†è¿™å¹¶ä¸æ˜¯ç†æƒ³çš„è§£å†³æ–¹æ¡ˆï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">import</span> <span class="n">React</span><span class="p">,</span> <span class="p">{</span> <span class="n">useState</span><span class="p">,</span> <span class="n">useEffect</span> <span class="p">}</span> <span class="n">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">FriendListItem</span><span class="p">(</span><span class="n">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">isOnline</span><span class="p">,</span> <span class="n">setIsOnline</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="n">null</span><span class="p">);</span>  <span class="n">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>    <span class="n">function</span> <span class="n">handleStatusChange</span><span class="p">(</span><span class="n">status</span><span class="p">)</span> <span class="p">{</span>      <span class="n">setIsOnline</span><span class="p">(</span><span class="n">status</span><span class="o">.</span><span class="n">isOnline</span><span class="p">);</span>    <span class="p">}</span>    <span class="n">ChatAPI</span><span class="o">.</span><span class="n">subscribeToFriendStatus</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">friend</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">handleStatusChange</span><span class="p">);</span>    <span class="k">return</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>      <span class="n">ChatAPI</span><span class="o">.</span><span class="n">unsubscribeFromFriendStatus</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">friend</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">handleStatusChange</span><span class="p">);</span>    <span class="p">};</span>  <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">li</span> <span class="n">style</span><span class="o">=</span><span class="p">{{</span> <span class="n">color</span><span class="p">:</span> <span class="n">isOnline</span> <span class="err">?</span> <span class="s1">&#39;green&#39;</span> <span class="p">:</span> <span class="s1">&#39;black&#39;</span> <span class="p">}}</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span><span class="n">props</span><span class="o">.</span><span class="n">friend</span><span class="o">.</span><span class="n">name</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç›¸åï¼Œæˆ‘ä»¬å¸Œæœ›åœ¨ <code>FriendStatus</code> å’Œ <code>FriendListItem</code> ä¹‹é—´å…±äº«é€»è¾‘ã€‚</p>
<p>ç›®å‰ä¸ºæ­¢ï¼Œåœ¨ React ä¸­æœ‰ä¸¤ç§æµè¡Œçš„æ–¹å¼æ¥å…±äº«ç»„ä»¶ä¹‹é—´çš„çŠ¶æ€é€»è¾‘: <a href="https://zh-hans.reactjs.org/docs/render-props.html" target="_blank" rel="noopener noreferrer">render props</a> å’Œ<a href="https://zh-hans.reactjs.org/docs/higher-order-components.html" target="_blank" rel="noopener noreferrer">é«˜é˜¶ç»„ä»¶</a>ï¼Œç°åœ¨è®©æˆ‘ä»¬æ¥çœ‹çœ‹ Hook æ˜¯å¦‚ä½•åœ¨è®©ä½ ä¸å¢åŠ ç»„ä»¶çš„æƒ…å†µä¸‹è§£å†³ç›¸åŒé—®é¢˜çš„ã€‚</p>
<h5 id="æå–è‡ªå®šä¹‰-hook" class="headerLink">
    <a href="#%e6%8f%90%e5%8f%96%e8%87%aa%e5%ae%9a%e4%b9%89-hook" class="header-mark"></a>æå–è‡ªå®šä¹‰ Hook</h5><p>å½“æˆ‘ä»¬æƒ³åœ¨ä¸¤ä¸ªå‡½æ•°ä¹‹é—´å…±äº«é€»è¾‘æ—¶ï¼Œæˆ‘ä»¬ä¼šæŠŠå®ƒæå–åˆ°ç¬¬ä¸‰ä¸ªå‡½æ•°ä¸­ã€‚è€Œç»„ä»¶å’Œ Hook éƒ½æ˜¯å‡½æ•°ï¼Œæ‰€ä»¥ä¹ŸåŒæ ·é€‚ç”¨è¿™ç§æ–¹å¼ã€‚</p>
<p><strong>è‡ªå®šä¹‰ Hook æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå…¶åç§°ä»¥ â€œ<code>use</code>â€ å¼€å¤´ï¼Œå‡½æ•°å†…éƒ¨å¯ä»¥è°ƒç”¨å…¶ä»–çš„ Hookã€‚</strong> ä¾‹å¦‚ï¼Œä¸‹é¢çš„ <code>useFriendStatus</code> æ˜¯æˆ‘ä»¬ç¬¬ä¸€ä¸ªè‡ªå®šä¹‰çš„ Hook:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">import</span> <span class="p">{</span> <span class="n">useState</span><span class="p">,</span> <span class="n">useEffect</span> <span class="p">}</span> <span class="n">from</span> <span class="s1">&#39;react&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">useFriendStatus</span><span class="p">(</span><span class="n">friendID</span><span class="p">)</span> <span class="p">{</span>  <span class="k">const</span> <span class="p">[</span><span class="n">isOnline</span><span class="p">,</span> <span class="n">setIsOnline</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="n">null</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">function</span> <span class="n">handleStatusChange</span><span class="p">(</span><span class="n">status</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">setIsOnline</span><span class="p">(</span><span class="n">status</span><span class="o">.</span><span class="n">isOnline</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">ChatAPI</span><span class="o">.</span><span class="n">subscribeToFriendStatus</span><span class="p">(</span><span class="n">friendID</span><span class="p">,</span> <span class="n">handleStatusChange</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">ChatAPI</span><span class="o">.</span><span class="n">unsubscribeFromFriendStatus</span><span class="p">(</span><span class="n">friendID</span><span class="p">,</span> <span class="n">handleStatusChange</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="p">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">isOnline</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ­¤å¤„å¹¶æœªåŒ…å«ä»»ä½•æ–°çš„å†…å®¹â€”â€”é€»è¾‘æ˜¯ä»ä¸Šè¿°ç»„ä»¶æ‹·è´æ¥çš„ã€‚ä¸ç»„ä»¶ä¸­ä¸€è‡´ï¼Œè¯·ç¡®ä¿åªåœ¨è‡ªå®šä¹‰ Hook çš„é¡¶å±‚æ— æ¡ä»¶åœ°è°ƒç”¨å…¶ä»– Hookã€‚</p>
<p>ä¸ React ç»„ä»¶ä¸åŒçš„æ˜¯ï¼Œè‡ªå®šä¹‰ Hook ä¸éœ€è¦å…·æœ‰ç‰¹æ®Šçš„æ ‡è¯†ã€‚æˆ‘ä»¬å¯ä»¥è‡ªç”±çš„å†³å®šå®ƒçš„å‚æ•°æ˜¯ä»€ä¹ˆï¼Œä»¥åŠå®ƒåº”è¯¥è¿”å›ä»€ä¹ˆï¼ˆå¦‚æœéœ€è¦çš„è¯ï¼‰ã€‚æ¢å¥è¯è¯´ï¼Œå®ƒå°±åƒä¸€ä¸ªæ­£å¸¸çš„å‡½æ•°ã€‚ä½†æ˜¯å®ƒçš„åå­—åº”è¯¥å§‹ç»ˆä»¥ <code>use</code> å¼€å¤´ï¼Œè¿™æ ·å¯ä»¥ä¸€çœ¼çœ‹å‡ºå…¶ç¬¦åˆ <a href="https://zh-hans.reactjs.org/docs/hooks-rules.html" target="_blank" rel="noopener noreferrer">Hook çš„è§„åˆ™</a>ã€‚</p>
<p>æ­¤å¤„ <code>useFriendStatus</code> çš„ Hook ç›®çš„æ˜¯è®¢é˜…æŸä¸ªå¥½å‹çš„åœ¨çº¿çŠ¶æ€ã€‚è¿™å°±æ˜¯æˆ‘ä»¬éœ€è¦å°† <code>friendID</code> ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›è¿™ä½å¥½å‹çš„åœ¨çº¿çŠ¶æ€çš„åŸå› ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">useFriendStatus</span><span class="p">(</span><span class="n">friendID</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">isOnline</span><span class="p">,</span> <span class="n">setIsOnline</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="n">null</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">isOnline</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç°åœ¨è®©æˆ‘ä»¬çœ‹çœ‹åº”è¯¥å¦‚ä½•ä½¿ç”¨è‡ªå®šä¹‰ Hookã€‚</p>
<h5 id="ä½¿ç”¨è‡ªå®šä¹‰-hook" class="headerLink">
    <a href="#%e4%bd%bf%e7%94%a8%e8%87%aa%e5%ae%9a%e4%b9%89-hook" class="header-mark"></a>ä½¿ç”¨è‡ªå®šä¹‰ Hook</h5><p>æˆ‘ä»¬ä¸€å¼€å§‹çš„ç›®æ ‡æ˜¯åœ¨ <code>FriendStatus</code> å’Œ <code>FriendListItem</code> ç»„ä»¶ä¸­å»é™¤é‡å¤çš„é€»è¾‘ï¼Œå³ï¼šè¿™ä¸¤ä¸ªç»„ä»¶éƒ½æƒ³çŸ¥é“å¥½å‹æ˜¯å¦åœ¨çº¿ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»æŠŠè¿™ä¸ªé€»è¾‘æå–åˆ° <code>useFriendStatus</code> çš„è‡ªå®šä¹‰ Hook ä¸­ï¼Œç„¶åå°±å¯ä»¥<em>ä½¿ç”¨å®ƒäº†ï¼š</em></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">FriendStatus</span><span class="p">(</span><span class="n">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">isOnline</span> <span class="o">=</span> <span class="n">useFriendStatus</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">friend</span><span class="o">.</span><span class="n">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">if</span> <span class="p">(</span><span class="n">isOnline</span> <span class="o">===</span> <span class="n">null</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="s1">&#39;Loading...&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">isOnline</span> <span class="err">?</span> <span class="s1">&#39;Online&#39;</span> <span class="p">:</span> <span class="s1">&#39;Offline&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">FriendListItem</span><span class="p">(</span><span class="n">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">isOnline</span> <span class="o">=</span> <span class="n">useFriendStatus</span><span class="p">(</span><span class="n">props</span><span class="o">.</span><span class="n">friend</span><span class="o">.</span><span class="n">id</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">li</span> <span class="n">style</span><span class="o">=</span><span class="p">{{</span> <span class="n">color</span><span class="p">:</span> <span class="n">isOnline</span> <span class="err">?</span> <span class="s1">&#39;green&#39;</span> <span class="p">:</span> <span class="s1">&#39;black&#39;</span> <span class="p">}}</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span><span class="n">props</span><span class="o">.</span><span class="n">friend</span><span class="o">.</span><span class="n">name</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">li</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>**è¿™æ®µä»£ç ç­‰ä»·äºåŸæ¥çš„ç¤ºä¾‹ä»£ç å—ï¼Ÿ**ç­‰ä»·ï¼Œå®ƒçš„å·¥ä½œæ–¹å¼å®Œå…¨ä¸€æ ·ã€‚å¦‚æœä½ ä»”ç»†è§‚å¯Ÿï¼Œä½ ä¼šå‘ç°æˆ‘ä»¬æ²¡æœ‰å¯¹å…¶è¡Œä¸ºåšä»»ä½•çš„æ”¹å˜ï¼Œæˆ‘ä»¬åªæ˜¯å°†ä¸¤ä¸ªå‡½æ•°ä¹‹é—´ä¸€äº›å…±åŒçš„ä»£ç æå–åˆ°å•ç‹¬çš„å‡½æ•°ä¸­ã€‚<strong>è‡ªå®šä¹‰ Hook æ˜¯ä¸€ç§è‡ªç„¶éµå¾ª Hook è®¾è®¡çš„çº¦å®šï¼Œè€Œå¹¶ä¸æ˜¯ React çš„ç‰¹æ€§ã€‚</strong></p>
<p>**è‡ªå®šä¹‰ Hook å¿…é¡»ä»¥ â€œ<code>use</code>â€ å¼€å¤´å—ï¼Ÿ**å¿…é¡»å¦‚æ­¤ã€‚è¿™ä¸ªçº¦å®šéå¸¸é‡è¦ã€‚ä¸éµå¾ªçš„è¯ï¼Œç”±äºæ— æ³•åˆ¤æ–­æŸä¸ªå‡½æ•°æ˜¯å¦åŒ…å«å¯¹å…¶å†…éƒ¨ Hook çš„è°ƒç”¨ï¼ŒReact å°†æ— æ³•è‡ªåŠ¨æ£€æŸ¥ä½ çš„ Hook æ˜¯å¦è¿åäº† <a href="https://zh-hans.reactjs.org/docs/hooks-rules.html" target="_blank" rel="noopener noreferrer">Hook çš„è§„åˆ™</a>ã€‚</p>
<p>**åœ¨ä¸¤ä¸ªç»„ä»¶ä¸­ä½¿ç”¨ç›¸åŒçš„ Hook ä¼šå…±äº« state å—ï¼Ÿ**ä¸ä¼šã€‚è‡ªå®šä¹‰ Hook æ˜¯ä¸€ç§é‡ç”¨<em>çŠ¶æ€é€»è¾‘</em>çš„æœºåˆ¶(ä¾‹å¦‚è®¾ç½®ä¸ºè®¢é˜…å¹¶å­˜å‚¨å½“å‰å€¼)ï¼Œæ‰€ä»¥æ¯æ¬¡ä½¿ç”¨è‡ªå®šä¹‰ Hook æ—¶ï¼Œå…¶ä¸­çš„æ‰€æœ‰ state å’Œå‰¯ä½œç”¨éƒ½æ˜¯å®Œå…¨éš”ç¦»çš„ã€‚</p>
<p>**è‡ªå®šä¹‰ Hook å¦‚ä½•è·å–ç‹¬ç«‹çš„ stateï¼Ÿ**æ¯æ¬¡<em>è°ƒç”¨</em> Hookï¼Œå®ƒéƒ½ä¼šè·å–ç‹¬ç«‹çš„ stateã€‚ç”±äºæˆ‘ä»¬ç›´æ¥è°ƒç”¨äº† <code>useFriendStatus</code>ï¼Œä» React çš„è§’åº¦æ¥çœ‹ï¼Œæˆ‘ä»¬çš„ç»„ä»¶åªæ˜¯è°ƒç”¨äº† <code>useState</code> å’Œ <code>useEffect</code>ã€‚ æ­£å¦‚æˆ‘ä»¬åœ¨<a href="https://zh-hans.reactjs.org/docs/hooks-effect.html#tip-use-multiple-effects-to-separate-concerns" target="_blank" rel="noopener noreferrer">ä¹‹å‰ç« èŠ‚</a>ä¸­<a href="https://zh-hans.reactjs.org/docs/hooks-state.html#tip-using-multiple-state-variables" target="_blank" rel="noopener noreferrer">äº†è§£åˆ°çš„</a>ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªç»„ä»¶ä¸­å¤šæ¬¡è°ƒç”¨ <code>useState</code> å’Œ <code>useEffect</code>ï¼Œå®ƒä»¬æ˜¯å®Œå…¨ç‹¬ç«‹çš„ã€‚</p>
<h6 id="æç¤ºåœ¨å¤šä¸ª-hook-ä¹‹é—´ä¼ é€’ä¿¡æ¯" class="headerLink">
    <a href="#%e6%8f%90%e7%a4%ba%e5%9c%a8%e5%a4%9a%e4%b8%aa-hook-%e4%b9%8b%e9%97%b4%e4%bc%a0%e9%80%92%e4%bf%a1%e6%81%af" class="header-mark"></a>æç¤ºï¼šåœ¨å¤šä¸ª Hook ä¹‹é—´ä¼ é€’ä¿¡æ¯</h6><p>ç”±äº Hook æœ¬èº«å°±æ˜¯å‡½æ•°ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨å®ƒä»¬ä¹‹é—´ä¼ é€’ä¿¡æ¯ã€‚</p>
<p>æˆ‘ä»¬å°†ä½¿ç”¨èŠå¤©ç¨‹åºä¸­çš„å¦ä¸€ä¸ªç»„ä»¶æ¥è¯´æ˜è¿™ä¸€ç‚¹ã€‚è¿™æ˜¯ä¸€ä¸ªèŠå¤©æ¶ˆæ¯æ¥æ”¶è€…çš„é€‰æ‹©å™¨ï¼Œå®ƒä¼šæ˜¾ç¤ºå½“å‰é€‰å®šçš„å¥½å‹æ˜¯å¦åœ¨çº¿:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">const</span> <span class="n">friendList</span> <span class="o">=</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span> <span class="n">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;Phoebe&#39;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span> <span class="n">id</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;Rachel&#39;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">{</span> <span class="n">id</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="s1">&#39;Ross&#39;</span> <span class="p">},</span>
</span></span><span class="line"><span class="cl"><span class="p">];</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">ChatRecipientPicker</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">recipientID</span><span class="p">,</span> <span class="n">setRecipientID</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>  <span class="k">const</span> <span class="n">isRecipientOnline</span> <span class="o">=</span> <span class="n">useFriendStatus</span><span class="p">(</span><span class="n">recipientID</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">Circle</span> <span class="n">color</span><span class="o">=</span><span class="p">{</span><span class="n">isRecipientOnline</span> <span class="err">?</span> <span class="s1">&#39;green&#39;</span> <span class="p">:</span> <span class="s1">&#39;red&#39;</span><span class="p">}</span> <span class="o">/&gt;</span>      <span class="o">&lt;</span><span class="n">select</span>
</span></span><span class="line"><span class="cl">        <span class="n">value</span><span class="o">=</span><span class="p">{</span><span class="n">recipientID</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">onChange</span><span class="o">=</span><span class="p">{</span><span class="n">e</span> <span class="o">=&gt;</span> <span class="n">setRecipientID</span><span class="p">(</span><span class="n">Number</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">target</span><span class="o">.</span><span class="n">value</span><span class="p">))}</span>
</span></span><span class="line"><span class="cl">      <span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="n">friendList</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">friend</span> <span class="o">=&gt;</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">          <span class="o">&lt;</span><span class="n">option</span> <span class="n">key</span><span class="o">=</span><span class="p">{</span><span class="n">friend</span><span class="o">.</span><span class="n">id</span><span class="p">}</span> <span class="n">value</span><span class="o">=</span><span class="p">{</span><span class="n">friend</span><span class="o">.</span><span class="n">id</span><span class="p">}</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span><span class="n">friend</span><span class="o">.</span><span class="n">name</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="o">&lt;/</span><span class="n">option</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">))}</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;/</span><span class="n">select</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æˆ‘ä»¬å°†å½“å‰é€‰æ‹©çš„å¥½å‹ ID ä¿å­˜åœ¨ <code>recipientID</code> çŠ¶æ€å˜é‡ä¸­ï¼Œå¹¶åœ¨ç”¨æˆ·ä» <code>&lt;select&gt;</code> ä¸­é€‰æ‹©å…¶ä»–å¥½å‹æ—¶æ›´æ–°è¿™ä¸ª stateã€‚</p>
<p>ç”±äº <code>useState</code> ä¸ºæˆ‘ä»¬æä¾›äº† <code>recipientID</code> çŠ¶æ€å˜é‡çš„æœ€æ–°å€¼ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†å®ƒä½œä¸ºå‚æ•°ä¼ é€’ç»™è‡ªå®šä¹‰çš„ <code>useFriendStatus</code> Hookï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">recipientID</span><span class="p">,</span> <span class="n">setRecipientID</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">isRecipientOnline</span> <span class="o">=</span> <span class="n">useFriendStatus</span><span class="p">(</span><span class="n">recipientID</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¦‚æ­¤å¯ä»¥è®©æˆ‘ä»¬çŸ¥é“<em>å½“å‰é€‰ä¸­</em>çš„å¥½å‹æ˜¯å¦åœ¨çº¿ã€‚å½“æˆ‘ä»¬é€‰æ‹©ä¸åŒçš„å¥½å‹å¹¶æ›´æ–° <code>recipientID</code> çŠ¶æ€å˜é‡æ—¶ï¼Œ<code>useFriendStatus</code> Hook å°†ä¼šå–æ¶ˆè®¢é˜…ä¹‹å‰é€‰ä¸­çš„å¥½å‹ï¼Œå¹¶è®¢é˜…æ–°é€‰ä¸­çš„å¥½å‹çŠ¶æ€ã€‚</p>
<h5 id="useyourimagination" class="headerLink">
    <a href="#useyourimagination" class="header-mark"></a><code>useYourImagination()</code></h5><p>è‡ªå®šä¹‰ Hook è§£å†³äº†ä»¥å‰åœ¨ React ç»„ä»¶ä¸­æ— æ³•çµæ´»å…±äº«é€»è¾‘çš„é—®é¢˜ã€‚ä½ å¯ä»¥åˆ›å»ºæ¶µç›–å„ç§åœºæ™¯çš„è‡ªå®šä¹‰ Hookï¼Œå¦‚è¡¨å•å¤„ç†ã€åŠ¨ç”»ã€è®¢é˜…å£°æ˜ã€è®¡æ—¶å™¨ï¼Œç”šè‡³å¯èƒ½è¿˜æœ‰å…¶ä»–æˆ‘ä»¬æ²¡æƒ³åˆ°çš„åœºæ™¯ã€‚æ›´é‡è¦çš„æ˜¯ï¼Œåˆ›å»ºè‡ªå®šä¹‰ Hook å°±åƒä½¿ç”¨ React å†…ç½®çš„åŠŸèƒ½ä¸€æ ·ç®€å•ã€‚</p>
<p>å°½é‡é¿å…è¿‡æ—©åœ°å¢åŠ æŠ½è±¡é€»è¾‘ã€‚æ—¢ç„¶å‡½æ•°ç»„ä»¶èƒ½å¤Ÿåšçš„æ›´å¤šï¼Œé‚£ä¹ˆä»£ç åº“ä¸­å‡½æ•°ç»„ä»¶çš„ä»£ç è¡Œæ•°å¯èƒ½ä¼šå‰§å¢ã€‚è¿™å±äºæ­£å¸¸ç°è±¡ â€”â€” ä¸å¿…ç«‹å³å°†å®ƒä»¬æ‹†åˆ†ä¸º Hookã€‚ä½†æˆ‘ä»¬ä»é¼“åŠ±ä½ èƒ½é€šè¿‡è‡ªå®šä¹‰ Hook å¯»æ‰¾å¯èƒ½ï¼Œä»¥è¾¾åˆ°ç®€åŒ–ä»£ç é€»è¾‘ï¼Œè§£å†³ç»„ä»¶æ‚ä¹±æ— ç« çš„ç›®çš„ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæœ‰ä¸ªå¤æ‚çš„ç»„ä»¶ï¼Œå…¶ä¸­åŒ…å«äº†å¤§é‡ä»¥ç‰¹æ®Šçš„æ–¹å¼æ¥ç®¡ç†çš„å†…éƒ¨çŠ¶æ€ã€‚<code>useState</code> å¹¶ä¸ä¼šä½¿å¾—é›†ä¸­æ›´æ–°é€»è¾‘å˜å¾—å®¹æ˜“ï¼Œå› æ­¤ä½ å¯èƒ½æ›´æ„¿æ„ä½¿ç”¨ <a href="http://redux.js.org/" target="_blank" rel="noopener noreferrer">redux</a> ä¸­çš„ reducer æ¥ç¼–å†™ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">function todosReducer(state, action) {
</span></span><span class="line"><span class="cl">  switch (action.type) {
</span></span><span class="line"><span class="cl">    case &#39;add&#39;:
</span></span><span class="line"><span class="cl">      return [...state, {
</span></span><span class="line"><span class="cl">        text: action.text,
</span></span><span class="line"><span class="cl">        completed: false
</span></span><span class="line"><span class="cl">      }];
</span></span><span class="line"><span class="cl">    // ... other actions ...
</span></span><span class="line"><span class="cl">    default:
</span></span><span class="line"><span class="cl">      return state;
</span></span><span class="line"><span class="cl">  }
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p>Reducers éå¸¸ä¾¿äºå•ç‹¬æµ‹è¯•ï¼Œä¸”æ˜“äºæ‰©å±•ï¼Œä»¥è¡¨è¾¾å¤æ‚çš„æ›´æ–°é€»è¾‘ã€‚å¦‚æœ‰å¿…è¦ï¼Œæ‚¨å¯ä»¥å°†å®ƒä»¬åˆ†æˆæ›´å°çš„ reducerã€‚ä½†æ˜¯ï¼Œä½ å¯èƒ½è¿˜äº«å—ç€ React å†…éƒ¨ state å¸¦æ¥çš„å¥½å¤„ï¼Œæˆ–è€…å¯èƒ½æ ¹æœ¬ä¸æƒ³å®‰è£…å…¶ä»–åº“ã€‚</p>
<p>é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬ä¸ç¼–å†™ä¸€ä¸ª <code>useReducer</code> çš„ Hookï¼Œä½¿ç”¨ reducer çš„æ–¹å¼æ¥ç®¡ç†ç»„ä»¶çš„å†…éƒ¨ state å‘¢ï¼Ÿå…¶ç®€åŒ–ç‰ˆæœ¬å¯èƒ½å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">useReducer</span><span class="p">(</span><span class="n">reducer</span><span class="p">,</span> <span class="n">initialState</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">state</span><span class="p">,</span> <span class="n">setState</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="n">initialState</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">function</span> <span class="n">dispatch</span><span class="p">(</span><span class="n">action</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">const</span> <span class="n">nextState</span> <span class="o">=</span> <span class="n">reducer</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">setState</span><span class="p">(</span><span class="n">nextState</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">[</span><span class="n">state</span><span class="p">,</span> <span class="n">dispatch</span><span class="p">];</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨ç»„ä»¶ä¸­ä½¿ç”¨å®ƒï¼Œè®© reducer é©±åŠ¨å®ƒç®¡ç† stateï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">Todos</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">todos</span><span class="p">,</span> <span class="n">dispatch</span><span class="p">]</span> <span class="o">=</span> <span class="n">useReducer</span><span class="p">(</span><span class="n">todosReducer</span><span class="p">,</span> <span class="p">[]);</span>
</span></span><span class="line"><span class="cl">  <span class="n">function</span> <span class="n">handleAddClick</span><span class="p">(</span><span class="n">text</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">dispatch</span><span class="p">({</span> <span class="n">type</span><span class="p">:</span> <span class="s1">&#39;add&#39;</span><span class="p">,</span> <span class="n">text</span> <span class="p">});</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨å¤æ‚ç»„ä»¶ä¸­ä½¿ç”¨ reducer ç®¡ç†å†…éƒ¨ state çš„éœ€æ±‚å¾ˆå¸¸è§ï¼Œæˆ‘ä»¬å·²ç»å°† <code>useReducer</code> çš„ Hook å†…ç½®åˆ° React ä¸­ã€‚ä½ å¯ä»¥åœ¨ <a href="https://zh-hans.reactjs.org/docs/hooks-reference.html" target="_blank" rel="noopener noreferrer">Hook API ç´¢å¼•</a>ä¸­æ‰¾åˆ°å®ƒä½¿ç”¨ï¼Œæ­é…å…¶ä»–å†…ç½®çš„ Hook ä¸€èµ·ä½¿ç”¨ã€‚</p>
<h4 id="hooks-faq" class="headerLink">
    <a href="#hooks-faq" class="header-mark"></a>Hooks FAQ</h4><p><em>Hook</em> æ˜¯ React 16.8 çš„æ–°å¢ç‰¹æ€§ã€‚å®ƒå¯ä»¥è®©ä½ åœ¨ä¸ç¼–å†™ class çš„æƒ…å†µä¸‹ä½¿ç”¨ state ä»¥åŠå…¶ä»–çš„ React ç‰¹æ€§ã€‚</p>
<p>æ­¤ç« èŠ‚å›ç­”äº†å…³äº <a href="https://zh-hans.reactjs.org/docs/hooks-overview.html" target="_blank" rel="noopener noreferrer">Hook</a> çš„å¸¸è§é—®é¢˜ã€‚</p>
<ul>
<li><strong><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#adoption-strategy" target="_blank" rel="noopener noreferrer">é‡‡çº³ç­–ç•¥</a></strong>
<ul>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#which-versions-of-react-include-hooks" target="_blank" rel="noopener noreferrer">å“ªä¸ªç‰ˆæœ¬çš„ React åŒ…å«äº† Hookï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#do-i-need-to-rewrite-all-my-class-components" target="_blank" rel="noopener noreferrer">æˆ‘éœ€è¦é‡å†™æ‰€æœ‰çš„ class ç»„ä»¶å—ï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#what-can-i-do-with-hooks-that-i-couldnt-with-classes" target="_blank" rel="noopener noreferrer">æœ‰ä»€ä¹ˆæ˜¯ Hook èƒ½åšè€Œ class åšä¸åˆ°çš„ï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#how-much-of-my-react-knowledge-stays-relevant" target="_blank" rel="noopener noreferrer">æˆ‘çš„ React çŸ¥è¯†è¿˜æœ‰å¤šå°‘æ˜¯ä»ç„¶æœ‰ç”¨çš„ï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#should-i-use-hooks-classes-or-a-mix-of-both" target="_blank" rel="noopener noreferrer">æˆ‘åº”è¯¥ä½¿ç”¨ Hookï¼Œclassï¼Œè¿˜æ˜¯ä¸¤è€…æ··ç”¨ï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#do-hooks-cover-all-use-cases-for-classes" target="_blank" rel="noopener noreferrer">Hook èƒ½å¦è¦†ç›– class çš„æ‰€æœ‰ä½¿ç”¨åœºæ™¯ï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#do-hooks-replace-render-props-and-higher-order-components" target="_blank" rel="noopener noreferrer">Hook ä¼šæ›¿ä»£ render props å’Œé«˜é˜¶ç»„ä»¶å—ï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#what-do-hooks-mean-for-popular-apis-like-redux-connect-and-react-router" target="_blank" rel="noopener noreferrer">Hook å¯¹äº Redux connect() å’Œ React Router ç­‰æµè¡Œçš„ API æ¥è¯´ï¼Œæ„å‘³ç€ä»€ä¹ˆï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#do-hooks-work-with-static-typing" target="_blank" rel="noopener noreferrer">Hook èƒ½å’Œé™æ€ç±»å‹ä¸€èµ·ç”¨å—ï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#how-to-test-components-that-use-hooks" target="_blank" rel="noopener noreferrer">å¦‚ä½•æµ‹è¯•ä½¿ç”¨äº† Hook çš„ç»„ä»¶ï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#what-exactly-do-the-lint-rules-enforce" target="_blank" rel="noopener noreferrer">lint è§„åˆ™å…·ä½“å¼ºåˆ¶äº†å“ªäº›å†…å®¹ï¼Ÿ</a></li>
</ul>
</li>
<li><strong><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#from-classes-to-hooks" target="_blank" rel="noopener noreferrer">ä» Class è¿ç§»åˆ° Hook</a></strong>
<ul>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#how-do-lifecycle-methods-correspond-to-hooks" target="_blank" rel="noopener noreferrer">ç”Ÿå‘½å‘¨æœŸæ–¹æ³•è¦å¦‚ä½•å¯¹åº”åˆ° Hookï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#how-can-i-do-data-fetching-with-hooks" target="_blank" rel="noopener noreferrer">æˆ‘è¯¥å¦‚ä½•ä½¿ç”¨ Hook è¿›è¡Œæ•°æ®è·å–ï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#is-there-something-like-instance-variables" target="_blank" rel="noopener noreferrer">æœ‰ç±»ä¼¼å®ä¾‹å˜é‡çš„ä¸œè¥¿å—ï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#should-i-use-one-or-many-state-variables" target="_blank" rel="noopener noreferrer">æˆ‘åº”è¯¥ä½¿ç”¨å•ä¸ªè¿˜æ˜¯å¤šä¸ª state å˜é‡ï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#can-i-run-an-effect-only-on-updates" target="_blank" rel="noopener noreferrer">æˆ‘å¯ä»¥åªåœ¨æ›´æ–°æ—¶è¿è¡Œ effect å—ï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#how-to-get-the-previous-props-or-state" target="_blank" rel="noopener noreferrer">å¦‚ä½•è·å–ä¸Šä¸€è½®çš„ props æˆ– stateï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#why-am-i-seeing-stale-props-or-state-inside-my-function" target="_blank" rel="noopener noreferrer">ä¸ºä»€ä¹ˆæˆ‘ä¼šåœ¨æˆ‘çš„å‡½æ•°ä¸­çœ‹åˆ°é™ˆæ—§çš„ props å’Œ state ï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#how-do-i-implement-getderivedstatefromprops" target="_blank" rel="noopener noreferrer">æˆ‘è¯¥å¦‚ä½•å®ç° getDerivedStateFromPropsï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#is-there-something-like-forceupdate" target="_blank" rel="noopener noreferrer">æœ‰ç±»ä¼¼ forceUpdate çš„ä¸œè¥¿å—ï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#can-i-make-a-ref-to-a-function-component" target="_blank" rel="noopener noreferrer">æˆ‘å¯ä»¥å¼•ç”¨ä¸€ä¸ªå‡½æ•°ç»„ä»¶å—ï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#how-can-i-measure-a-dom-node" target="_blank" rel="noopener noreferrer">æˆ‘è¯¥å¦‚ä½•æµ‹é‡ DOM èŠ‚ç‚¹ï¼Ÿ</a></li>
<li>[const <a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#what-does-const-thing-setthing--usestate-mean" target="_blank" rel="noopener noreferrer">thing, setThing] = useState() æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</a></li>
</ul>
</li>
<li><strong><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#performance-optimizations" target="_blank" rel="noopener noreferrer">æ€§èƒ½ä¼˜åŒ–</a></strong>
<ul>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#can-i-skip-an-effect-on-updates" target="_blank" rel="noopener noreferrer">æˆ‘å¯ä»¥åœ¨æ›´æ–°æ—¶è·³è¿‡ effect å—ï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#is-it-safe-to-omit-functions-from-the-list-of-dependencies" target="_blank" rel="noopener noreferrer">åœ¨ä¾èµ–åˆ—è¡¨ä¸­çœç•¥å‡½æ•°æ˜¯å¦å®‰å…¨ï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#what-can-i-do-if-my-effect-dependencies-change-too-often" target="_blank" rel="noopener noreferrer">å¦‚æœæˆ‘çš„ effect çš„ä¾èµ–é¢‘ç¹å˜åŒ–ï¼Œæˆ‘è¯¥æ€ä¹ˆåŠï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#how-do-i-implement-shouldcomponentupdate" target="_blank" rel="noopener noreferrer">æˆ‘è¯¥å¦‚ä½•å®ç° shouldComponentUpdateï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#how-to-memoize-calculations" target="_blank" rel="noopener noreferrer">å¦‚ä½•è®°å¿†è®¡ç®—ç»“æœï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#how-to-create-expensive-objects-lazily" target="_blank" rel="noopener noreferrer">å¦‚ä½•æƒ°æ€§åˆ›å»ºæ˜‚è´µçš„å¯¹è±¡ï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#are-hooks-slow-because-of-creating-functions-in-render" target="_blank" rel="noopener noreferrer">Hook ä¼šå› ä¸ºåœ¨æ¸²æŸ“æ—¶åˆ›å»ºå‡½æ•°è€Œå˜æ…¢å—ï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#how-to-avoid-passing-callbacks-down" target="_blank" rel="noopener noreferrer">å¦‚ä½•é¿å…å‘ä¸‹ä¼ é€’å›è°ƒï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#how-to-read-an-often-changing-value-from-usecallback" target="_blank" rel="noopener noreferrer">å¦‚ä½•ä» useCallback è¯»å–ä¸€ä¸ªç»å¸¸å˜åŒ–çš„å€¼ï¼Ÿ</a></li>
</ul>
</li>
<li><strong><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#under-the-hood" target="_blank" rel="noopener noreferrer">åº•å±‚åŸç†</a></strong>
<ul>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#how-does-react-associate-hook-calls-with-components" target="_blank" rel="noopener noreferrer">React æ˜¯å¦‚ä½•æŠŠå¯¹ Hook çš„è°ƒç”¨å’Œç»„ä»¶è”ç³»èµ·æ¥çš„ï¼Ÿ</a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#what-is-the-prior-art-for-hooks" target="_blank" rel="noopener noreferrer">Hook ä½¿ç”¨äº†å“ªäº›ç°æœ‰æŠ€æœ¯ï¼Ÿ</a></li>
</ul>
</li>
</ul>
<h3 id="hook-api-ç´¢å¼•" class="headerLink">
    <a href="#hook-api-%e7%b4%a2%e5%bc%95" class="header-mark"></a>Hook API ç´¢å¼•</h3><p><em>Hook</em> æ˜¯ React 16.8 çš„æ–°å¢ç‰¹æ€§ã€‚å®ƒå¯ä»¥è®©ä½ åœ¨ä¸ç¼–å†™ class çš„æƒ…å†µä¸‹ä½¿ç”¨ state ä»¥åŠå…¶ä»–çš„ React ç‰¹æ€§ã€‚</p>
<p>æœ¬é¡µé¢ä¸»è¦æè¿° React ä¸­å†…ç½®çš„ Hook APIã€‚</p>
<p>å¦‚æœä½ åˆšå¼€å§‹æ¥è§¦ Hookï¼Œé‚£ä¹ˆå¯èƒ½éœ€è¦å…ˆæŸ¥é˜… <a href="https://zh-hans.reactjs.org/docs/hooks-overview.html" target="_blank" rel="noopener noreferrer">Hook æ¦‚è§ˆ</a>ã€‚ä½ ä¹Ÿå¯ä»¥åœ¨ <a href="https://zh-hans.reactjs.org/docs/hooks-faq.html" target="_blank" rel="noopener noreferrer">Hooks FAQ</a> ç« èŠ‚ä¸­è·å–æœ‰ç”¨çš„ä¿¡æ¯ã€‚</p>
<ul>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#basic-hooks" target="_blank" rel="noopener noreferrer">åŸºç¡€ Hook</a>
<ul>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#usestate" target="_blank" rel="noopener noreferrer"><code>useState</code></a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#useeffect" target="_blank" rel="noopener noreferrer"><code>useEffect</code></a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#usecontext" target="_blank" rel="noopener noreferrer"><code>useContext</code></a></li>
</ul>
</li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#additional-hooks" target="_blank" rel="noopener noreferrer">é¢å¤–çš„ Hook</a>
<ul>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#usereducer" target="_blank" rel="noopener noreferrer"><code>useReducer</code></a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#usecallback" target="_blank" rel="noopener noreferrer"><code>useCallback</code></a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#usememo" target="_blank" rel="noopener noreferrer"><code>useMemo</code></a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#useref" target="_blank" rel="noopener noreferrer"><code>useRef</code></a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#useimperativehandle" target="_blank" rel="noopener noreferrer"><code>useImperativeHandle</code></a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#uselayouteffect" target="_blank" rel="noopener noreferrer"><code>useLayoutEffect</code></a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#usedebugvalue" target="_blank" rel="noopener noreferrer"><code>useDebugValue</code></a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#usedeferredvalue" target="_blank" rel="noopener noreferrer"><code>useDeferredValue</code></a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#usetransition" target="_blank" rel="noopener noreferrer"><code>useTransition</code></a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#useid" target="_blank" rel="noopener noreferrer"><code>useId</code></a></li>
</ul>
</li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#library-hooks" target="_blank" rel="noopener noreferrer">Library Hooks</a>
<ul>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#usesyncexternalstore" target="_blank" rel="noopener noreferrer"><code>useSyncExternalStore</code></a></li>
<li><a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#useinsertioneffect" target="_blank" rel="noopener noreferrer"><code>useInsertionEffect</code></a></li>
</ul>
</li>
</ul>
<h4 id="åŸºç¡€-hook" class="headerLink">
    <a href="#%e5%9f%ba%e7%a1%80-hook" class="header-mark"></a>åŸºç¡€ Hook</h4><h5 id="usestate" class="headerLink">
    <a href="#usestate" class="header-mark"></a><code>useState</code></h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">const</span> <span class="p">[</span><span class="n">state</span><span class="p">,</span> <span class="n">setState</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="n">initialState</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿”å›ä¸€ä¸ª stateï¼Œä»¥åŠæ›´æ–° state çš„å‡½æ•°ã€‚</p>
<p>åœ¨åˆå§‹æ¸²æŸ“æœŸé—´ï¼Œè¿”å›çš„çŠ¶æ€ (<code>state</code>) ä¸ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•° (<code>initialState</code>) å€¼ç›¸åŒã€‚</p>
<p><code>setState</code> å‡½æ•°ç”¨äºæ›´æ–° stateã€‚å®ƒæ¥æ”¶ä¸€ä¸ªæ–°çš„ state å€¼å¹¶å°†ç»„ä»¶çš„ä¸€æ¬¡é‡æ–°æ¸²æŸ“åŠ å…¥é˜Ÿåˆ—ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">setState(newState);
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨åç»­çš„é‡æ–°æ¸²æŸ“ä¸­ï¼Œ<code>useState</code> è¿”å›çš„ç¬¬ä¸€ä¸ªå€¼å°†å§‹ç»ˆæ˜¯æ›´æ–°åæœ€æ–°çš„ stateã€‚</p>
<blockquote>
<p>æ³¨æ„</p>
<p>React ä¼šç¡®ä¿ <code>setState</code> å‡½æ•°çš„æ ‡è¯†æ˜¯ç¨³å®šçš„ï¼Œå¹¶ä¸”ä¸ä¼šåœ¨ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶å‘ç”Ÿå˜åŒ–ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¯ä»¥å®‰å…¨åœ°ä» <code>useEffect</code> æˆ– <code>useCallback</code> çš„ä¾èµ–åˆ—è¡¨ä¸­çœç•¥ <code>setState</code>ã€‚</p>
</blockquote>
<h6 id="å‡½æ•°å¼æ›´æ–°" class="headerLink">
    <a href="#%e5%87%bd%e6%95%b0%e5%bc%8f%e6%9b%b4%e6%96%b0" class="header-mark"></a>å‡½æ•°å¼æ›´æ–°</h6><p>å¦‚æœæ–°çš„ state éœ€è¦é€šè¿‡ä½¿ç”¨å…ˆå‰çš„ state è®¡ç®—å¾—å‡ºï¼Œé‚£ä¹ˆå¯ä»¥å°†å‡½æ•°ä¼ é€’ç»™ <code>setState</code>ã€‚è¯¥å‡½æ•°å°†æ¥æ”¶å…ˆå‰çš„ stateï¼Œå¹¶è¿”å›ä¸€ä¸ªæ›´æ–°åçš„å€¼ã€‚ä¸‹é¢çš„è®¡æ•°å™¨ç»„ä»¶ç¤ºä¾‹å±•ç¤ºäº† <code>setState</code> çš„ä¸¤ç§ç”¨æ³•ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">Counter</span><span class="p">({</span><span class="n">initialCount</span><span class="p">})</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">count</span><span class="p">,</span> <span class="n">setCount</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="n">initialCount</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="n">Count</span><span class="p">:</span> <span class="p">{</span><span class="n">count</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">button</span> <span class="n">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="n">setCount</span><span class="p">(</span><span class="n">initialCount</span><span class="p">)}</span><span class="o">&gt;</span><span class="n">Reset</span><span class="o">&lt;/</span><span class="n">button</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">button</span> <span class="n">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="n">setCount</span><span class="p">(</span><span class="n">prevCount</span> <span class="o">=&gt;</span> <span class="n">prevCount</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)}</span><span class="o">&gt;-&lt;/</span><span class="n">button</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">button</span> <span class="n">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="n">setCount</span><span class="p">(</span><span class="n">prevCount</span> <span class="o">=&gt;</span> <span class="n">prevCount</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)}</span><span class="o">&gt;+&lt;/</span><span class="n">button</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>â€œ+â€ å’Œ â€œ-â€ æŒ‰é’®é‡‡ç”¨å‡½æ•°å¼å½¢å¼ï¼Œå› ä¸ºè¢«æ›´æ–°çš„ state éœ€è¦åŸºäºä¹‹å‰çš„ stateã€‚ä½†æ˜¯â€œé‡ç½®â€æŒ‰é’®åˆ™é‡‡ç”¨æ™®é€šå½¢å¼ï¼Œå› ä¸ºå®ƒæ€»æ˜¯æŠŠ count è®¾ç½®å›åˆå§‹å€¼ã€‚</p>
<p>å¦‚æœä½ çš„æ›´æ–°å‡½æ•°è¿”å›å€¼ä¸å½“å‰ state å®Œå…¨ç›¸åŒï¼Œåˆ™éšåçš„é‡æ¸²æŸ“ä¼šè¢«å®Œå…¨è·³è¿‡ã€‚</p>
<blockquote>
<p>æ³¨æ„</p>
<p>ä¸ class ç»„ä»¶ä¸­çš„ <code>setState</code> æ–¹æ³•ä¸åŒï¼Œ<code>useState</code> ä¸ä¼šè‡ªåŠ¨åˆå¹¶æ›´æ–°å¯¹è±¡ã€‚ä½ å¯ä»¥ç”¨å‡½æ•°å¼çš„ <code>setState</code> ç»“åˆå±•å¼€è¿ç®—ç¬¦æ¥è¾¾åˆ°åˆå¹¶æ›´æ–°å¯¹è±¡çš„æ•ˆæœã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">const</span> <span class="p">[</span><span class="n">state</span><span class="p">,</span> <span class="n">setState</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">({});</span>
</span></span><span class="line"><span class="cl"><span class="n">setState</span><span class="p">(</span><span class="n">prevState</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="err">ä¹Ÿå¯ä»¥ä½¿ç”¨</span> <span class="ne">Object</span><span class="o">.</span><span class="n">assign</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">{</span><span class="o">...</span><span class="n">prevState</span><span class="p">,</span> <span class="o">...</span><span class="n">updatedValues</span><span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>useReducer</code> æ˜¯å¦ä¸€ç§å¯é€‰æ–¹æ¡ˆï¼Œå®ƒæ›´é€‚åˆç”¨äºç®¡ç†åŒ…å«å¤šä¸ªå­å€¼çš„ state å¯¹è±¡ã€‚</p>
</blockquote>
<h6 id="æƒ°æ€§åˆå§‹-state" class="headerLink">
    <a href="#%e6%83%b0%e6%80%a7%e5%88%9d%e5%a7%8b-state" class="header-mark"></a>æƒ°æ€§åˆå§‹ state</h6><p><code>initialState</code> å‚æ•°åªä¼šåœ¨ç»„ä»¶çš„åˆå§‹æ¸²æŸ“ä¸­èµ·ä½œç”¨ï¼Œåç»­æ¸²æŸ“æ—¶ä¼šè¢«å¿½ç•¥ã€‚å¦‚æœåˆå§‹ state éœ€è¦é€šè¿‡å¤æ‚è®¡ç®—è·å¾—ï¼Œåˆ™å¯ä»¥ä¼ å…¥ä¸€ä¸ªå‡½æ•°ï¼Œåœ¨å‡½æ•°ä¸­è®¡ç®—å¹¶è¿”å›åˆå§‹çš„ stateï¼Œæ­¤å‡½æ•°åªåœ¨åˆå§‹æ¸²æŸ“æ—¶è¢«è°ƒç”¨ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">const</span> <span class="p">[</span><span class="n">state</span><span class="p">,</span> <span class="n">setState</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">initialState</span> <span class="o">=</span> <span class="n">someExpensiveComputation</span><span class="p">(</span><span class="n">props</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">initialState</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h6 id="è·³è¿‡-state-æ›´æ–°" class="headerLink">
    <a href="#%e8%b7%b3%e8%bf%87-state-%e6%9b%b4%e6%96%b0" class="header-mark"></a>è·³è¿‡ state æ›´æ–°</h6><p>å¦‚æœä½ æ›´æ–° State Hook åçš„ state ä¸å½“å‰çš„ state ç›¸åŒæ—¶ï¼ŒReact å°†è·³è¿‡å­ç»„ä»¶çš„æ¸²æŸ“å¹¶ä¸”ä¸ä¼šè§¦å‘ effect çš„æ‰§è¡Œã€‚ï¼ˆReact ä½¿ç”¨ <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is#Description" target="_blank" rel="noopener noreferrer"><code>Object.is</code> æ¯”è¾ƒç®—æ³•</a> æ¥æ¯”è¾ƒ stateã€‚ï¼‰</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒReact å¯èƒ½ä»éœ€è¦åœ¨è·³è¿‡æ¸²æŸ“å‰æ¸²æŸ“è¯¥ç»„ä»¶ã€‚ä¸è¿‡ç”±äº React ä¸ä¼šå¯¹ç»„ä»¶æ ‘çš„â€œæ·±å±‚â€èŠ‚ç‚¹è¿›è¡Œä¸å¿…è¦çš„æ¸²æŸ“ï¼Œæ‰€ä»¥å¤§å¯ä¸å¿…æ‹…å¿ƒã€‚å¦‚æœä½ åœ¨æ¸²æŸ“æœŸé—´æ‰§è¡Œäº†é«˜å¼€é”€çš„è®¡ç®—ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ <code>useMemo</code> æ¥è¿›è¡Œä¼˜åŒ–ã€‚</p>
<h6 id="batching-of-state-updates" class="headerLink">
    <a href="#batching-of-state-updates" class="header-mark"></a>Batching of state updates</h6><p>React may group several state updates into a single re-render to improve performance. Normally, this improves performance and shouldnâ€™t affect your applicationâ€™s behavior.</p>
<p>Before React 18, only updates inside React event handlers were batched. Starting with React 18, <a href="https://zh-hans.reactjs.org/blog/2022/03/08/react-18-upgrade-guide.html#automatic-batching" target="_blank" rel="noopener noreferrer">batching is enabled for all updates by default</a>. Note that React makes sure that updates from several <em>different</em> user-initiated events â€” for example, clicking a button twice â€” are always processed separately and do not get batched. This prevents logical mistakes.</p>
<p>In the rare case that you need to force the DOM update to be applied synchronously, you may wrap it in <a href="https://zh-hans.reactjs.org/docs/react-dom.html#flushsync" target="_blank" rel="noopener noreferrer"><code>flushSync</code></a>. However, this can hurt performance so do this only where needed.</p>
<h5 id="useeffect" class="headerLink">
    <a href="#useeffect" class="header-mark"></a><code>useEffect</code></h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">useEffect(didUpdate);
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¯¥ Hook æ¥æ”¶ä¸€ä¸ªåŒ…å«å‘½ä»¤å¼ã€ä¸”å¯èƒ½æœ‰å‰¯ä½œç”¨ä»£ç çš„å‡½æ•°ã€‚</p>
<p>åœ¨å‡½æ•°ç»„ä»¶ä¸»ä½“å†…ï¼ˆè¿™é‡ŒæŒ‡åœ¨ React æ¸²æŸ“é˜¶æ®µï¼‰æ”¹å˜ DOMã€æ·»åŠ è®¢é˜…ã€è®¾ç½®å®šæ—¶å™¨ã€è®°å½•æ—¥å¿—ä»¥åŠæ‰§è¡Œå…¶ä»–åŒ…å«å‰¯ä½œç”¨çš„æ“ä½œéƒ½æ˜¯ä¸è¢«å…è®¸çš„ï¼Œå› ä¸ºè¿™å¯èƒ½ä¼šäº§ç”Ÿè«åå…¶å¦™çš„ bug å¹¶ç ´å UI çš„ä¸€è‡´æ€§ã€‚</p>
<p>ä½¿ç”¨ <code>useEffect</code> å®Œæˆå‰¯ä½œç”¨æ“ä½œã€‚èµ‹å€¼ç»™ <code>useEffect</code> çš„å‡½æ•°ä¼šåœ¨ç»„ä»¶æ¸²æŸ“åˆ°å±å¹•ä¹‹åæ‰§è¡Œã€‚ä½ å¯ä»¥æŠŠ effect çœ‹ä½œä» React çš„çº¯å‡½æ•°å¼ä¸–ç•Œé€šå¾€å‘½ä»¤å¼ä¸–ç•Œçš„é€ƒç”Ÿé€šé“ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œeffect å°†åœ¨æ¯è½®æ¸²æŸ“ç»“æŸåæ‰§è¡Œï¼Œä½†ä½ å¯ä»¥é€‰æ‹©è®©å®ƒ <a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#conditionally-firing-an-effect" target="_blank" rel="noopener noreferrer">åœ¨åªæœ‰æŸäº›å€¼æ”¹å˜çš„æ—¶å€™</a> æ‰æ‰§è¡Œã€‚</p>
<h6 id="æ¸…é™¤-effect" class="headerLink">
    <a href="#%e6%b8%85%e9%99%a4-effect" class="header-mark"></a>æ¸…é™¤ effect</h6><p>é€šå¸¸ï¼Œç»„ä»¶å¸è½½æ—¶éœ€è¦æ¸…é™¤ effect åˆ›å»ºçš„è¯¸å¦‚è®¢é˜…æˆ–è®¡æ—¶å™¨ ID ç­‰èµ„æºã€‚è¦å®ç°è¿™ä¸€ç‚¹ï¼Œ<code>useEffect</code> å‡½æ•°éœ€è¿”å›ä¸€ä¸ªæ¸…é™¤å‡½æ•°ã€‚ä»¥ä¸‹å°±æ˜¯ä¸€ä¸ªåˆ›å»ºè®¢é˜…çš„ä¾‹å­ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">useEffect</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">subscription</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">subscribe</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">//</span> <span class="err">æ¸…é™¤è®¢é˜…</span>
</span></span><span class="line"><span class="cl">    <span class="n">subscription</span><span class="o">.</span><span class="n">unsubscribe</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">};</span>
</span></span><span class="line"><span class="cl"><span class="p">});</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ä¸ºé˜²æ­¢å†…å­˜æ³„æ¼ï¼Œæ¸…é™¤å‡½æ•°ä¼šåœ¨ç»„ä»¶å¸è½½å‰æ‰§è¡Œã€‚å¦å¤–ï¼Œå¦‚æœç»„ä»¶å¤šæ¬¡æ¸²æŸ“ï¼ˆé€šå¸¸å¦‚æ­¤ï¼‰ï¼Œåˆ™<strong>åœ¨æ‰§è¡Œä¸‹ä¸€ä¸ª effect ä¹‹å‰ï¼Œä¸Šä¸€ä¸ª effect å°±å·²è¢«æ¸…é™¤</strong>ã€‚åœ¨ä¸Šè¿°ç¤ºä¾‹ä¸­ï¼Œæ„å‘³ç€ç»„ä»¶çš„æ¯ä¸€æ¬¡æ›´æ–°éƒ½ä¼šåˆ›å»ºæ–°çš„è®¢é˜…ã€‚è‹¥æƒ³é¿å…æ¯æ¬¡æ›´æ–°éƒ½è§¦å‘ effect çš„æ‰§è¡Œï¼Œè¯·å‚é˜…ä¸‹ä¸€å°èŠ‚ã€‚</p>
<h6 id="effect-çš„æ‰§è¡Œæ—¶æœº" class="headerLink">
    <a href="#effect-%e7%9a%84%e6%89%a7%e8%a1%8c%e6%97%b6%e6%9c%ba" class="header-mark"></a>effect çš„æ‰§è¡Œæ—¶æœº</h6><p>ä¸ <code>componentDidMount</code>ã€<code>componentDidUpdate</code> ä¸åŒçš„æ˜¯ï¼Œä¼ ç»™ <code>useEffect</code> çš„å‡½æ•°ä¼šåœ¨æµè§ˆå™¨å®Œæˆå¸ƒå±€ä¸ç»˜åˆ¶<strong>ä¹‹å</strong>ï¼Œåœ¨ä¸€ä¸ªå»¶è¿Ÿäº‹ä»¶ä¸­è¢«è°ƒç”¨ã€‚è¿™ä½¿å¾—å®ƒé€‚ç”¨äºè®¸å¤šå¸¸è§çš„å‰¯ä½œç”¨åœºæ™¯ï¼Œæ¯”å¦‚è®¾ç½®è®¢é˜…å’Œäº‹ä»¶å¤„ç†ç­‰æƒ…å†µï¼Œå› ä¸ºç»å¤§å¤šæ•°æ“ä½œä¸åº”é˜»å¡æµè§ˆå™¨å¯¹å±å¹•çš„æ›´æ–°ã€‚</p>
<p>ç„¶è€Œï¼Œå¹¶éæ‰€æœ‰ effect éƒ½å¯ä»¥è¢«å»¶è¿Ÿæ‰§è¡Œã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå¯¹ç”¨æˆ·å¯è§çš„ DOM å˜æ›´å°±å¿…é¡»åœ¨æµè§ˆå™¨æ‰§è¡Œä¸‹ä¸€æ¬¡ç»˜åˆ¶å‰è¢«åŒæ­¥æ‰§è¡Œï¼Œè¿™æ ·ç”¨æˆ·æ‰ä¸ä¼šæ„Ÿè§‰åˆ°è§†è§‰ä¸Šçš„ä¸ä¸€è‡´ã€‚ï¼ˆæ¦‚å¿µä¸Šç±»ä¼¼äºè¢«åŠ¨ç›‘å¬äº‹ä»¶å’Œä¸»åŠ¨ç›‘å¬äº‹ä»¶çš„åŒºåˆ«ã€‚ï¼‰React ä¸ºæ­¤æä¾›äº†ä¸€ä¸ªé¢å¤–çš„ <a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#uselayouteffect" target="_blank" rel="noopener noreferrer"><code>useLayoutEffect</code></a> Hook æ¥å¤„ç†è¿™ç±» effectã€‚å®ƒå’Œ <code>useEffect</code> çš„ç»“æ„ç›¸åŒï¼ŒåŒºåˆ«åªæ˜¯è°ƒç”¨æ—¶æœºä¸åŒã€‚</p>
<p>æ­¤å¤–ï¼Œä» React 18 å¼€å§‹ï¼Œå½“å®ƒæ˜¯ç¦»æ•£çš„ç”¨æˆ·è¾“å…¥ï¼ˆå¦‚ç‚¹å‡»ï¼‰çš„ç»“æœæ—¶ï¼Œæˆ–è€…å½“å®ƒæ˜¯ç”± <a href="https://zh-hans.reactjs.org/docs/react-dom.html#flushsync" target="_blank" rel="noopener noreferrer"><code>flushSync</code></a> åŒ…è£…çš„æ›´æ–°ç»“æœæ—¶ï¼Œä¼ é€’ç»™ <code>useEffect</code> çš„å‡½æ•°å°†åœ¨å±å¹•å¸ƒå±€å’Œç»˜åˆ¶<strong>ä¹‹å‰</strong>åŒæ­¥æ‰§è¡Œã€‚è¿™ç§è¡Œä¸ºä¾¿äºäº‹ä»¶ç³»ç»Ÿæˆ– <a href="https://zh-hans.reactjs.org/docs/react-dom.html#flushsync" target="_blank" rel="noopener noreferrer"><code>flushSync</code></a> çš„è°ƒç”¨è€…è§‚å¯Ÿè¯¥æ•ˆæœçš„ç»“æœã€‚</p>
<blockquote>
<p>æ³¨æ„</p>
<p>è¿™åªå½±å“ä¼ é€’ç»™ <code>useEffect</code> çš„å‡½æ•°è¢«è°ƒç”¨æ—¶ â€” åœ¨è¿™äº› effect ä¸­æ‰§è¡Œçš„æ›´æ–°ä»ä¼šè¢«æ¨è¿Ÿã€‚è¿™ä¸ <a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#uselayouteffect" target="_blank" rel="noopener noreferrer"><code>useLayoutEffect</code></a> ä¸åŒï¼Œåè€…ä¼šç«‹å³å¯åŠ¨è¯¥å‡½æ•°å¹¶å¤„ç†å…¶ä¸­çš„æ›´æ–°ã€‚</p>
</blockquote>
<p>å³ä½¿åœ¨ <code>useEffect</code> è¢«æ¨è¿Ÿåˆ°æµè§ˆå™¨ç»˜åˆ¶ä¹‹åçš„æƒ…å†µä¸‹ï¼Œå®ƒä¹Ÿèƒ½ä¿è¯åœ¨ä»»ä½•æ–°çš„æ¸²æŸ“å‰å¯åŠ¨ã€‚React åœ¨å¼€å§‹æ–°çš„æ›´æ–°å‰ï¼Œæ€»ä¼šå…ˆåˆ·æ–°ä¹‹å‰çš„æ¸²æŸ“çš„ effectã€‚</p>
<h6 id="effect-çš„æ¡ä»¶æ‰§è¡Œ" class="headerLink">
    <a href="#effect-%e7%9a%84%e6%9d%a1%e4%bb%b6%e6%89%a7%e8%a1%8c" class="header-mark"></a>effect çš„æ¡ä»¶æ‰§è¡Œ</h6><p>é»˜è®¤æƒ…å†µä¸‹ï¼Œeffect ä¼šåœ¨æ¯è½®ç»„ä»¶æ¸²æŸ“å®Œæˆåæ‰§è¡Œã€‚è¿™æ ·çš„è¯ï¼Œä¸€æ—¦ effect çš„ä¾èµ–å‘ç”Ÿå˜åŒ–ï¼Œå®ƒå°±ä¼šè¢«é‡æ–°åˆ›å»ºã€‚</p>
<p>ç„¶è€Œï¼Œåœ¨æŸäº›åœºæ™¯ä¸‹è¿™ä¹ˆåšå¯èƒ½ä¼šçŸ«æ‰è¿‡æ­£ã€‚æ¯”å¦‚ï¼Œåœ¨ä¸Šä¸€ç« èŠ‚çš„è®¢é˜…ç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬ä¸éœ€è¦åœ¨æ¯æ¬¡ç»„ä»¶æ›´æ–°æ—¶éƒ½åˆ›å»ºæ–°çš„è®¢é˜…ï¼Œè€Œæ˜¯ä»…éœ€è¦åœ¨ <code>source</code> prop æ”¹å˜æ—¶é‡æ–°åˆ›å»ºã€‚</p>
<p>è¦å®ç°è¿™ä¸€ç‚¹ï¼Œå¯ä»¥ç»™ <code>useEffect</code> ä¼ é€’ç¬¬äºŒä¸ªå‚æ•°ï¼Œå®ƒæ˜¯ effect æ‰€ä¾èµ–çš„å€¼æ•°ç»„ã€‚æ›´æ–°åçš„ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">useEffect</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">const</span> <span class="n">subscription</span> <span class="o">=</span> <span class="n">props</span><span class="o">.</span><span class="n">source</span><span class="o">.</span><span class="n">subscribe</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">subscription</span><span class="o">.</span><span class="n">unsubscribe</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="n">props</span><span class="o">.</span><span class="n">source</span><span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ­¤æ—¶ï¼Œåªæœ‰å½“ <code>props.source</code> æ”¹å˜åæ‰ä¼šé‡æ–°åˆ›å»ºè®¢é˜…ã€‚</p>
<blockquote>
<p>æ³¨æ„</p>
<p>å¦‚æœä½ è¦ä½¿ç”¨æ­¤ä¼˜åŒ–æ–¹å¼ï¼Œè¯·ç¡®ä¿æ•°ç»„ä¸­åŒ…å«äº†<strong>æ‰€æœ‰å¤–éƒ¨ä½œç”¨åŸŸä¸­ä¼šå‘ç”Ÿå˜åŒ–ä¸”åœ¨ effect ä¸­ä½¿ç”¨çš„å˜é‡</strong>ï¼Œå¦åˆ™ä½ çš„ä»£ç ä¼šå¼•ç”¨åˆ°å…ˆå‰æ¸²æŸ“ä¸­çš„æ—§å˜é‡ã€‚è¯·å‚é˜…æ–‡æ¡£ï¼Œäº†è§£æ›´å¤šå…³äº<a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#is-it-safe-to-omit-functions-from-the-list-of-dependencies" target="_blank" rel="noopener noreferrer">å¦‚ä½•å¤„ç†å‡½æ•°</a> ä»¥åŠ<a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#what-can-i-do-if-my-effect-dependencies-change-too-often" target="_blank" rel="noopener noreferrer">æ•°ç»„é¢‘ç¹å˜åŒ–æ—¶çš„æªæ–½</a> çš„å†…å®¹ã€‚</p>
<p>å¦‚æœæƒ³æ‰§è¡Œåªè¿è¡Œä¸€æ¬¡çš„ effectï¼ˆä»…åœ¨ç»„ä»¶æŒ‚è½½å’Œå¸è½½æ—¶æ‰§è¡Œï¼‰ï¼Œå¯ä»¥ä¼ é€’ä¸€ä¸ªç©ºæ•°ç»„ï¼ˆ<code>[]</code>ï¼‰ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ã€‚è¿™å°±å‘Šè¯‰ React ä½ çš„ effect ä¸ä¾èµ–äº props æˆ– state ä¸­çš„ä»»ä½•å€¼ï¼Œæ‰€ä»¥å®ƒæ°¸è¿œéƒ½ä¸éœ€è¦é‡å¤æ‰§è¡Œã€‚è¿™å¹¶ä¸å±äºç‰¹æ®Šæƒ…å†µ â€”â€” å®ƒä¾ç„¶éµå¾ªè¾“å…¥æ•°ç»„çš„å·¥ä½œæ–¹å¼ã€‚</p>
<p>å¦‚æœä½ ä¼ å…¥äº†ä¸€ä¸ªç©ºæ•°ç»„ï¼ˆ<code>[]</code>ï¼‰ï¼Œeffect å†…éƒ¨çš„ props å’Œ state å°±ä¼šä¸€ç›´æŒæœ‰å…¶åˆå§‹å€¼ã€‚å°½ç®¡ä¼ å…¥ <code>[]</code> ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°æœ‰ç‚¹ç±»ä¼¼äº <code>componentDidMount</code> å’Œ <code>componentWillUnmount</code> çš„æ€ç»´æ¨¡å¼ï¼Œä½†æˆ‘ä»¬æœ‰ <a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#is-it-safe-to-omit-functions-from-the-list-of-dependencies" target="_blank" rel="noopener noreferrer">æ›´å¥½çš„</a> <a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#what-can-i-do-if-my-effect-dependencies-change-too-often" target="_blank" rel="noopener noreferrer">æ–¹å¼</a> æ¥é¿å…è¿‡äºé¢‘ç¹çš„é‡å¤è°ƒç”¨ effectã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¯·è®°å¾— React ä¼šç­‰å¾…æµè§ˆå™¨å®Œæˆç”»é¢æ¸²æŸ“ä¹‹åæ‰ä¼šå»¶è¿Ÿè°ƒç”¨ <code>useEffect</code>ï¼Œå› æ­¤ä¼šä½¿å¾—å¤„ç†é¢å¤–æ“ä½œå¾ˆæ–¹ä¾¿ã€‚</p>
<p>æˆ‘ä»¬æ¨èå¯ç”¨ <a href="https://www.npmjs.com/package/eslint-plugin-react-hooks#installation" target="_blank" rel="noopener noreferrer"><code>eslint-plugin-react-hooks</code></a> ä¸­çš„ <a href="https://github.com/facebook/react/issues/14920" target="_blank" rel="noopener noreferrer"><code>exhaustive-deps</code></a> è§„åˆ™ã€‚æ­¤è§„åˆ™ä¼šåœ¨æ·»åŠ é”™è¯¯ä¾èµ–æ—¶å‘å‡ºè­¦å‘Šå¹¶ç»™å‡ºä¿®å¤å»ºè®®ã€‚</p>
</blockquote>
<p>ä¾èµ–é¡¹æ•°ç»„ä¸ä¼šä½œä¸ºå‚æ•°ä¼ ç»™ effect å‡½æ•°ã€‚è™½ç„¶ä»æ¦‚å¿µä¸Šæ¥è¯´å®ƒè¡¨ç°ä¸ºï¼šæ‰€æœ‰ effect å‡½æ•°ä¸­å¼•ç”¨çš„å€¼éƒ½åº”è¯¥å‡ºç°åœ¨ä¾èµ–é¡¹æ•°ç»„ä¸­ã€‚æœªæ¥ç¼–è¯‘å™¨ä¼šæ›´åŠ æ™ºèƒ½ï¼Œå±Šæ—¶è‡ªåŠ¨åˆ›å»ºæ•°ç»„å°†æˆä¸ºå¯èƒ½ã€‚</p>
<h5 id="usecontext" class="headerLink">
    <a href="#usecontext" class="header-mark"></a><code>useContext</code></h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">const</span> <span class="n">value</span> <span class="o">=</span> <span class="n">useContext</span><span class="p">(</span><span class="n">MyContext</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>æ¥æ”¶ä¸€ä¸ª context å¯¹è±¡ï¼ˆ<code>React.createContext</code> çš„è¿”å›å€¼ï¼‰å¹¶è¿”å›è¯¥ context çš„å½“å‰å€¼ã€‚å½“å‰çš„ context å€¼ç”±ä¸Šå±‚ç»„ä»¶ä¸­è·ç¦»å½“å‰ç»„ä»¶æœ€è¿‘çš„ <code>&lt;MyContext.Provider&gt;</code> çš„ <code>value</code> prop å†³å®šã€‚</p>
<p>å½“ç»„ä»¶ä¸Šå±‚æœ€è¿‘çš„ <code>&lt;MyContext.Provider&gt;</code> æ›´æ–°æ—¶ï¼Œè¯¥ Hook ä¼šè§¦å‘é‡æ¸²æŸ“ï¼Œå¹¶ä½¿ç”¨æœ€æ–°ä¼ é€’ç»™ <code>MyContext</code> provider çš„ context <code>value</code> å€¼ã€‚å³ä½¿ç¥–å…ˆä½¿ç”¨ <a href="https://zh-hans.reactjs.org/docs/react-api.html#reactmemo" target="_blank" rel="noopener noreferrer"><code>React.memo</code></a> æˆ– <a href="https://zh-hans.reactjs.org/docs/react-component.html#shouldcomponentupdate" target="_blank" rel="noopener noreferrer"><code>shouldComponentUpdate</code></a>ï¼Œä¹Ÿä¼šåœ¨ç»„ä»¶æœ¬èº«ä½¿ç”¨ <code>useContext</code> æ—¶é‡æ–°æ¸²æŸ“ã€‚</p>
<p>åˆ«å¿˜è®° <code>useContext</code> çš„å‚æ•°å¿…é¡»æ˜¯ <em>context å¯¹è±¡æœ¬èº«</em>ï¼š</p>
<ul>
<li><strong>æ­£ç¡®ï¼š</strong> <code>useContext(MyContext)</code></li>
<li><strong>é”™è¯¯ï¼š</strong> <code>useContext(MyContext.Consumer)</code></li>
<li><strong>é”™è¯¯ï¼š</strong> <code>useContext(MyContext.Provider)</code></li>
</ul>
<p>è°ƒç”¨äº† <code>useContext</code> çš„ç»„ä»¶æ€»ä¼šåœ¨ context å€¼å˜åŒ–æ—¶é‡æ–°æ¸²æŸ“ã€‚å¦‚æœé‡æ¸²æŸ“ç»„ä»¶çš„å¼€é”€è¾ƒå¤§ï¼Œä½ å¯ä»¥ <a href="https://github.com/facebook/react/issues/15156#issuecomment-474590693" target="_blank" rel="noopener noreferrer">é€šè¿‡ä½¿ç”¨ memoization æ¥ä¼˜åŒ–</a>ã€‚</p>
<blockquote>
<p>æç¤º</p>
<p>å¦‚æœä½ åœ¨æ¥è§¦ Hook å‰å·²ç»å¯¹ context API æ¯”è¾ƒç†Ÿæ‚‰ï¼Œé‚£åº”è¯¥å¯ä»¥ç†è§£ï¼Œ<code>useContext(MyContext)</code> ç›¸å½“äº class ç»„ä»¶ä¸­çš„ <code>static contextType = MyContext</code> æˆ–è€… <code>&lt;MyContext.Consumer&gt;</code>ã€‚</p>
<p><code>useContext(MyContext)</code> åªæ˜¯è®©ä½ èƒ½å¤Ÿ<em>è¯»å–</em> context çš„å€¼ä»¥åŠè®¢é˜… context çš„å˜åŒ–ã€‚ä½ ä»ç„¶éœ€è¦åœ¨ä¸Šå±‚ç»„ä»¶æ ‘ä¸­ä½¿ç”¨ <code>&lt;MyContext.Provider&gt;</code> æ¥ä¸ºä¸‹å±‚ç»„ä»¶<em>æä¾›</em> contextã€‚</p>
</blockquote>
<p><strong>æŠŠå¦‚ä¸‹ä»£ç ä¸ Context.Provider æ”¾åœ¨ä¸€èµ·</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">const</span> <span class="n">themes</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">light</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">foreground</span><span class="p">:</span> <span class="s2">&#34;#000000&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">background</span><span class="p">:</span> <span class="s2">&#34;#eeeeee&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="n">dark</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">foreground</span><span class="p">:</span> <span class="s2">&#34;#ffffff&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="n">background</span><span class="p">:</span> <span class="s2">&#34;#222222&#34;</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="n">ThemeContext</span> <span class="o">=</span> <span class="n">React</span><span class="o">.</span><span class="n">createContext</span><span class="p">(</span><span class="n">themes</span><span class="o">.</span><span class="n">light</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">App</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">ThemeContext</span><span class="o">.</span><span class="n">Provider</span> <span class="n">value</span><span class="o">=</span><span class="p">{</span><span class="n">themes</span><span class="o">.</span><span class="n">dark</span><span class="p">}</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">Toolbar</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">ThemeContext</span><span class="o">.</span><span class="n">Provider</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">Toolbar</span><span class="p">(</span><span class="n">props</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">ThemedButton</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">ThemedButton</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">theme</span> <span class="o">=</span> <span class="n">useContext</span><span class="p">(</span><span class="n">ThemeContext</span><span class="p">);</span>  <span class="k">return</span> <span class="p">(</span>    <span class="o">&lt;</span><span class="n">button</span> <span class="n">style</span><span class="o">=</span><span class="p">{{</span> <span class="n">background</span><span class="p">:</span> <span class="n">theme</span><span class="o">.</span><span class="n">background</span><span class="p">,</span> <span class="n">color</span><span class="p">:</span> <span class="n">theme</span><span class="o">.</span><span class="n">foreground</span> <span class="p">}}</span><span class="o">&gt;</span>      <span class="n">I</span> <span class="n">am</span> <span class="n">styled</span> <span class="n">by</span> <span class="n">theme</span> <span class="n">context</span><span class="o">!</span>    <span class="o">&lt;/</span><span class="n">button</span><span class="o">&gt;</span>  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯¹å…ˆå‰ <a href="https://zh-hans.reactjs.org/docs/context.html" target="_blank" rel="noopener noreferrer">Context é«˜çº§æŒ‡å—</a>ä¸­çš„ç¤ºä¾‹ä½¿ç”¨ hook è¿›è¡Œäº†ä¿®æ”¹ï¼Œä½ å¯ä»¥åœ¨é“¾æ¥ä¸­æ‰¾åˆ°æœ‰å…³å¦‚ä½• Context çš„æ›´å¤šä¿¡æ¯ã€‚</p>
<h4 id="é¢å¤–çš„-hook" class="headerLink">
    <a href="#%e9%a2%9d%e5%a4%96%e7%9a%84-hook" class="header-mark"></a>é¢å¤–çš„ Hook</h4><p>ä»¥ä¸‹ä»‹ç»çš„ Hookï¼Œæœ‰äº›æ˜¯ä¸Šä¸€èŠ‚ä¸­åŸºç¡€ Hook çš„å˜ä½“ï¼Œæœ‰äº›åˆ™ä»…åœ¨ç‰¹æ®Šæƒ…å†µä¸‹ä¼šç”¨åˆ°ã€‚ä¸ç”¨ç‰¹æ„é¢„å…ˆå­¦ä¹ å®ƒä»¬ã€‚</p>
<h5 id="usereducer" class="headerLink">
    <a href="#usereducer" class="header-mark"></a><code>useReducer</code></h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">const</span> <span class="p">[</span><span class="n">state</span><span class="p">,</span> <span class="n">dispatch</span><span class="p">]</span> <span class="o">=</span> <span class="n">useReducer</span><span class="p">(</span><span class="n">reducer</span><span class="p">,</span> <span class="n">initialArg</span><span class="p">,</span> <span class="n">init</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#usestate" target="_blank" rel="noopener noreferrer"><code>useState</code></a> çš„æ›¿ä»£æ–¹æ¡ˆã€‚å®ƒæ¥æ”¶ä¸€ä¸ªå½¢å¦‚ <code>(state, action) =&gt; newState</code> çš„ reducerï¼Œå¹¶è¿”å›å½“å‰çš„ state ä»¥åŠä¸å…¶é…å¥—çš„ <code>dispatch</code> æ–¹æ³•ã€‚ï¼ˆå¦‚æœä½ ç†Ÿæ‚‰ Redux çš„è¯ï¼Œå°±å·²ç»çŸ¥é“å®ƒå¦‚ä½•å·¥ä½œäº†ã€‚ï¼‰</p>
<p>åœ¨æŸäº›åœºæ™¯ä¸‹ï¼Œ<code>useReducer</code> ä¼šæ¯” <code>useState</code> æ›´é€‚ç”¨ï¼Œä¾‹å¦‚ state é€»è¾‘è¾ƒå¤æ‚ä¸”åŒ…å«å¤šä¸ªå­å€¼ï¼Œæˆ–è€…ä¸‹ä¸€ä¸ª state ä¾èµ–äºä¹‹å‰çš„ state ç­‰ã€‚å¹¶ä¸”ï¼Œä½¿ç”¨ <code>useReducer</code> è¿˜èƒ½ç»™é‚£äº›ä¼šè§¦å‘æ·±æ›´æ–°çš„ç»„ä»¶åšæ€§èƒ½ä¼˜åŒ–ï¼Œå› ä¸º<a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#how-to-avoid-passing-callbacks-down" target="_blank" rel="noopener noreferrer">ä½ å¯ä»¥å‘å­ç»„ä»¶ä¼ é€’ <code>dispatch</code> è€Œä¸æ˜¯å›è°ƒå‡½æ•°</a> ã€‚</p>
<p>ä»¥ä¸‹æ˜¯ç”¨ reducer é‡å†™ <a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#usestate" target="_blank" rel="noopener noreferrer"><code>useState</code></a> ä¸€èŠ‚çš„è®¡æ•°å™¨ç¤ºä¾‹ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">const</span> <span class="n">initialState</span> <span class="o">=</span> <span class="p">{</span><span class="n">count</span><span class="p">:</span> <span class="mi">0</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">reducer</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="p">(</span><span class="n">action</span><span class="o">.</span><span class="n">type</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s1">&#39;increment&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="p">{</span><span class="n">count</span><span class="p">:</span> <span class="n">state</span><span class="o">.</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s1">&#39;decrement&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="p">{</span><span class="n">count</span><span class="p">:</span> <span class="n">state</span><span class="o">.</span><span class="n">count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="n">default</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">throw</span> <span class="n">new</span> <span class="n">Error</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">Counter</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">state</span><span class="p">,</span> <span class="n">dispatch</span><span class="p">]</span> <span class="o">=</span> <span class="n">useReducer</span><span class="p">(</span><span class="n">reducer</span><span class="p">,</span> <span class="n">initialState</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="n">Count</span><span class="p">:</span> <span class="p">{</span><span class="n">state</span><span class="o">.</span><span class="n">count</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">button</span> <span class="n">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="n">dispatch</span><span class="p">({</span><span class="n">type</span><span class="p">:</span> <span class="s1">&#39;decrement&#39;</span><span class="p">})}</span><span class="o">&gt;-&lt;/</span><span class="n">button</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">button</span> <span class="n">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="n">dispatch</span><span class="p">({</span><span class="n">type</span><span class="p">:</span> <span class="s1">&#39;increment&#39;</span><span class="p">})}</span><span class="o">&gt;+&lt;/</span><span class="n">button</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>æ³¨æ„</p>
<p>React ä¼šç¡®ä¿ <code>dispatch</code> å‡½æ•°çš„æ ‡è¯†æ˜¯ç¨³å®šçš„ï¼Œå¹¶ä¸”ä¸ä¼šåœ¨ç»„ä»¶é‡æ–°æ¸²æŸ“æ—¶æ”¹å˜ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆå¯ä»¥å®‰å…¨åœ°ä» <code>useEffect</code> æˆ– <code>useCallback</code> çš„ä¾èµ–åˆ—è¡¨ä¸­çœç•¥ <code>dispatch</code>ã€‚</p>
</blockquote>
<h6 id="æŒ‡å®šåˆå§‹-state" class="headerLink">
    <a href="#%e6%8c%87%e5%ae%9a%e5%88%9d%e5%a7%8b-state" class="header-mark"></a>æŒ‡å®šåˆå§‹ state</h6><p>æœ‰ä¸¤ç§ä¸åŒåˆå§‹åŒ– <code>useReducer</code> state çš„æ–¹å¼ï¼Œä½ å¯ä»¥æ ¹æ®ä½¿ç”¨åœºæ™¯é€‰æ‹©å…¶ä¸­çš„ä¸€ç§ã€‚å°†åˆå§‹ state ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ <code>useReducer</code> æ˜¯æœ€ç®€å•çš„æ–¹æ³•ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">state</span><span class="p">,</span> <span class="n">dispatch</span><span class="p">]</span> <span class="o">=</span> <span class="n">useReducer</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="n">reducer</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">{</span><span class="n">count</span><span class="p">:</span> <span class="n">initialCount</span><span class="p">}</span>  <span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>æ³¨æ„</p>
<p>React ä¸ä½¿ç”¨ <code>state = initialState</code> è¿™ä¸€ç”± Redux æ¨å¹¿å¼€æ¥çš„å‚æ•°çº¦å®šã€‚æœ‰æ—¶å€™åˆå§‹å€¼ä¾èµ–äº propsï¼Œå› æ­¤éœ€è¦åœ¨è°ƒç”¨ Hook æ—¶æŒ‡å®šã€‚å¦‚æœä½ ç‰¹åˆ«å–œæ¬¢ä¸Šè¿°çš„å‚æ•°çº¦å®šï¼Œå¯ä»¥é€šè¿‡è°ƒç”¨ <code>useReducer(reducer, undefined, reducer)</code> æ¥æ¨¡æ‹Ÿ Redux çš„è¡Œä¸ºï¼Œä½†æˆ‘ä»¬ä¸é¼“åŠ±ä½ è¿™ä¹ˆåšã€‚</p>
</blockquote>
<h6 id="æƒ°æ€§åˆå§‹åŒ–" class="headerLink">
    <a href="#%e6%83%b0%e6%80%a7%e5%88%9d%e5%a7%8b%e5%8c%96" class="header-mark"></a>æƒ°æ€§åˆå§‹åŒ–</h6><p>ä½ å¯ä»¥é€‰æ‹©æƒ°æ€§åœ°åˆ›å»ºåˆå§‹ stateã€‚ä¸ºæ­¤ï¼Œéœ€è¦å°† <code>init</code> å‡½æ•°ä½œä¸º <code>useReducer</code> çš„ç¬¬ä¸‰ä¸ªå‚æ•°ä¼ å…¥ï¼Œè¿™æ ·åˆå§‹ state å°†è¢«è®¾ç½®ä¸º <code>init(initialArg)</code>ã€‚</p>
<p>è¿™ä¹ˆåšå¯ä»¥å°†ç”¨äºè®¡ç®— state çš„é€»è¾‘æå–åˆ° reducer å¤–éƒ¨ï¼Œè¿™ä¹Ÿä¸ºå°†æ¥å¯¹é‡ç½® state çš„ action åšå¤„ç†æä¾›äº†ä¾¿åˆ©ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">init</span><span class="p">(</span><span class="n">initialCount</span><span class="p">)</span> <span class="p">{</span>  <span class="k">return</span> <span class="p">{</span><span class="n">count</span><span class="p">:</span> <span class="n">initialCount</span><span class="p">};}</span>
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">reducer</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">switch</span> <span class="p">(</span><span class="n">action</span><span class="o">.</span><span class="n">type</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s1">&#39;increment&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="p">{</span><span class="n">count</span><span class="p">:</span> <span class="n">state</span><span class="o">.</span><span class="n">count</span> <span class="o">+</span> <span class="mi">1</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s1">&#39;decrement&#39;</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="p">{</span><span class="n">count</span><span class="p">:</span> <span class="n">state</span><span class="o">.</span><span class="n">count</span> <span class="o">-</span> <span class="mi">1</span><span class="p">};</span>
</span></span><span class="line"><span class="cl">    <span class="k">case</span> <span class="s1">&#39;reset&#39;</span><span class="p">:</span>      <span class="k">return</span> <span class="n">init</span><span class="p">(</span><span class="n">action</span><span class="o">.</span><span class="n">payload</span><span class="p">);</span>    <span class="n">default</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">      <span class="n">throw</span> <span class="n">new</span> <span class="n">Error</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">function</span> <span class="n">Counter</span><span class="p">({</span><span class="n">initialCount</span><span class="p">})</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">state</span><span class="p">,</span> <span class="n">dispatch</span><span class="p">]</span> <span class="o">=</span> <span class="n">useReducer</span><span class="p">(</span><span class="n">reducer</span><span class="p">,</span> <span class="n">initialCount</span><span class="p">,</span> <span class="n">init</span><span class="p">);</span>  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="n">Count</span><span class="p">:</span> <span class="p">{</span><span class="n">state</span><span class="o">.</span><span class="n">count</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">button</span>
</span></span><span class="line"><span class="cl">        <span class="n">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="n">dispatch</span><span class="p">({</span><span class="n">type</span><span class="p">:</span> <span class="s1">&#39;reset&#39;</span><span class="p">,</span> <span class="n">payload</span><span class="p">:</span> <span class="n">initialCount</span><span class="p">})}</span><span class="o">&gt;</span>        <span class="n">Reset</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;/</span><span class="n">button</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">button</span> <span class="n">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="n">dispatch</span><span class="p">({</span><span class="n">type</span><span class="p">:</span> <span class="s1">&#39;decrement&#39;</span><span class="p">})}</span><span class="o">&gt;-&lt;/</span><span class="n">button</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">button</span> <span class="n">onClick</span><span class="o">=</span><span class="p">{()</span> <span class="o">=&gt;</span> <span class="n">dispatch</span><span class="p">({</span><span class="n">type</span><span class="p">:</span> <span class="s1">&#39;increment&#39;</span><span class="p">})}</span><span class="o">&gt;+&lt;/</span><span class="n">button</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h6 id="è·³è¿‡-dispatch" class="headerLink">
    <a href="#%e8%b7%b3%e8%bf%87-dispatch" class="header-mark"></a>è·³è¿‡ dispatch</h6><p>å¦‚æœ Reducer Hook çš„è¿”å›å€¼ä¸å½“å‰ state ç›¸åŒï¼ŒReact å°†è·³è¿‡å­ç»„ä»¶çš„æ¸²æŸ“åŠå‰¯ä½œç”¨çš„æ‰§è¡Œã€‚ï¼ˆReact ä½¿ç”¨ <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/is#Description" target="_blank" rel="noopener noreferrer"><code>Object.is</code> æ¯”è¾ƒç®—æ³•</a> æ¥æ¯”è¾ƒ stateã€‚ï¼‰</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒReact å¯èƒ½ä»éœ€è¦åœ¨è·³è¿‡æ¸²æŸ“å‰å†æ¬¡æ¸²æŸ“è¯¥ç»„ä»¶ã€‚ä¸è¿‡ç”±äº React ä¸ä¼šå¯¹ç»„ä»¶æ ‘çš„â€œæ·±å±‚â€èŠ‚ç‚¹è¿›è¡Œä¸å¿…è¦çš„æ¸²æŸ“ï¼Œæ‰€ä»¥å¤§å¯ä¸å¿…æ‹…å¿ƒã€‚å¦‚æœä½ åœ¨æ¸²æŸ“æœŸé—´æ‰§è¡Œäº†é«˜å¼€é”€çš„è®¡ç®—ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ <code>useMemo</code> æ¥è¿›è¡Œä¼˜åŒ–ã€‚</p>
<h5 id="usecallback" class="headerLink">
    <a href="#usecallback" class="header-mark"></a><code>useCallback</code></h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">const</span> <span class="n">memoizedCallback</span> <span class="o">=</span> <span class="n">useCallback</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">doSomething</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="p">},</span>
</span></span><span class="line"><span class="cl">  <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">],</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿”å›ä¸€ä¸ª <a href="https://en.wikipedia.org/wiki/Memoization" target="_blank" rel="noopener noreferrer">memoized</a> å›è°ƒå‡½æ•°ã€‚</p>
<p>æŠŠå†…è”å›è°ƒå‡½æ•°åŠä¾èµ–é¡¹æ•°ç»„ä½œä¸ºå‚æ•°ä¼ å…¥ <code>useCallback</code>ï¼Œå®ƒå°†è¿”å›è¯¥å›è°ƒå‡½æ•°çš„ memoized ç‰ˆæœ¬ï¼Œè¯¥å›è°ƒå‡½æ•°ä»…åœ¨æŸä¸ªä¾èµ–é¡¹æ”¹å˜æ—¶æ‰ä¼šæ›´æ–°ã€‚å½“ä½ æŠŠå›è°ƒå‡½æ•°ä¼ é€’ç»™ç»è¿‡ä¼˜åŒ–çš„å¹¶ä½¿ç”¨å¼•ç”¨ç›¸ç­‰æ€§å»é¿å…éå¿…è¦æ¸²æŸ“ï¼ˆä¾‹å¦‚ <code>shouldComponentUpdate</code>ï¼‰çš„å­ç»„ä»¶æ—¶ï¼Œå®ƒå°†éå¸¸æœ‰ç”¨ã€‚</p>
<p><code>useCallback(fn, deps)</code> ç›¸å½“äº <code>useMemo(() =&gt; fn, deps)</code>ã€‚</p>
<blockquote>
<p>æ³¨æ„</p>
<p>ä¾èµ–é¡¹æ•°ç»„ä¸ä¼šä½œä¸ºå‚æ•°ä¼ ç»™å›è°ƒå‡½æ•°ã€‚è™½ç„¶ä»æ¦‚å¿µä¸Šæ¥è¯´å®ƒè¡¨ç°ä¸ºï¼šæ‰€æœ‰å›è°ƒå‡½æ•°ä¸­å¼•ç”¨çš„å€¼éƒ½åº”è¯¥å‡ºç°åœ¨ä¾èµ–é¡¹æ•°ç»„ä¸­ã€‚æœªæ¥ç¼–è¯‘å™¨ä¼šæ›´åŠ æ™ºèƒ½ï¼Œå±Šæ—¶è‡ªåŠ¨åˆ›å»ºæ•°ç»„å°†æˆä¸ºå¯èƒ½ã€‚</p>
<p>æˆ‘ä»¬æ¨èå¯ç”¨ <a href="https://www.npmjs.com/package/eslint-plugin-react-hooks#installation" target="_blank" rel="noopener noreferrer"><code>eslint-plugin-react-hooks</code></a> ä¸­çš„ <a href="https://github.com/facebook/react/issues/14920" target="_blank" rel="noopener noreferrer"><code>exhaustive-deps</code></a> è§„åˆ™ã€‚æ­¤è§„åˆ™ä¼šåœ¨æ·»åŠ é”™è¯¯ä¾èµ–æ—¶å‘å‡ºè­¦å‘Šå¹¶ç»™å‡ºä¿®å¤å»ºè®®ã€‚</p>
</blockquote>
<h5 id="usememo" class="headerLink">
    <a href="#usememo" class="header-mark"></a><code>useMemo</code></h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">const</span> <span class="n">memoizedValue</span> <span class="o">=</span> <span class="n">useMemo</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="n">computeExpensiveValue</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">),</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">]);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿”å›ä¸€ä¸ª <a href="https://en.wikipedia.org/wiki/Memoization" target="_blank" rel="noopener noreferrer">memoized</a> å€¼ã€‚</p>
<p>æŠŠâ€œåˆ›å»ºâ€å‡½æ•°å’Œä¾èµ–é¡¹æ•°ç»„ä½œä¸ºå‚æ•°ä¼ å…¥ <code>useMemo</code>ï¼Œå®ƒä»…ä¼šåœ¨æŸä¸ªä¾èµ–é¡¹æ”¹å˜æ—¶æ‰é‡æ–°è®¡ç®— memoized å€¼ã€‚è¿™ç§ä¼˜åŒ–æœ‰åŠ©äºé¿å…åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½è¿›è¡Œé«˜å¼€é”€çš„è®¡ç®—ã€‚</p>
<p>è®°ä½ï¼Œä¼ å…¥ <code>useMemo</code> çš„å‡½æ•°ä¼šåœ¨æ¸²æŸ“æœŸé—´æ‰§è¡Œã€‚è¯·ä¸è¦åœ¨è¿™ä¸ªå‡½æ•°å†…éƒ¨æ‰§è¡Œä¸åº”è¯¥åœ¨æ¸²æŸ“æœŸé—´å†…æ‰§è¡Œçš„æ“ä½œï¼Œè¯¸å¦‚å‰¯ä½œç”¨è¿™ç±»çš„æ“ä½œå±äº <code>useEffect</code> çš„é€‚ç”¨èŒƒç•´ï¼Œè€Œä¸æ˜¯ <code>useMemo</code>ã€‚</p>
<p>å¦‚æœæ²¡æœ‰æä¾›ä¾èµ–é¡¹æ•°ç»„ï¼Œ<code>useMemo</code> åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½ä¼šè®¡ç®—æ–°çš„å€¼ã€‚</p>
<p>**ä½ å¯ä»¥æŠŠ <code>useMemo</code> ä½œä¸ºæ€§èƒ½ä¼˜åŒ–çš„æ‰‹æ®µï¼Œä½†ä¸è¦æŠŠå®ƒå½“æˆè¯­ä¹‰ä¸Šçš„ä¿è¯ã€‚**å°†æ¥ï¼ŒReact å¯èƒ½ä¼šé€‰æ‹©â€œé—å¿˜â€ä»¥å‰çš„ä¸€äº› memoized å€¼ï¼Œå¹¶åœ¨ä¸‹æ¬¡æ¸²æŸ“æ—¶é‡æ–°è®¡ç®—å®ƒä»¬ï¼Œæ¯”å¦‚ä¸ºç¦»å±ç»„ä»¶é‡Šæ”¾å†…å­˜ã€‚å…ˆç¼–å†™åœ¨æ²¡æœ‰ <code>useMemo</code> çš„æƒ…å†µä¸‹ä¹Ÿå¯ä»¥æ‰§è¡Œçš„ä»£ç  â€”â€” ä¹‹åå†åœ¨ä½ çš„ä»£ç ä¸­æ·»åŠ  <code>useMemo</code>ï¼Œä»¥è¾¾åˆ°ä¼˜åŒ–æ€§èƒ½çš„ç›®çš„ã€‚</p>
<blockquote>
<p>æ³¨æ„</p>
<p>ä¾èµ–é¡¹æ•°ç»„ä¸ä¼šä½œä¸ºå‚æ•°ä¼ ç»™â€œåˆ›å»ºâ€å‡½æ•°ã€‚è™½ç„¶ä»æ¦‚å¿µä¸Šæ¥è¯´å®ƒè¡¨ç°ä¸ºï¼šæ‰€æœ‰â€œåˆ›å»ºâ€å‡½æ•°ä¸­å¼•ç”¨çš„å€¼éƒ½åº”è¯¥å‡ºç°åœ¨ä¾èµ–é¡¹æ•°ç»„ä¸­ã€‚æœªæ¥ç¼–è¯‘å™¨ä¼šæ›´åŠ æ™ºèƒ½ï¼Œå±Šæ—¶è‡ªåŠ¨åˆ›å»ºæ•°ç»„å°†æˆä¸ºå¯èƒ½ã€‚</p>
<p>æˆ‘ä»¬æ¨èå¯ç”¨ <a href="https://www.npmjs.com/package/eslint-plugin-react-hooks#installation" target="_blank" rel="noopener noreferrer"><code>eslint-plugin-react-hooks</code></a> ä¸­çš„ <a href="https://github.com/facebook/react/issues/14920" target="_blank" rel="noopener noreferrer"><code>exhaustive-deps</code></a> è§„åˆ™ã€‚æ­¤è§„åˆ™ä¼šåœ¨æ·»åŠ é”™è¯¯ä¾èµ–æ—¶å‘å‡ºè­¦å‘Šå¹¶ç»™å‡ºä¿®å¤å»ºè®®ã€‚</p>
</blockquote>
<h5 id="useref" class="headerLink">
    <a href="#useref" class="header-mark"></a><code>useRef</code></h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">const</span> <span class="n">refContainer</span> <span class="o">=</span> <span class="n">useRef</span><span class="p">(</span><span class="n">initialValue</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>useRef</code> è¿”å›ä¸€ä¸ªå¯å˜çš„ ref å¯¹è±¡ï¼Œå…¶ <code>.current</code> å±æ€§è¢«åˆå§‹åŒ–ä¸ºä¼ å…¥çš„å‚æ•°ï¼ˆ<code>initialValue</code>ï¼‰ã€‚è¿”å›çš„ ref å¯¹è±¡åœ¨ç»„ä»¶çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…æŒç»­å­˜åœ¨ã€‚</p>
<p>ä¸€ä¸ªå¸¸è§çš„ç”¨ä¾‹ä¾¿æ˜¯å‘½ä»¤å¼åœ°è®¿é—®å­ç»„ä»¶ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-mysql" data-lang="mysql"><span class="line"><span class="cl"><span class="n">function</span><span class="w"> </span><span class="nf">TextInputWithFocusButton</span><span class="p">()</span><span class="w"> </span><span class="err">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">const</span><span class="w"> </span><span class="n">inputEl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">useRef</span><span class="p">(</span><span class="no">null</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">const</span><span class="w"> </span><span class="n">onButtonClick</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="err">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="o">`</span><span class="n">current</span><span class="o">`</span><span class="w"> </span><span class="err">æŒ‡å‘å·²æŒ‚è½½åˆ°</span><span class="w"> </span><span class="n">DOM</span><span class="w"> </span><span class="err">ä¸Šçš„æ–‡æœ¬è¾“å…¥å…ƒç´ </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">inputEl</span><span class="p">.</span><span class="n">current</span><span class="p">.</span><span class="nf">focus</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="err">}</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">&lt;&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="o">&lt;</span><span class="n">input</span><span class="w"> </span><span class="n">ref</span><span class="o">=</span><span class="err">{</span><span class="n">inputEl</span><span class="err">}</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span><span class="w"> </span><span class="o">/&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="o">&lt;</span><span class="n">button</span><span class="w"> </span><span class="n">onClick</span><span class="o">=</span><span class="err">{</span><span class="n">onButtonClick</span><span class="err">}</span><span class="o">&gt;</span><span class="n">Focus</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">input</span><span class="o">&lt;/</span><span class="n">button</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">&lt;/&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>æœ¬è´¨ä¸Šï¼Œ<code>useRef</code> å°±åƒæ˜¯å¯ä»¥åœ¨å…¶ <code>.current</code> å±æ€§ä¸­ä¿å­˜ä¸€ä¸ªå¯å˜å€¼çš„â€œç›’å­â€ã€‚</p>
<p>ä½ åº”è¯¥ç†Ÿæ‚‰ ref è¿™ä¸€ç§<a href="https://zh-hans.reactjs.org/docs/refs-and-the-dom.html" target="_blank" rel="noopener noreferrer">è®¿é—® DOM</a> çš„ä¸»è¦æ–¹å¼ã€‚å¦‚æœä½ å°† ref å¯¹è±¡ä»¥ <code>&lt;div ref={myRef} /&gt;</code> å½¢å¼ä¼ å…¥ç»„ä»¶ï¼Œåˆ™æ— è®ºè¯¥èŠ‚ç‚¹å¦‚ä½•æ”¹å˜ï¼ŒReact éƒ½ä¼šå°† ref å¯¹è±¡çš„ <code>.current</code> å±æ€§è®¾ç½®ä¸ºç›¸åº”çš„ DOM èŠ‚ç‚¹ã€‚</p>
<p>ç„¶è€Œï¼Œ<code>useRef()</code> æ¯” <code>ref</code> å±æ€§æ›´æœ‰ç”¨ã€‚å®ƒå¯ä»¥<a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#is-there-something-like-instance-variables" target="_blank" rel="noopener noreferrer">å¾ˆæ–¹ä¾¿åœ°ä¿å­˜ä»»ä½•å¯å˜å€¼</a>ï¼Œå…¶ç±»ä¼¼äºåœ¨ class ä¸­ä½¿ç”¨å®ä¾‹å­—æ®µçš„æ–¹å¼ã€‚</p>
<p>è¿™æ˜¯å› ä¸ºå®ƒåˆ›å»ºçš„æ˜¯ä¸€ä¸ªæ™®é€š Javascript å¯¹è±¡ã€‚è€Œ <code>useRef()</code> å’Œè‡ªå»ºä¸€ä¸ª <code>{current: ...}</code> å¯¹è±¡çš„å”¯ä¸€åŒºåˆ«æ˜¯ï¼Œ<code>useRef</code> ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“æ—¶è¿”å›åŒä¸€ä¸ª ref å¯¹è±¡ã€‚</p>
<p>è¯·è®°ä½ï¼Œå½“ ref å¯¹è±¡å†…å®¹å‘ç”Ÿå˜åŒ–æ—¶ï¼Œ<code>useRef</code> å¹¶<em>ä¸ä¼š</em>é€šçŸ¥ä½ ã€‚å˜æ›´ <code>.current</code> å±æ€§ä¸ä¼šå¼•å‘ç»„ä»¶é‡æ–°æ¸²æŸ“ã€‚å¦‚æœæƒ³è¦åœ¨ React ç»‘å®šæˆ–è§£ç»‘ DOM èŠ‚ç‚¹çš„ ref æ—¶è¿è¡ŒæŸäº›ä»£ç ï¼Œåˆ™éœ€è¦ä½¿ç”¨<a href="https://zh-hans.reactjs.org/docs/hooks-faq.html#how-can-i-measure-a-dom-node" target="_blank" rel="noopener noreferrer">å›è°ƒ ref</a> æ¥å®ç°ã€‚</p>
<h5 id="useimperativehandle" class="headerLink">
    <a href="#useimperativehandle" class="header-mark"></a><code>useImperativeHandle</code></h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">useImperativeHandle(ref, createHandle, [deps])
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>useImperativeHandle</code> å¯ä»¥è®©ä½ åœ¨ä½¿ç”¨ <code>ref</code> æ—¶è‡ªå®šä¹‰æš´éœ²ç»™çˆ¶ç»„ä»¶çš„å®ä¾‹å€¼ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåº”å½“é¿å…ä½¿ç”¨ ref è¿™æ ·çš„å‘½ä»¤å¼ä»£ç ã€‚<code>useImperativeHandle</code> åº”å½“ä¸ <a href="https://zh-hans.reactjs.org/docs/react-api.html#reactforwardref" target="_blank" rel="noopener noreferrer"><code>forwardRef</code></a> ä¸€èµ·ä½¿ç”¨ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">FancyInput</span><span class="p">(</span><span class="n">props</span><span class="p">,</span> <span class="n">ref</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">inputRef</span> <span class="o">=</span> <span class="n">useRef</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">useImperativeHandle</span><span class="p">(</span><span class="n">ref</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">({</span>
</span></span><span class="line"><span class="cl">    <span class="n">focus</span><span class="p">:</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">inputRef</span><span class="o">.</span><span class="n">current</span><span class="o">.</span><span class="n">focus</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}));</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="o">&lt;</span><span class="n">input</span> <span class="n">ref</span><span class="o">=</span><span class="p">{</span><span class="n">inputRef</span><span class="p">}</span> <span class="o">...</span> <span class="o">/&gt;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">FancyInput</span> <span class="o">=</span> <span class="n">forwardRef</span><span class="p">(</span><span class="n">FancyInput</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>åœ¨æœ¬ä¾‹ä¸­ï¼Œæ¸²æŸ“ <code>&lt;FancyInput ref={inputRef} /&gt;</code> çš„çˆ¶ç»„ä»¶å¯ä»¥è°ƒç”¨ <code>inputRef.current.focus()</code>ã€‚</p>
<h5 id="uselayouteffect" class="headerLink">
    <a href="#uselayouteffect" class="header-mark"></a><code>useLayoutEffect</code></h5><p>å…¶å‡½æ•°ç­¾åä¸ <code>useEffect</code> ç›¸åŒï¼Œä½†å®ƒä¼šåœ¨æ‰€æœ‰çš„ DOM å˜æ›´ä¹‹ååŒæ­¥è°ƒç”¨ effectã€‚å¯ä»¥ä½¿ç”¨å®ƒæ¥è¯»å– DOM å¸ƒå±€å¹¶åŒæ­¥è§¦å‘é‡æ¸²æŸ“ã€‚åœ¨æµè§ˆå™¨æ‰§è¡Œç»˜åˆ¶ä¹‹å‰ï¼Œ<code>useLayoutEffect</code> å†…éƒ¨çš„æ›´æ–°è®¡åˆ’å°†è¢«åŒæ­¥åˆ·æ–°ã€‚</p>
<p>å°½å¯èƒ½ä½¿ç”¨æ ‡å‡†çš„ <code>useEffect</code> ä»¥é¿å…é˜»å¡è§†è§‰æ›´æ–°ã€‚</p>
<blockquote>
<p>æç¤º</p>
<p>å¦‚æœä½ æ­£åœ¨å°†ä»£ç ä» class ç»„ä»¶è¿ç§»åˆ°ä½¿ç”¨ Hook çš„å‡½æ•°ç»„ä»¶ï¼Œåˆ™éœ€è¦æ³¨æ„ <code>useLayoutEffect</code> ä¸ <code>componentDidMount</code>ã€<code>componentDidUpdate</code> çš„è°ƒç”¨é˜¶æ®µæ˜¯ä¸€æ ·çš„ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬æ¨èä½ <strong>ä¸€å¼€å§‹å…ˆç”¨ <code>useEffect</code></strong>ï¼Œåªæœ‰å½“å®ƒå‡ºé—®é¢˜çš„æ—¶å€™å†å°è¯•ä½¿ç”¨ <code>useLayoutEffect</code>ã€‚</p>
<p>å¦‚æœä½ ä½¿ç”¨æœåŠ¡ç«¯æ¸²æŸ“ï¼Œè¯·è®°ä½ï¼Œ<em>æ— è®º</em> <code>useLayoutEffect</code> <em>è¿˜æ˜¯</em> <code>useEffect</code> éƒ½æ— æ³•åœ¨ Javascript ä»£ç åŠ è½½å®Œæˆä¹‹å‰æ‰§è¡Œã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆåœ¨æœåŠ¡ç«¯æ¸²æŸ“ç»„ä»¶ä¸­å¼•å…¥ <code>useLayoutEffect</code> ä»£ç æ—¶ä¼šè§¦å‘ React å‘Šè­¦ã€‚è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦å°†ä»£ç é€»è¾‘ç§»è‡³ <code>useEffect</code> ä¸­ï¼ˆå¦‚æœé¦–æ¬¡æ¸²æŸ“ä¸éœ€è¦è¿™æ®µé€»è¾‘çš„æƒ…å†µä¸‹ï¼‰ï¼Œæˆ–æ˜¯å°†è¯¥ç»„ä»¶å»¶è¿Ÿåˆ°å®¢æˆ·ç«¯æ¸²æŸ“å®Œæˆåå†æ˜¾ç¤ºï¼ˆå¦‚æœç›´åˆ° <code>useLayoutEffect</code> æ‰§è¡Œä¹‹å‰ HTML éƒ½æ˜¾ç¤ºé”™ä¹±çš„æƒ…å†µä¸‹ï¼‰ã€‚</p>
<p>è‹¥è¦ä»æœåŠ¡ç«¯æ¸²æŸ“çš„ HTML ä¸­æ’é™¤ä¾èµ–å¸ƒå±€ effect çš„ç»„ä»¶ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨ <code>showChild &amp;&amp; &lt;Child /&gt;</code> è¿›è¡Œæ¡ä»¶æ¸²æŸ“ï¼Œå¹¶ä½¿ç”¨ <code>useEffect(() =&gt; { setShowChild(true); }, [])</code> å»¶è¿Ÿå±•ç¤ºç»„ä»¶ã€‚è¿™æ ·ï¼Œåœ¨å®¢æˆ·ç«¯æ¸²æŸ“å®Œæˆä¹‹å‰ï¼ŒUI å°±ä¸ä¼šåƒä¹‹å‰é‚£æ ·æ˜¾ç¤ºé”™ä¹±äº†ã€‚</p>
</blockquote>
<h5 id="usedebugvalue" class="headerLink">
    <a href="#usedebugvalue" class="header-mark"></a><code>useDebugValue</code></h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">useDebugValue(value)
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>useDebugValue</code> å¯ç”¨äºåœ¨ React å¼€å‘è€…å·¥å…·ä¸­æ˜¾ç¤ºè‡ªå®šä¹‰ hook çš„æ ‡ç­¾ã€‚</p>
<p>ä¾‹å¦‚ï¼Œ<a href="https://zh-hans.reactjs.org/docs/hooks-custom.html" target="_blank" rel="noopener noreferrer">â€œè‡ªå®šä¹‰ Hookâ€</a> ç« èŠ‚ä¸­æè¿°çš„åä¸º <code>useFriendStatus</code> çš„è‡ªå®šä¹‰ Hookï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">useFriendStatus</span><span class="p">(</span><span class="n">friendID</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">isOnline</span><span class="p">,</span> <span class="n">setIsOnline</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="n">null</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="o">...</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="err">åœ¨å¼€å‘è€…å·¥å…·ä¸­çš„è¿™ä¸ª</span> <span class="n">Hook</span> <span class="err">æ—è¾¹æ˜¾ç¤ºæ ‡ç­¾</span>  <span class="o">//</span> <span class="n">e</span><span class="o">.</span><span class="n">g</span><span class="o">.</span> <span class="s2">&#34;FriendStatus: Online&#34;</span>  <span class="n">useDebugValue</span><span class="p">(</span><span class="n">isOnline</span> <span class="err">?</span> <span class="s1">&#39;Online&#39;</span> <span class="p">:</span> <span class="s1">&#39;Offline&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">isOnline</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>æç¤º</p>
<p>æˆ‘ä»¬ä¸æ¨èä½ å‘æ¯ä¸ªè‡ªå®šä¹‰ Hook æ·»åŠ  debug å€¼ã€‚å½“å®ƒä½œä¸ºå…±äº«åº“çš„ä¸€éƒ¨åˆ†æ—¶æ‰æœ€æœ‰ä»·å€¼ã€‚</p>
</blockquote>
<h6 id="å»¶è¿Ÿæ ¼å¼åŒ–-debug-å€¼" class="headerLink">
    <a href="#%e5%bb%b6%e8%bf%9f%e6%a0%bc%e5%bc%8f%e5%8c%96-debug-%e5%80%bc" class="header-mark"></a>å»¶è¿Ÿæ ¼å¼åŒ– debug å€¼</h6><p>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ ¼å¼åŒ–å€¼çš„æ˜¾ç¤ºå¯èƒ½æ˜¯ä¸€é¡¹å¼€é”€å¾ˆå¤§çš„æ“ä½œã€‚é™¤ééœ€è¦æ£€æŸ¥ Hookï¼Œå¦åˆ™æ²¡æœ‰å¿…è¦è¿™ä¹ˆåšã€‚</p>
<p>å› æ­¤ï¼Œ<code>useDebugValue</code> æ¥å—ä¸€ä¸ªæ ¼å¼åŒ–å‡½æ•°ä½œä¸ºå¯é€‰çš„ç¬¬äºŒä¸ªå‚æ•°ã€‚è¯¥å‡½æ•°åªæœ‰åœ¨ Hook è¢«æ£€æŸ¥æ—¶æ‰ä¼šè¢«è°ƒç”¨ã€‚å®ƒæ¥å— debug å€¼ä½œä¸ºå‚æ•°ï¼Œå¹¶ä¸”ä¼šè¿”å›ä¸€ä¸ªæ ¼å¼åŒ–çš„æ˜¾ç¤ºå€¼ã€‚</p>
<p>ä¾‹å¦‚ï¼Œä¸€ä¸ªè¿”å› <code>Date</code> å€¼çš„è‡ªå®šä¹‰ Hook å¯ä»¥é€šè¿‡æ ¼å¼åŒ–å‡½æ•°æ¥é¿å…ä¸å¿…è¦çš„ <code>toDateString</code> å‡½æ•°è°ƒç”¨ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">useDebugValue(date, date =&gt; date.toDateString());
</span></span></code></pre></td></tr></table>
</div>
</div><h5 id="usedeferredvalue" class="headerLink">
    <a href="#usedeferredvalue" class="header-mark"></a><code>useDeferredValue</code></h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">const</span> <span class="n">deferredValue</span> <span class="o">=</span> <span class="n">useDeferredValue</span><span class="p">(</span><span class="n">value</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>useDeferredValue</code> æ¥å—ä¸€ä¸ªå€¼ï¼Œå¹¶è¿”å›è¯¥å€¼çš„æ–°å‰¯æœ¬ï¼Œè¯¥å‰¯æœ¬å°†æ¨è¿Ÿåˆ°æ›´ç´§æ€¥åœ°æ›´æ–°ä¹‹åã€‚å¦‚æœå½“å‰æ¸²æŸ“æ˜¯ä¸€ä¸ªç´§æ€¥æ›´æ–°çš„ç»“æœï¼Œæ¯”å¦‚ç”¨æˆ·è¾“å…¥ï¼ŒReact å°†è¿”å›ä¹‹å‰çš„å€¼ï¼Œç„¶ååœ¨ç´§æ€¥æ¸²æŸ“å®Œæˆåæ¸²æŸ“æ–°çš„å€¼ã€‚</p>
<p>è¯¥ hook ä¸ä½¿ç”¨é˜²æŠ–å’ŒèŠ‚æµå»å»¶è¿Ÿæ›´æ–°çš„ç”¨æˆ·ç©ºé—´ hooks ç±»ä¼¼ã€‚ä½¿ç”¨ <code>useDeferredValue</code> çš„å¥½å¤„æ˜¯ï¼ŒReact å°†åœ¨å…¶ä»–å·¥ä½œå®Œæˆï¼ˆè€Œä¸æ˜¯ç­‰å¾…ä»»æ„æ—¶é—´ï¼‰åç«‹å³è¿›è¡Œæ›´æ–°ï¼Œå¹¶ä¸”åƒ <a href="https://zh-hans.reactjs.org/docs/react-api.html#starttransition" target="_blank" rel="noopener noreferrer"><code>startTransition</code></a> ä¸€æ ·ï¼Œå»¶è¿Ÿå€¼å¯ä»¥æš‚åœï¼Œè€Œä¸ä¼šè§¦å‘ç°æœ‰å†…å®¹çš„æ„å¤–é™çº§ã€‚</p>
<h6 id="memoizing-deferred-children" class="headerLink">
    <a href="#memoizing-deferred-children" class="header-mark"></a>Memoizing deferred children</h6><p><code>useDeferredValue</code> ä»…å»¶è¿Ÿä½ ä¼ é€’ç»™å®ƒçš„å€¼ã€‚å¦‚æœä½ æƒ³è¦åœ¨ç´§æ€¥æ›´æ–°æœŸé—´é˜²æ­¢å­ç»„ä»¶é‡æ–°æ¸²æŸ“ï¼Œåˆ™è¿˜å¿…é¡»ä½¿ç”¨ React.memo æˆ– React.useMemo è®°å¿†è¯¥å­ç»„ä»¶ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">Typeahead</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">query</span> <span class="o">=</span> <span class="n">useSearchQuery</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">deferredQuery</span> <span class="o">=</span> <span class="n">useDeferredValue</span><span class="p">(</span><span class="n">query</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="n">Memoizing</span> <span class="err">å‘Šè¯‰</span> <span class="n">React</span> <span class="err">ä»…å½“</span> <span class="n">deferredQuery</span> <span class="err">æ”¹å˜ï¼Œ</span>
</span></span><span class="line"><span class="cl">  <span class="o">//</span> <span class="err">è€Œä¸æ˜¯</span> <span class="n">query</span> <span class="err">æ”¹å˜çš„æ—¶å€™æ‰é‡æ–°æ¸²æŸ“</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">suggestions</span> <span class="o">=</span> <span class="n">useMemo</span><span class="p">(()</span> <span class="o">=&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">SearchSuggestions</span> <span class="n">query</span><span class="o">=</span><span class="p">{</span><span class="n">deferredQuery</span><span class="p">}</span> <span class="o">/&gt;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">    <span class="p">[</span><span class="n">deferredQuery</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">SearchInput</span> <span class="n">query</span><span class="o">=</span><span class="p">{</span><span class="n">query</span><span class="p">}</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">Suspense</span> <span class="n">fallback</span><span class="o">=</span><span class="s2">&#34;Loading results...&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span><span class="n">suggestions</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;/</span><span class="n">Suspense</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è®°å¿†è¯¥å­ç»„ä»¶å‘Šè¯‰ React å®ƒä»…å½“ <code>deferredQuery</code> æ”¹å˜è€Œä¸æ˜¯ <code>query</code> æ”¹å˜çš„æ—¶å€™æ‰éœ€è¦å»é‡æ–°æ¸²æŸ“ã€‚è¿™ä¸ªé™åˆ¶ä¸æ˜¯ <code>useDeferredValue</code> ç‹¬æœ‰çš„ï¼Œå®ƒå’Œä½¿ç”¨é˜²æŠ–æˆ–èŠ‚æµçš„ hooks ä½¿ç”¨çš„ç›¸åŒæ¨¡å¼ã€‚</p>
<h5 id="usetransition" class="headerLink">
    <a href="#usetransition" class="header-mark"></a><code>useTransition</code></h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">const</span> <span class="p">[</span><span class="n">isPending</span><span class="p">,</span> <span class="n">startTransition</span><span class="p">]</span> <span class="o">=</span> <span class="n">useTransition</span><span class="p">();</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¿”å›ä¸€ä¸ªçŠ¶æ€å€¼è¡¨ç¤ºè¿‡æ¸¡ä»»åŠ¡çš„ç­‰å¾…çŠ¶æ€ï¼Œä»¥åŠä¸€ä¸ªå¯åŠ¨è¯¥è¿‡æ¸¡ä»»åŠ¡çš„å‡½æ•°ã€‚</p>
<p><code>startTransition</code> å…è®¸ä½ é€šè¿‡æ ‡è®°æ›´æ–°å°†æä¾›çš„å›è°ƒå‡½æ•°ä½œä¸ºä¸€ä¸ªè¿‡æ¸¡ä»»åŠ¡ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">startTransition(() =&gt; {
</span></span><span class="line"><span class="cl">  setCount(count + 1);
</span></span><span class="line"><span class="cl">})
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>isPending</code> æŒ‡ç¤ºè¿‡æ¸¡ä»»åŠ¡ä½•æ—¶æ´»è·ƒä»¥æ˜¾ç¤ºä¸€ä¸ªç­‰å¾…çŠ¶æ€ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">App</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">isPending</span><span class="p">,</span> <span class="n">startTransition</span><span class="p">]</span> <span class="o">=</span> <span class="n">useTransition</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="p">[</span><span class="n">count</span><span class="p">,</span> <span class="n">setCount</span><span class="p">]</span> <span class="o">=</span> <span class="n">useState</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">function</span> <span class="n">handleClick</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">startTransition</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">setCount</span><span class="p">(</span><span class="n">c</span> <span class="o">=&gt;</span> <span class="n">c</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">})</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">{</span><span class="n">isPending</span> <span class="o">&amp;&amp;</span> <span class="o">&lt;</span><span class="n">Spinner</span> <span class="o">/&gt;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">button</span> <span class="n">onClick</span><span class="o">=</span><span class="p">{</span><span class="n">handleClick</span><span class="p">}</span><span class="o">&gt;</span><span class="p">{</span><span class="n">count</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">button</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>æ³¨æ„ï¼š</p>
<p>è¿‡æ¸¡ä»»åŠ¡ä¸­è§¦å‘çš„æ›´æ–°ä¼šè®©æ›´ç´§æ€¥åœ°æ›´æ–°å…ˆè¿›è¡Œï¼Œæ¯”å¦‚ç‚¹å‡»ã€‚</p>
<p>è¿‡æ¸¡ä»»åŠ¡ä¸­çš„æ›´æ–°å°†ä¸ä¼šå±•ç¤ºç”±äºå†æ¬¡æŒ‚èµ·è€Œå¯¼è‡´é™çº§çš„å†…å®¹ã€‚è¿™ä¸ªæœºåˆ¶å…è®¸ç”¨æˆ·åœ¨ React æ¸²æŸ“æ›´æ–°çš„æ—¶å€™ç»§ç»­ä¸å½“å‰å†…å®¹è¿›è¡Œäº¤äº’ã€‚</p>
</blockquote>
<h5 id="useid" class="headerLink">
    <a href="#useid" class="header-mark"></a><code>useId</code></h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">const</span> <span class="n">id</span> <span class="o">=</span> <span class="n">useId</span><span class="p">();</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>useId</code> æ˜¯ä¸€ä¸ªç”¨äºç”Ÿæˆæ¨ªè·¨æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„ç¨³å®šçš„å”¯ä¸€ ID çš„åŒæ—¶é¿å… hydration ä¸åŒ¹é…çš„ hookã€‚</p>
<blockquote>
<p>Note</p>
<p><code>useId</code> is <strong>not</strong> for generating <a href="https://zh-hans.reactjs.org/docs/lists-and-keys.html#keys" target="_blank" rel="noopener noreferrer">keys in a list</a>. Keys should be generated from your data.</p>
</blockquote>
<p>For a basic example, pass the <code>id</code> directly to the elements that need it: ä¸€ä¸ªæœ€ç®€å•çš„ä¾‹å­ï¼Œç›´æ¥ä¼ é€’ <code>id</code> ç»™éœ€è¦å®ƒçš„å…ƒç´ ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">Checkbox</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">id</span> <span class="o">=</span> <span class="n">useId</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">label</span> <span class="n">htmlFor</span><span class="o">=</span><span class="p">{</span><span class="n">id</span><span class="p">}</span><span class="o">&gt;</span><span class="n">Do</span> <span class="n">you</span> <span class="n">like</span> <span class="n">React</span><span class="err">?</span><span class="o">&lt;/</span><span class="n">label</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">input</span> <span class="n">id</span><span class="o">=</span><span class="p">{</span><span class="n">id</span><span class="p">}</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;checkbox&#34;</span> <span class="n">name</span><span class="o">=</span><span class="s2">&#34;react&#34;</span><span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å¯¹äºåŒä¸€ç»„ä»¶ä¸­çš„å¤šä¸ª IDï¼Œä½¿ç”¨ç›¸åŒçš„ <code>id</code> å¹¶æ·»åŠ åç¼€ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">function</span> <span class="n">NameFields</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">const</span> <span class="n">id</span> <span class="o">=</span> <span class="n">useId</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">label</span> <span class="n">htmlFor</span><span class="o">=</span><span class="p">{</span><span class="n">id</span> <span class="o">+</span> <span class="s1">&#39;-firstName&#39;</span><span class="p">}</span><span class="o">&gt;</span><span class="n">First</span> <span class="n">Name</span><span class="o">&lt;/</span><span class="n">label</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">input</span> <span class="n">id</span><span class="o">=</span><span class="p">{</span><span class="n">id</span> <span class="o">+</span> <span class="s1">&#39;-firstName&#39;</span><span class="p">}</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">label</span> <span class="n">htmlFor</span><span class="o">=</span><span class="p">{</span><span class="n">id</span> <span class="o">+</span> <span class="s1">&#39;-lastName&#39;</span><span class="p">}</span><span class="o">&gt;</span><span class="n">Last</span> <span class="n">Name</span><span class="o">&lt;/</span><span class="n">label</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="n">input</span> <span class="n">id</span><span class="o">=</span><span class="p">{</span><span class="n">id</span> <span class="o">+</span> <span class="s1">&#39;-lastName&#39;</span><span class="p">}</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;text&#34;</span> <span class="o">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>æ³¨æ„ï¼š</p>
<p><code>useId</code> ç”Ÿæˆä¸€ä¸ªåŒ…å« <code>:</code> çš„å­—ç¬¦ä¸² tokenã€‚è¿™æœ‰åŠ©äºç¡®ä¿ token æ˜¯å”¯ä¸€çš„ï¼Œä½†åœ¨ CSS é€‰æ‹©å™¨æˆ– <code>querySelectorAll</code> ç­‰ API ä¸­ä¸å—æ”¯æŒã€‚</p>
<p><code>useId</code> æ”¯æŒ <code>identifierPrefix</code> ä»¥é˜²æ­¢åœ¨å¤šä¸ªæ ¹åº”ç”¨çš„ç¨‹åºä¸­å‘ç”Ÿå†²çªã€‚ è¦è¿›è¡Œé…ç½®ï¼Œè¯·å‚é˜… <a href="https://zh-hans.reactjs.org/docs/react-dom-client.html#hydrateroot" target="_blank" rel="noopener noreferrer"><code>hydrateRoot</code></a> å’Œ <a href="https://zh-hans.reactjs.org/docs/react-dom-server.html" target="_blank" rel="noopener noreferrer"><code>ReactDOMServer</code></a> çš„é€‰é¡¹ã€‚</p>
</blockquote>
<h4 id="library-hooks" class="headerLink">
    <a href="#library-hooks" class="header-mark"></a>Library Hooks</h4><p>ä»¥ä¸‹ hook æ˜¯ä¸ºåº“ä½œè€…æä¾›çš„ï¼Œç”¨äºå°†åº“æ·±å…¥é›†æˆåˆ° React æ¨¡å‹ä¸­ï¼Œé€šå¸¸ä¸ä¼šåœ¨åº”ç”¨ç¨‹åºä»£ç ä¸­ä½¿ç”¨ã€‚</p>
<h5 id="usesyncexternalstore" class="headerLink">
    <a href="#usesyncexternalstore" class="header-mark"></a><code>useSyncExternalStore</code></h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">const</span> <span class="n">state</span> <span class="o">=</span> <span class="n">useSyncExternalStore</span><span class="p">(</span><span class="n">subscribe</span><span class="p">,</span> <span class="n">getSnapshot</span><span class="p">[,</span> <span class="n">getServerSnapshot</span><span class="p">]);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>useSyncExternalStore</code> æ˜¯ä¸€ä¸ªæ¨èç”¨äºè¯»å–å’Œè®¢é˜…å¤–éƒ¨æ•°æ®æºçš„ hookï¼Œå…¶æ–¹å¼ä¸é€‰æ‹©æ€§çš„ hydration å’Œæ—¶é—´åˆ‡ç‰‡ç­‰å¹¶å‘æ¸²æŸ“åŠŸèƒ½å…¼å®¹ã€‚</p>
<p>æ­¤æ–¹æ³•è¿”å›å­˜å‚¨çš„å€¼å¹¶æ¥å—ä¸‰ä¸ªå‚æ•°ï¼š</p>
<ul>
<li><code>subscribe</code>ï¼šç”¨äºæ³¨å†Œä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå½“å­˜å‚¨å€¼å‘ç”Ÿæ›´æ”¹æ—¶è¢«è°ƒç”¨ã€‚</li>
<li><code>getSnapshot</code>ï¼š è¿”å›å½“å‰å­˜å‚¨å€¼çš„å‡½æ•°ã€‚</li>
<li><code>getServerSnapshot</code>ï¼šè¿”å›æœåŠ¡ç«¯æ¸²æŸ“æœŸé—´ä½¿ç”¨çš„å­˜å‚¨å€¼çš„å‡½æ•°</li>
</ul>
<p>æœ€ç®€å•çš„ä¾‹å­å°±æ˜¯è®¢é˜…æ•´ä¸ªå­˜å‚¨å€¼ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">const</span> <span class="n">state</span> <span class="o">=</span> <span class="n">useSyncExternalStore</span><span class="p">(</span><span class="n">store</span><span class="o">.</span><span class="n">subscribe</span><span class="p">,</span> <span class="n">store</span><span class="o">.</span><span class="n">getSnapshot</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ç„¶è€Œï¼Œä½ ä¹Ÿå¯ä»¥è®¢é˜…ç‰¹å®šå­—æ®µï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">const</span> <span class="n">selectedField</span> <span class="o">=</span> <span class="n">useSyncExternalStore</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">store</span><span class="o">.</span><span class="n">subscribe</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">()</span> <span class="o">=&gt;</span> <span class="n">store</span><span class="o">.</span><span class="n">getSnapshot</span><span class="p">()</span><span class="o">.</span><span class="n">selectedField</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>å½“æœåŠ¡ç«¯æ¸²æŸ“çš„æ—¶å€™ï¼Œä½ å¿…é¡»åºåˆ—åŒ–åœ¨æœåŠ¡ç«¯ä½¿ç”¨çš„å­˜å‚¨å€¼ï¼Œå¹¶å°†å…¶æä¾›ç»™ <code>usencexternalSternore</code>ã€‚React å°†åœ¨ hydration è¿‡ç¨‹ä¸­ä½¿ç”¨æ­¤å¿«ç…§æ¥é˜²æ­¢æœåŠ¡ç«¯ä¸åŒ¹é…ï¼š</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="k">const</span> <span class="n">selectedField</span> <span class="o">=</span> <span class="n">useSyncExternalStore</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">  <span class="n">store</span><span class="o">.</span><span class="n">subscribe</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">()</span> <span class="o">=&gt;</span> <span class="n">store</span><span class="o">.</span><span class="n">getSnapshot</span><span class="p">()</span><span class="o">.</span><span class="n">selectedField</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="p">()</span> <span class="o">=&gt;</span> <span class="n">INITIAL_SERVER_SNAPSHOT</span><span class="o">.</span><span class="n">selectedField</span><span class="p">,</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>æ³¨æ„ï¼š</p>
<p><code>getSnapshot</code> å¿…é¡»è¿”å›ç¼“å­˜çš„å€¼ã€‚å¦‚æœ getSnapshot è¿ç»­å¤šæ¬¡è°ƒç”¨ï¼Œåˆ™å¿…é¡»è¿”å›ç›¸åŒçš„ç¡®åˆ‡å€¼ï¼Œé™¤éä¸­é—´æœ‰å­˜å‚¨å€¼æ›´æ–°ã€‚</p>
<p>æä¾›äº†ä¸€ä¸ªæ¥”å­ï¼Œå‘å¸ƒä¸º <code>use-sync-external-store/shim</code>ï¼Œç”¨äºæ”¯æŒå¤šç§ç‰ˆæœ¬çš„ Reactã€‚å¦‚æœå¯ç”¨ï¼Œæ¥”å­å°†é¦–é€‰ <code>useSyncExternalStore</code>ï¼Œå¦‚æœä¸å¯ç”¨ï¼Œåˆ™é™çº§é€‰æ‹©ç”¨æˆ·ç©ºé—´çš„å®ç°ã€‚</p>
<p>ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œæˆ‘ä»¬è¿˜æä¾›äº†ä¸€ä¸ªç‰ˆæœ¬çš„ APIï¼Œè¯¥ API å‘å¸ƒä¸º <code>use-sync-external-store/with-selector</code>ï¼Œå…¶è‡ªåŠ¨æ”¯æŒè®°å¿† getSnapshot çš„ç»“æœã€‚</p>
</blockquote>
<h5 id="useinsertioneffect" class="headerLink">
    <a href="#useinsertioneffect" class="header-mark"></a><code>useInsertionEffect</code></h5><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">useInsertionEffect(didUpdate);
</span></span></code></pre></td></tr></table>
</div>
</div><p>è¯¥ç­¾åä¸ <code>useEffect</code> ç›¸åŒï¼Œä½†å®ƒåœ¨æ‰€æœ‰ DOM çªå˜ <em>ä¹‹å‰</em> åŒæ­¥è§¦å‘ã€‚ä½¿ç”¨å®ƒåœ¨è¯»å– <a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#useLayoutEffect" target="_blank" rel="noopener noreferrer"><code>useLayoutEffect</code></a> ä¸­çš„å¸ƒå±€ä¹‹å‰å°†æ ·å¼æ³¨å…¥ DOMã€‚ç”±äºè¿™ä¸ª hook çš„ä½œç”¨åŸŸæœ‰é™ï¼Œæ‰€ä»¥è¿™ä¸ª hook ä¸èƒ½è®¿é—® refsï¼Œä¹Ÿä¸èƒ½å®‰æ’æ›´æ–°ã€‚</p>
<blockquote>
<p>æ³¨æ„ï¼š</p>
<p><code>useInsertionEffect</code> åº”ä»…é™äº css-in-js åº“ä½œè€…ä½¿ç”¨ã€‚ä¼˜å…ˆè€ƒè™‘ä½¿ç”¨ <a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#useeffect" target="_blank" rel="noopener noreferrer"><code>useEffect</code></a> æˆ– <a href="https://zh-hans.reactjs.org/docs/hooks-reference.html#uselayouteffect" target="_blank" rel="noopener noreferrer"><code>useLayoutEffect</code></a> æ¥æ›¿ä»£ã€‚</p>
</blockquote>
<h2 id="åº”ç”¨åœºæ™¯" class="headerLink">
    <a href="#%e5%ba%94%e7%94%a8%e5%9c%ba%e6%99%af" class="header-mark"></a>åº”ç”¨åœºæ™¯</h2><h3 id="å¦‚ä½•è§£å†³-jax-ä¸­-html-ä»£ç æ®µè¢«è¯†åˆ«ä¸ºå­—ç¬¦ä¸²çš„é—®é¢˜" class="headerLink">
    <a href="#%e5%a6%82%e4%bd%95%e8%a7%a3%e5%86%b3-jax-%e4%b8%ad-html-%e4%bb%a3%e7%a0%81%e6%ae%b5%e8%a2%ab%e8%af%86%e5%88%ab%e4%b8%ba%e5%ad%97%e7%ac%a6%e4%b8%b2%e7%9a%84%e9%97%ae%e9%a2%98" class="header-mark"></a>å¦‚ä½•è§£å†³ JAX ä¸­ HTML ä»£ç æ®µè¢«è¯†åˆ«ä¸ºå­—ç¬¦ä¸²çš„é—®é¢˜?</h3><h4 id="é—®é¢˜æè¿°" class="headerLink">
    <a href="#%e9%97%ae%e9%a2%98%e6%8f%8f%e8%bf%b0" class="header-mark"></a>é—®é¢˜æè¿°</h4><p>React çš„ JAX è¯­æ³•ä¸­è¿›è¡ŒåŠ¨æ€æ•°æ®ç»‘å®šæ—¶ä¸èƒ½åŠ¨æ€ç»‘å®š HTMLã€‚</p>
<h4 id="äº§ç”ŸåŸå› " class="headerLink">
    <a href="#%e4%ba%a7%e7%94%9f%e5%8e%9f%e5%9b%a0" class="header-mark"></a>äº§ç”ŸåŸå› </h4><p>JAX çš„è®¾è®¡è€…ï¼Œåœ¨è®¾è®¡æ—¶ä¸ºäº†é˜²æ­¢ XSS æ”»å‡»ï¼Œç‰¹æ„é™åˆ¶äº†ã€‚</p>
<h4 id="è§£å†³æ–¹å¼" class="headerLink">
    <a href="#%e8%a7%a3%e5%86%b3%e6%96%b9%e5%bc%8f" class="header-mark"></a>è§£å†³æ–¹å¼</h4><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JSX" data-lang="JSX"><span class="line"><span class="cl"><span class="c1">//ä½¿ç”¨dangerouslySetInnerHTML(æ³¨æ„__htmlæ˜¯ä¸¤ä¸ª_)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="p">&lt;</span><span class="nt">div</span> <span class="na">dangerouslySetInnerHTML</span><span class="o">=</span><span class="p">{{</span><span class="nx">__html</span><span class="o">:</span> <span class="nx">html</span><span class="p">}}</span> <span class="p">/&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><blockquote>
<p>ä¸åˆæ—¶å®œçš„ä½¿ç”¨ innerHTML å¯èƒ½ä¼šå¯¼è‡´ cross-site scripting (XSS) æ”»å‡»ã€‚ å‡€åŒ–ç”¨æˆ·çš„è¾“å…¥æ¥æ˜¾ç¤ºçš„æ—¶å€™ï¼Œç»å¸¸ä¼šå‡ºç°é”™è¯¯ï¼Œä¸åˆé€‚çš„å‡€åŒ–ä¹Ÿæ˜¯å¯¼è‡´ç½‘é¡µæ”»å‡»çš„åŸå› ä¹‹ä¸€ã€‚æˆ‘ä»¬çš„è®¾è®¡å“²å­¦æ˜¯è®©ç¡®ä¿å®‰å…¨åº”è¯¥æ˜¯ç®€å•çš„ï¼Œå¼€å‘è€…åœ¨æ‰§è¡Œâ€œä¸å®‰å…¨â€çš„æ“ä½œçš„æ—¶å€™åº”è¯¥æ¸…æ¥šåœ°çŸ¥é“ä»–ä»¬è‡ªå·±çš„æ„å›¾ã€‚dangerouslySetInnerHTML è¿™ä¸ª prop çš„å‘½åæ˜¯æ•…æ„è¿™ä¹ˆè®¾è®¡çš„ï¼Œä»¥æ­¤æ¥è­¦å‘Šï¼Œå®ƒçš„ prop å€¼ï¼ˆ ä¸€ä¸ªå¯¹è±¡è€Œä¸æ˜¯å­—ç¬¦ä¸² ï¼‰åº”è¯¥è¢«ç”¨æ¥è¡¨æ˜å‡€åŒ–åçš„æ•°æ®ã€‚</p>
</blockquote>
<h3 id="å¦‚ä½•å¤„ç†-react-å’Œç›´æ¥ä¿®æ”¹-dom-çš„å‰ç«¯æ¡†æ¶çš„å…¼å®¹æ€§é—®é¢˜" class="headerLink">
    <a href="#%e5%a6%82%e4%bd%95%e5%a4%84%e7%90%86-react-%e5%92%8c%e7%9b%b4%e6%8e%a5%e4%bf%ae%e6%94%b9-dom-%e7%9a%84%e5%89%8d%e7%ab%af%e6%a1%86%e6%9e%b6%e7%9a%84%e5%85%bc%e5%ae%b9%e6%80%a7%e9%97%ae%e9%a2%98" class="header-mark"></a>å¦‚ä½•å¤„ç† React å’Œç›´æ¥ä¿®æ”¹ DOM çš„å‰ç«¯æ¡†æ¶çš„å…¼å®¹æ€§é—®é¢˜?</h3><h4 id="é—®é¢˜æè¿°-1" class="headerLink">
    <a href="#%e9%97%ae%e9%a2%98%e6%8f%8f%e8%bf%b0-1" class="header-mark"></a>é—®é¢˜æè¿°</h4><p>å› ä¸º React çš„çŠ¶æ€åˆ°è™šæ‹Ÿ DOM å†åˆ° DOM ç»˜åˆ¶çš„æ¡†æ¶å®ç°å’Œé€šè¿‡ JQuery å»ç›´æ¥ä¿®æ”¹ DOM æ˜¯æœ‰å†²çªçš„ã€‚æ‰€ä»¥å¦‚æœä½¿ç”¨äº† React æ¡†æ¶çš„è¯ï¼Œæœ€å¥½å°±ä¸è¦å†ä½¿ç”¨ä¼šç›´æ¥ä¿®æ”¹ DOM çš„ JQuery æ¡†æ¶ã€‚</p>
<h5 id="react-å’Œ-jquery-ui-sortable" class="headerLink">
    <a href="#react-%e5%92%8c-jquery-ui-sortable" class="header-mark"></a>React å’Œ JQuery UI Sortable</h5><ul>
<li>
<p>äº§ç”ŸåŸå› :<br>
ä½¿ç”¨ Sortable è¿›è¡Œæ‹–æ‹½æ’åºæ—¶ï¼Œåœ¨æ”¾ç½®æ—¶ Sortable ä¼šå…ˆæ ¹æ®æ‹–æ‹½èµ·å§‹å’Œç›®æ ‡ä¿®æ”¹ä¸€æ¬¡ DOMã€‚ç„¶åå¦‚æœåœ¨æ‹–æ‹½åæ›´æ–°äº†æ•°æ®ï¼ŒReact ä¼š render DOMï¼Œä½†æ˜¯ React å¹¶ä¸çŸ¥é“ Sortable å¯¹ DOM è¿›è¡Œäº†ä¿®æ”¹ï¼Œå› æ­¤äº§ç”Ÿçš„å†²çªã€‚</p>
</li>
<li>
<p>è§£å†³æ–¹å¼:<br>
åœ¨ stop å›è°ƒæ–¹æ³•é‡Œå–æ¶ˆ Sortable çš„æ’åºï¼Œå°†æ’åºæ“ä½œäº¤ç»™ React ç®¡ç†ã€‚</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-JSX" data-lang="JSX"><span class="line"><span class="cl"><span class="nx">stop</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">$schArLiBox</span><span class="p">.</span><span class="nx">sortable</span><span class="p">(</span><span class="s2">&#34;cancel&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h5 id="react-å’Œ-jquery-tipsy" class="headerLink">
    <a href="#react-%e5%92%8c-jquery-tipsy" class="header-mark"></a>React å’Œ JQuery tipsy</h5><ul>
<li>
<p>äº§ç”ŸåŸå› :<br>
React ä¿®æ”¹ title åï¼Œå¦‚æœæ˜¯ç½®ä¸º<code>&quot;&quot;</code>æˆ–åˆ é™¤ title å±æ€§ï¼Œéƒ½ä¸ä¼šå¦ tipsy é‡æ–°åŠ è½½
original-title å±æ€§ï¼Œåªæœ‰ä¿®æ”¹ä¸ºå…¶ä»–å€¼æ˜¯æ‰é‡åŠ è½½ã€‚å› æ­¤è¦åˆ é™¤çš„è¯å°±æœ‰é—®é¢˜ã€‚</p>
</li>
<li>
<p>è§£å†³æ–¹å¼:<br>
ä½¿ç”¨ jQuery æ‰‹åŠ¨åˆ é™¤ä¿®æ”¹çš„å…ƒç´ çš„ original-title å±æ€§</p>
</li>
</ul>
</div>

        <div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>æ›´æ–°äº 2024-04-06&nbsp;<a class="git-hash" href="https://github.com/Humble-Xiang/hugo-blog/commit/c35233da6a399af77c2401e6978337d21f10d657" target="_blank" title="commit by OrionPax(orionpax.1997@outlook.com) c35233da6a399af77c2401e6978337d21f10d657: update" rel="noopener noreferrer">
                                    <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M440.667 182.109l7.143-40c1.313-7.355-4.342-14.109-11.813-14.109h-74.81l14.623-81.891C377.123 38.754 371.468 32 363.997 32h-40.632a12 12 0 0 0-11.813 9.891L296.175 128H197.54l14.623-81.891C213.477 38.754 207.822 32 200.35 32h-40.632a12 12 0 0 0-11.813 9.891L132.528 128H53.432a12 12 0 0 0-11.813 9.891l-7.143 40C33.163 185.246 38.818 192 46.289 192h74.81L98.242 320H19.146a12 12 0 0 0-11.813 9.891l-7.143 40C-1.123 377.246 4.532 384 12.003 384h74.81L72.19 465.891C70.877 473.246 76.532 480 84.003 480h40.632a12 12 0 0 0 11.813-9.891L151.826 384h98.634l-14.623 81.891C234.523 473.246 240.178 480 247.65 480h40.632a12 12 0 0 0 11.813-9.891L315.472 384h79.096a12 12 0 0 0 11.813-9.891l7.143-40c1.313-7.355-4.342-14.109-11.813-14.109h-74.81l22.857-128h79.096a12 12 0 0 0 11.813-9.891zM261.889 320h-98.634l22.857-128h98.634l-22.857 128z"/></svg>c35233d</a></span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line print:!tw-hidden">
            <div class="post-info-md"><span><a class="link-to-mardown" href=/react/index.md target="_blank" rel="noopener noreferrer">é˜…è¯»åŸå§‹æ–‡æ¡£</a>
                    </span><span>|&nbsp;<a class="link-to-source" href=https://github.com/Humble-Xiang/hugo-blog/blob/main/content/posts/react.md target="_blank" rel="noopener noreferrer">æŸ¥çœ‹æºä»£ç </a>
                    </span><span>|&nbsp;<a class="link-to-edit" href=https://github.com/Humble-Xiang/hugo-blog/edit/main/content/posts/react.md target="_blank" rel="noopener noreferrer">ç¼–è¾‘æ­¤é¡µ</a>
                    </span><span>|&nbsp;<a class="link-to-report" href=https://github.com/Humble-Xiang/hugo-blog/issues/new?title=[bug]%20React+%E7%9A%84%E4%BD%BF%E7%94%A8&body=|Field|Value|%0A|-|-|%0A|Title|React+%E7%9A%84%E4%BD%BF%E7%94%A8|%0A|Url|http://localhost:1313/react/|%0A|Filename|https://github.com/Humble-Xiang/hugo-blog/blob/main/content/posts/react.md| target="_blank" rel="noopener noreferrer">æŠ¥å‘Šé—®é¢˜</a>
                    </span></div>
            <div class="post-info-share"></div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M497.941 225.941L286.059 14.059A48 48 0 0 0 252.118 0H48C21.49 0 0 21.49 0 48v204.118a48 48 0 0 0 14.059 33.941l211.882 211.882c18.744 18.745 49.136 18.746 67.882 0l204.118-204.118c18.745-18.745 18.745-49.137 0-67.882zM112 160c-26.51 0-48-21.49-48-48s21.49-48 48-48 48 21.49 48 48-21.49 48-48 48zm513.941 133.823L421.823 497.941c-18.745 18.745-49.137 18.745-67.882 0l-.36-.36L527.64 323.522c16.999-16.999 26.36-39.6 26.36-63.64s-9.362-46.641-26.36-63.64L331.397 0h48.721a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882z"/></svg>&nbsp;<a href="/tags/frontend-framework/">Frontend Framework</a></section>
        <section class="print:!tw-hidden">
            <span><a href="javascript:void(0);" onclick="window.history.back();">è¿”å›</a></span>&nbsp;|&nbsp;<span><a href="/">ä¸»é¡µ</a></span>
        </section>
    </div>

    <div class="post-nav print:tw-hidden"><a href="/hibernate/" class="prev" rel="prev" title="Hibernate çš„ä½¿ç”¨"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M31.7 239l136-136c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9L127.9 256l96.4 96.4c9.4 9.4 9.4 24.6 0 33.9L201.7 409c-9.4 9.4-24.6 9.4-33.9 0l-136-136c-9.5-9.4-9.5-24.6-.1-34z"/></svg>Hibernate çš„ä½¿ç”¨</a>
            <a href="/jquery/" class="next" rel="next" title="Jquery çš„ä½¿ç”¨">Jquery çš„ä½¿ç”¨<svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 256 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M224.3 273l-136 136c-9.4 9.4-24.6 9.4-33.9 0l-22.6-22.6c-9.4-9.4-9.4-24.6 0-33.9l96.4-96.4-96.4-96.4c-9.4-9.4-9.4-24.6 0-33.9L54.3 103c9.4-9.4 24.6-9.4 33.9 0l136 136c9.5 9.4 9.5 24.6.1 34z"/></svg></a></div>
</div>
</article></div>
        </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">
                    ç”± <a href="https://gohugo.io/" target="_blank" rel="noopener noreferrer" title="Hugo 0.125.7">Hugo</a> å¼ºåŠ›é©±åŠ¨&nbsp;|&nbsp;ä¸»é¢˜ - <a href="https://github.com/HEIGE-PCloud/DoIt" target="_blank" rel="noopener noreferrer" title="DoIt 0.4.0"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M402.3 344.9l32-32c5-5 13.7-1.5 13.7 5.7V464c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h273.5c7.1 0 10.7 8.6 5.7 13.7l-32 32c-1.5 1.5-3.5 2.3-5.7 2.3H48v352h352V350.5c0-2.1.8-4.1 2.3-5.6zm156.6-201.8L296.3 405.7l-90.4 10c-26.2 2.9-48.5-19.2-45.6-45.6l10-90.4L432.9 17.1c22.9-22.9 59.9-22.9 82.7 0l43.2 43.2c22.9 22.9 22.9 60 .1 82.8zM460.1 174L402 115.9 216.2 301.8l-7.3 65.3 65.3-7.3L460.1 174zm64.8-79.7l-43.2-43.2c-4.1-4.1-10.8-4.1-14.8 0L436 82l58.1 58.1 30.9-30.9c4-4.2 4-10.8-.1-14.9z"/></svg> DoIt</a>
                </div><div class="footer-line"><svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M256 8C119.033 8 8 119.033 8 256s111.033 248 248 248 248-111.033 248-248S392.967 8 256 8zm0 448c-110.532 0-200-89.451-200-200 0-110.531 89.451-200 200-200 110.532 0 200 89.451 200 200 0 110.532-89.451 200-200 200zm107.351-101.064c-9.614 9.712-45.53 41.396-104.065 41.396-82.43 0-140.484-61.425-140.484-141.567 0-79.152 60.275-139.401 139.762-139.401 55.531 0 88.738 26.62 97.593 34.779a11.965 11.965 0 0 1 1.936 15.322l-18.155 28.113c-3.841 5.95-11.966 7.282-17.499 2.921-8.595-6.776-31.814-22.538-61.708-22.538-48.303 0-77.916 35.33-77.916 80.082 0 41.589 26.888 83.692 78.277 83.692 32.657 0 56.843-19.039 65.726-27.225 5.27-4.857 13.596-4.039 17.82 1.738l19.865 27.17a11.947 11.947 0 0 1-1.152 15.518z"/></svg>2019 - 2024<span class="author">&nbsp;<a href="https://github.com/Humble-Xiang" target="_blank" rel="noopener noreferrer">Humble.Xiang</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
            <div class="footer-line"></div>
            <div class="footer-line">
            </div>
        </div></footer></div>

    <div id="fixed-buttons" class="print:!tw-hidden"><a href="#back-to-top" id="back-to-top-button" class="fixed-button" title="å›åˆ°é¡¶éƒ¨">
            <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6 0-33.9L207 39c9.4-9.4 24.6-9.4 33.9 0l194.3 194.3c9.4 9.4 9.4 24.6 0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3 0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"/></svg>
        </a><a href="#" id="view-comments" class="fixed-button" title="æŸ¥çœ‹è¯„è®º">
            <svg class="icon"
    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!-- Font Awesome Free 5.15.4 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) --><path d="M256 32C114.6 32 0 125.1 0 240c0 49.6 21.4 95 57 130.7C44.5 421.1 2.7 466 2.2 466.5c-2.2 2.3-2.8 5.7-1.5 8.7S4.8 480 8 480c66.3 0 116-31.8 140.6-51.4 32.7 12.3 69 19.4 107.4 19.4 141.4 0 256-93.1 256-208S397.4 32 256 32z"/></svg>
        </a>
    </div><div class="assets"><link rel="stylesheet" href="/lib/lightgallery/lightgallery.min.css"><script type="text/javascript">window.config={"code":{"copyTitle":"å¤åˆ¶åˆ°å‰ªè´´æ¿","maxShownLines":15},"comment":{},"data":{"desktop-header-typeit":"Humble.X","mobile-header-typeit":"Humble.X"},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"search":{"distance":100,"findAllMatches":false,"fuseIndexURL":"/index.json","highlightTag":"em","ignoreFieldNorm":false,"ignoreLocation":true,"isCaseSensitive":false,"location":0,"maxResultLength":10,"minMatchCharLength":2,"noResultsFound":"æ²¡æœ‰æ‰¾åˆ°ç»“æœ","snippetLength":50,"threshold":0.1,"type":"fuse","useExtendedSearch":false},"sharerjs":true,"table":{"sort":true},"typeit":{"cursorChar":"|","cursorSpeed":1000,"data":{"desktop-header-typeit":["desktop-header-typeit"],"mobile-header-typeit":["mobile-header-typeit"]},"duration":-1,"speed":100}};</script><script
    src="/lib/tablesort/tablesort.min.js"
    
  ></script><script
    src="/lib/lightgallery/lightgallery.min.js"
    
  ></script><script
    src="/lib/lightgallery/lg-thumbnail.min.js"
    
  ></script><script
    src="/lib/lightgallery/lg-zoom.min.js"
    
  ></script><script
    src="/lib/clipboard/clipboard.min.js"
    
  ></script><script
    src="/lib/sharer/sharer.min.js"
    
  ></script><script
    src="/lib/typeit/typeit.min.js"
    
  ></script><script
    src="https://website-card-embed.dramacat.top/website-card-embed-loveit.js"
    
  ></script><script
    src="/js/theme.min.js"
    
      defer
    
  ></script></div>
</body>

</html>
